---

title: Data Block Gym


keywords: fastai
sidebar: home_sidebar

summary: "openai gym sources"
description: "openai gym sources"
nb_path: "nbs/05c_data.gym.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/05c_data.gym.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="GymSource">GymSource<a class="anchor-link" href="#GymSource"> </a></h2><blockquote><p>The base iterable used for iterating through environments.</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_loop</span><span class="o">=</span><span class="n">L</span><span class="p">([</span><span class="s1">&#39;event.after_create&#39;</span><span class="p">,</span><span class="s1">&#39;Start Setup&#39;</span><span class="p">,</span><span class="s1">&#39;event.initialize&#39;</span><span class="p">,</span><span class="s1">&#39;End Setup&#39;</span><span class="p">,</span>
             <span class="s1">&#39;event.before_episodes&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Start Episodes&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.reset&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.do_action&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.do_step&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.do_render&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.before_history&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.history&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.after_history&#39;</span><span class="p">,</span>
             <span class="s1">&#39;End Episodes&#39;</span><span class="p">,</span>
             <span class="s1">&#39;event.after_episodes&#39;</span>
             <span class="p">])</span>

<span class="n">mk_class</span><span class="p">(</span><span class="s1">&#39;source_events&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">parse_events</span><span class="p">(</span><span class="n">_loop</span><span class="p">)</span><span class="o">.</span><span class="n">map_dict</span><span class="p">(),</span>
         <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;All possible events as attributes to get tab-completion and typo-proofing&quot;</span><span class="p">)</span>

<span class="n">_all_</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;source_events&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="return_data" class="doc_header"><code>return_data</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L52" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>return_data</code>(<strong><code>o</code></strong>:<code>dict</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Source" class="doc_header"><code>class</code> <code>Source</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block_simple.py#L52" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Source</code>(<strong><code>cbs</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/callback.core.html#Loop"><code>Loop</code></a></p>
</blockquote>
<p>Inherit from this to have all attr accesses in <code>self._xtra</code> passed down to <code>self.default</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">return_data</span><span class="p">(</span><span class="n">o</span><span class="p">:</span><span class="nb">dict</span><span class="p">):</span> 
    <span class="n">source</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">o</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">],</span><span class="n">o</span><span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;source&#39;</span><span class="p">:</span><span class="n">source</span><span class="p">,</span><span class="s1">&#39;history&#39;</span><span class="p">:</span><span class="n">data</span><span class="p">}</span>

<span class="k">class</span> <span class="nc">Source</span><span class="p">(</span><span class="n">Loop</span><span class="p">):</span>
    <span class="n">_loop</span><span class="o">=</span><span class="n">_loop</span>
    <span class="n">_events</span><span class="o">=</span><span class="n">source_events</span>
    <span class="n">_default</span><span class="o">=</span><span class="s1">&#39;source&#39;</span>    
    <span class="n">end_event</span><span class="o">=</span><span class="n">parse_events</span><span class="p">(</span><span class="n">_loop</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="nd">@delegates</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">test_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_fields</span><span class="o">=</span><span class="s1">&#39;state,next_state,done,all_done,env_id,worker_id&#39;</span>\
                           <span class="s1">&#39;,action,episode_id,accum_rewards,reward,step&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_fields</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_field</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">return_fn</span><span class="o">=</span><span class="n">return_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loop_history_yield</span><span class="o">=</span><span class="kc">False</span>
        <span class="n">store_attr</span><span class="p">(</span><span class="n">but</span><span class="o">=</span><span class="s1">&#39;cbs&#39;</span><span class="p">,</span><span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">next_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">done</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">all_done</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">env_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">episode_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">accum_rewards</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">reward</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                   <span class="n">skip_history_return</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cbs</span><span class="o">=</span><span class="n">cbs</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">after_create</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;initialize&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
    
    <span class="k">def</span> <span class="nf">_history</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loop_history_yield</span><span class="o">=</span><span class="kc">False</span>
        <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;history&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_mode</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">this</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;test_field&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fields</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;test_field&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_fn</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">history</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">()))[</span><span class="s1">&#39;history&#39;</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">BD</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">BD</span><span class="p">({</span><span class="n">s</span><span class="p">:(</span><span class="n">ifnone</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span><span class="n">TensorBatch</span><span class="p">([[</span><span class="mi">0</span><span class="p">]]))</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_mode</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">s</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fields</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">in_</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ignore_fields</span><span class="p">)})</span>
        
    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;before_episodes&#39;</span><span class="p">)</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="o">+=</span><span class="mi">1</span>
            <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;reset&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;do_action&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;do_step&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_mode</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_field</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;do_render&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;before_history&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_history_return</span><span class="p">:</span> <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">_history</span><span class="p">()</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">loop_history_yield</span><span class="p">:</span>   <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">_history</span><span class="p">()</span>
            <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;after_history&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So the <a href="/fastrl/data.gym.html#Source"><code>Source</code></a> object does a simple loop that returns a dictionary. 
This is going to be similar to what the rest of fastrl will be expecting.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span><span class="n">test_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)):</span> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[1, 1, 1, 1, 1]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[2, 2, 2, 2, 2]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[3, 3, 3, 3, 3]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[4, 4, 4, 4, 4]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[5, 5, 5, 5, 5]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[6, 6, 6, 6, 6]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[7, 7, 7, 7, 7]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[8, 8, 8, 8, 8]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[9, 9, 9, 9, 9]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[10, 10, 10, 10, 10]])}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Source</span><span class="p">()</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> - after_create   : []
Start Setup
   - initialize     : []
End Setup
 - before_episodes: []
Start Episodes
   - reset          : []
   - do_action      : []
   - do_step        : []
   - do_render      : []
   - before_history : []
   - history        : []
   - after_history  : []
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ReturnHistory" class="doc_header"><code>class</code> <code>ReturnHistory</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L108" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ReturnHistory</code>(<strong><code>enc</code></strong>=<em><code>None</code></em>, <strong><code>dec</code></strong>=<em><code>None</code></em>, <strong><code>split_idx</code></strong>=<em><code>None</code></em>, <strong><code>order</code></strong>=<em><code>None</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>Delegates (<code>__call__</code>,<code>decode</code>,<code>setup</code>) to (<code>encodes</code>,<code>decodes</code>,<code>setups</code>) if <code>split_idx</code> matches</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">LoopCallback</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>fastrl.callback.core.LoopCallback</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TstCallback" class="doc_header"><code>class</code> <code>TstCallback</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L119" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TstCallback</code>(<strong><code>action_space</code></strong>=<em><code>None</code></em>, <strong><code>constant</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/agent.html#AgentCallback"><code>AgentCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="np_type_cast" class="doc_header"><code>np_type_cast</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L128" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>np_type_cast</code>(<strong><code>a</code></strong>, <strong><code>dtype</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GymLoop" class="doc_header"><code>class</code> <code>GymLoop</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L130" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GymLoop</code>(<strong><code>env_name</code></strong>:<code>str</code>, <strong><code>agent</code></strong>=<em><code>None</code></em>, <strong><code>mode</code></strong>=<em><code>None</code></em>, <strong><code>steps_count</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>steps_delta</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>seed</code></strong>:<code>int</code>=<em><code>None</code></em>, <strong><code>worker_id</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>dtype</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/callback.core.html#LoopCallback"><code>LoopCallback</code></a></p>
</blockquote>
<p>Handles iterating through single openai gym (and varients).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> - after_create   : []
Start Setup
   - initialize     : []
End Setup
 - before_episodes: []
Start Episodes
   - reset          : []
   - do_action      : []
   - do_step        : []
   - do_render      : []
   - before_history : []
   - history        : []
   - after_history  : []
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/fastrl_user/.local/lib/python3.8/site-packages/gym/logger.py:30: UserWarning: <span class="ansi-yellow-fg">WARN: Box bound precision lowered by casting to float32</span>
  warnings.warn(colorize(&#39;%s: %s&#39;%(&#39;WARN&#39;, msg % args), &#39;yellow&#39;))
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> - after_create   : [GymLoop]
Start Setup
   - initialize     : [GymLoop]
End Setup
 - before_episodes: [GymLoop]
Start Episodes
   - reset          : [GymLoop]
   - do_action      : []
   - do_step        : [GymLoop]
   - do_render      : []
   - before_history : [GymLoop]
   - history        : [GymLoop]
   - after_history  : [GymLoop]
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
WalkerBase::__init__
argv[0]=
argv[0]=
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-4.354769</td>
      <td>-0.837997</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-5.534328</td>
      <td>-1.179559</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-10.103495</td>
      <td>-1.512838</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-10.883753</td>
      <td>-0.780258</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-15.995199</td>
      <td>-1.055272</td>
      <td>11</td>
    </tr>
    <tr>
      <th>5</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-16.840191</td>
      <td>-0.844992</td>
      <td>12</td>
    </tr>
    <tr>
      <th>6</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-19.432087</td>
      <td>-1.477476</td>
      <td>15</td>
    </tr>
    <tr>
      <th>7</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-19.526821</td>
      <td>-0.094734</td>
      <td>16</td>
    </tr>
    <tr>
      <th>8</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-23.101923</td>
      <td>-2.011072</td>
      <td>19</td>
    </tr>
    <tr>
      <th>9</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-27.383554</td>
      <td>-4.281631</td>
      <td>20</td>
    </tr>
    <tr>
      <th>10</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-27.383554</td>
      <td>-4.281631</td>
      <td>20</td>
    </tr>
    <tr>
      <th>11</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-7.963532</td>
      <td>-2.784909</td>
      <td>3</td>
    </tr>
    <tr>
      <th>12</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-9.277530</td>
      <td>-1.313997</td>
      <td>4</td>
    </tr>
    <tr>
      <th>13</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-11.702222</td>
      <td>-0.754987</td>
      <td>7</td>
    </tr>
    <tr>
      <th>14</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-13.268376</td>
      <td>-1.566154</td>
      <td>8</td>
    </tr>
    <tr>
      <th>15</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-19.830832</td>
      <td>-2.189697</td>
      <td>11</td>
    </tr>
    <tr>
      <th>16</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-21.016794</td>
      <td>-1.185963</td>
      <td>12</td>
    </tr>
    <tr>
      <th>17</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-22.857431</td>
      <td>-0.896847</td>
      <td>15</td>
    </tr>
    <tr>
      <th>18</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-28.337128</td>
      <td>-5.479695</td>
      <td>16</td>
    </tr>
    <tr>
      <th>19</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-29.911249</td>
      <td>-0.342909</td>
      <td>18</td>
    </tr>
    <tr>
      <th>20</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-33.286209</td>
      <td>-3.374959</td>
      <td>19</td>
    </tr>
    <tr>
      <th>21</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-33.286209</td>
      <td>-3.374959</td>
      <td>19</td>
    </tr>
    <tr>
      <th>22</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-3.781034</td>
      <td>-1.976195</td>
      <td>3</td>
    </tr>
    <tr>
      <th>23</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-5.433087</td>
      <td>-1.652053</td>
      <td>4</td>
    </tr>
    <tr>
      <th>24</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-17.828362</td>
      <td>-4.256587</td>
      <td>7</td>
    </tr>
    <tr>
      <th>25</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-20.981342</td>
      <td>-3.152981</td>
      <td>8</td>
    </tr>
    <tr>
      <th>26</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-23.204956</td>
      <td>-1.311310</td>
      <td>11</td>
    </tr>
    <tr>
      <th>27</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-23.730305</td>
      <td>-0.525349</td>
      <td>12</td>
    </tr>
    <tr>
      <th>28</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-25.681381</td>
      <td>-0.845672</td>
      <td>15</td>
    </tr>
    <tr>
      <th>29</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-25.692619</td>
      <td>-0.011239</td>
      <td>16</td>
    </tr>
    <tr>
      <th>30</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-26.586187</td>
      <td>-0.893567</td>
      <td>17</td>
    </tr>
    <tr>
      <th>31</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-30.142553</td>
      <td>-3.556366</td>
      <td>18</td>
    </tr>
    <tr>
      <th>32</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-30.142553</td>
      <td>-3.556366</td>
      <td>18</td>
    </tr>
    <tr>
      <th>33</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-2.500446</td>
      <td>-0.379459</td>
      <td>3</td>
    </tr>
    <tr>
      <th>34</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-5.556041</td>
      <td>-3.055596</td>
      <td>4</td>
    </tr>
    <tr>
      <th>35</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-9.739618</td>
      <td>-0.637303</td>
      <td>7</td>
    </tr>
    <tr>
      <th>36</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-17.379623</td>
      <td>-7.640006</td>
      <td>8</td>
    </tr>
    <tr>
      <th>37</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-22.280069</td>
      <td>-1.323813</td>
      <td>11</td>
    </tr>
    <tr>
      <th>38</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-23.474976</td>
      <td>-1.194905</td>
      <td>12</td>
    </tr>
    <tr>
      <th>39</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-27.867832</td>
      <td>-0.575518</td>
      <td>15</td>
    </tr>
    <tr>
      <th>40</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-32.043030</td>
      <td>-4.175196</td>
      <td>16</td>
    </tr>
    <tr>
      <th>41</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-36.073845</td>
      <td>-3.043272</td>
      <td>18</td>
    </tr>
    <tr>
      <th>42</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-41.166489</td>
      <td>-5.092644</td>
      <td>19</td>
    </tr>
    <tr>
      <th>43</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-41.166489</td>
      <td>-5.092644</td>
      <td>19</td>
    </tr>
    <tr>
      <th>44</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-3.865053</td>
      <td>-1.762517</td>
      <td>3</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-4.068436</td>
      <td>-0.203383</td>
      <td>4</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-8.385545</td>
      <td>-0.899260</td>
      <td>7</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-10.486074</td>
      <td>-2.100529</td>
      <td>8</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-14.172823</td>
      <td>-1.493913</td>
      <td>11</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-15.141517</td>
      <td>-0.968694</td>
      <td>12</td>
    </tr>
    <tr>
      <th>50</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-19.841763</td>
      <td>-1.968462</td>
      <td>15</td>
    </tr>
    <tr>
      <th>51</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-20.514536</td>
      <td>-0.672773</td>
      <td>16</td>
    </tr>
    <tr>
      <th>52</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-23.439075</td>
      <td>-1.473197</td>
      <td>19</td>
    </tr>
    <tr>
      <th>53</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-26.508352</td>
      <td>-3.069277</td>
      <td>20</td>
    </tr>
    <tr>
      <th>54</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-26.508352</td>
      <td>-3.069277</td>
      <td>20</td>
    </tr>
    <tr>
      <th>55</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-1.726085</td>
      <td>-0.378368</td>
      <td>3</td>
    </tr>
    <tr>
      <th>56</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-3.221066</td>
      <td>-1.494981</td>
      <td>4</td>
    </tr>
    <tr>
      <th>57</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-4.963759</td>
      <td>-1.514195</td>
      <td>7</td>
    </tr>
    <tr>
      <th>58</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-6.398146</td>
      <td>-1.434386</td>
      <td>8</td>
    </tr>
    <tr>
      <th>59</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-6.870155</td>
      <td>0.165203</td>
      <td>11</td>
    </tr>
    <tr>
      <th>60</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-8.328548</td>
      <td>-1.458394</td>
      <td>12</td>
    </tr>
    <tr>
      <th>61</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-17.658972</td>
      <td>-5.405565</td>
      <td>15</td>
    </tr>
    <tr>
      <th>62</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-18.608664</td>
      <td>-0.949691</td>
      <td>16</td>
    </tr>
    <tr>
      <th>63</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-19.541525</td>
      <td>-0.932861</td>
      <td>17</td>
    </tr>
    <tr>
      <th>64</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-24.999449</td>
      <td>-5.457923</td>
      <td>18</td>
    </tr>
    <tr>
      <th>65</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-24.999449</td>
      <td>-5.457923</td>
      <td>18</td>
    </tr>
    <tr>
      <th>66</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-1.708094</td>
      <td>0.044060</td>
      <td>3</td>
    </tr>
    <tr>
      <th>67</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-1.328453</td>
      <td>0.379641</td>
      <td>4</td>
    </tr>
    <tr>
      <th>68</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-1.143962</td>
      <td>-1.626334</td>
      <td>7</td>
    </tr>
    <tr>
      <th>69</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-3.154764</td>
      <td>-2.010802</td>
      <td>8</td>
    </tr>
    <tr>
      <th>70</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-8.705578</td>
      <td>-2.334102</td>
      <td>11</td>
    </tr>
    <tr>
      <th>71</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-9.858752</td>
      <td>-1.153174</td>
      <td>12</td>
    </tr>
    <tr>
      <th>72</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-15.512497</td>
      <td>-3.225905</td>
      <td>15</td>
    </tr>
    <tr>
      <th>73</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-17.762783</td>
      <td>-2.250286</td>
      <td>16</td>
    </tr>
    <tr>
      <th>74</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-21.296057</td>
      <td>-1.565253</td>
      <td>18</td>
    </tr>
    <tr>
      <th>75</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-27.571045</td>
      <td>-6.274987</td>
      <td>19</td>
    </tr>
    <tr>
      <th>76</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-27.571045</td>
      <td>-6.274987</td>
      <td>19</td>
    </tr>
    <tr>
      <th>77</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-0.291408</td>
      <td>-1.168210</td>
      <td>3</td>
    </tr>
    <tr>
      <th>78</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-1.085491</td>
      <td>-0.794084</td>
      <td>4</td>
    </tr>
    <tr>
      <th>79</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-10.897843</td>
      <td>-4.779295</td>
      <td>7</td>
    </tr>
    <tr>
      <th>80</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-13.202144</td>
      <td>-2.304300</td>
      <td>8</td>
    </tr>
    <tr>
      <th>81</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-18.613022</td>
      <td>-0.663823</td>
      <td>11</td>
    </tr>
    <tr>
      <th>82</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-18.962275</td>
      <td>-0.349253</td>
      <td>12</td>
    </tr>
    <tr>
      <th>83</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-26.667564</td>
      <td>-1.705387</td>
      <td>15</td>
    </tr>
    <tr>
      <th>84</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-28.729904</td>
      <td>-2.062339</td>
      <td>16</td>
    </tr>
    <tr>
      <th>85</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-31.149723</td>
      <td>-1.808734</td>
      <td>18</td>
    </tr>
    <tr>
      <th>86</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-33.916054</td>
      <td>-2.766331</td>
      <td>19</td>
    </tr>
    <tr>
      <th>87</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-33.916054</td>
      <td>-2.766331</td>
      <td>19</td>
    </tr>
    <tr>
      <th>88</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>9</td>
      <td>-2.440149</td>
      <td>-1.171158</td>
      <td>3</td>
    </tr>
    <tr>
      <th>89</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>9</td>
      <td>-3.292026</td>
      <td>-0.851876</td>
      <td>4</td>
    </tr>
    <tr>
      <th>90</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>9</td>
      <td>-6.777727</td>
      <td>-1.606708</td>
      <td>7</td>
    </tr>
    <tr>
      <th>91</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>9</td>
      <td>-6.363369</td>
      <td>0.414358</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FirstLastTfm" class="doc_header"><code>class</code> <code>FirstLastTfm</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L222" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FirstLastTfm</code>(<strong><code>gamma</code></strong>) :: <code>Transform</code></p>
</blockquote>
<p>Delegates (<code>__call__</code>,<code>decode</code>,<code>setup</code>) to (<code>encodes</code>,<code>decodes</code>,<code>setups</code>) if <code>split_idx</code> matches</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FirstLast" class="doc_header"><code>class</code> <code>FirstLast</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L246" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FirstLast</code>(<strong><code>gamma</code></strong>=<em><code>0.99</code></em>) :: <a href="/fastrl/callback.core.html#LoopCallback"><code>LoopCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> - after_create   : [GymLoop]
Start Setup
   - initialize     : [GymLoop]
End Setup
 - before_episodes: [GymLoop]
Start Episodes
   - reset          : [GymLoop]
   - do_action      : []
   - do_step        : [GymLoop]
   - do_render      : []
   - before_history : [GymLoop]
   - history        : [GymLoop]
   - after_history  : [GymLoop]
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>3</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>9</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>3</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>10</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>3</td>
      <td>11.0</td>
      <td>1.0</td>
      <td>11</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>3</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>12</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>3</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>13</td>
    </tr>
  </tbody>
</table>
<p>50 rows  11 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)[[</span><span class="s1">&#39;state_mu&#39;</span><span class="p">,</span><span class="s1">&#39;next_state_mu&#39;</span><span class="p">,</span><span class="s1">&#39;done&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state_mu</th>
      <th>next_state_mu</th>
      <th>done</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.000699</td>
      <td>0.034253</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.028172</td>
      <td>0.056223</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.007511</td>
      <td>0.079503</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.013154</td>
      <td>0.104525</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.034253</td>
      <td>0.131715</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.056223</td>
      <td>0.112793</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.079503</td>
      <td>0.096144</td>
      <td>False</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.104525</td>
      <td>0.129485</td>
      <td>False</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.131715</td>
      <td>0.117323</td>
      <td>False</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.112793</td>
      <td>0.107383</td>
      <td>False</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.096144</td>
      <td>0.099330</td>
      <td>False</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.129485</td>
      <td>0.092814</td>
      <td>True</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.117323</td>
      <td>0.092814</td>
      <td>True</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.107383</td>
      <td>0.092814</td>
      <td>True</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.099330</td>
      <td>0.092814</td>
      <td>True</td>
    </tr>
    <tr>
      <th>15</th>
      <td>-0.006469</td>
      <td>0.098796</td>
      <td>False</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.018629</td>
      <td>0.128597</td>
      <td>False</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.044247</td>
      <td>0.112231</td>
      <td>False</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.070823</td>
      <td>0.145962</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.098796</td>
      <td>0.181943</td>
      <td>False</td>
    </tr>
    <tr>
      <th>20</th>
      <td>0.128597</td>
      <td>0.173612</td>
      <td>False</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0.112231</td>
      <td>0.214269</td>
      <td>True</td>
    </tr>
    <tr>
      <th>22</th>
      <td>0.145962</td>
      <td>0.214269</td>
      <td>True</td>
    </tr>
    <tr>
      <th>23</th>
      <td>0.181943</td>
      <td>0.214269</td>
      <td>True</td>
    </tr>
    <tr>
      <th>24</th>
      <td>0.173612</td>
      <td>0.214269</td>
      <td>True</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0.010581</td>
      <td>0.020129</td>
      <td>False</td>
    </tr>
    <tr>
      <th>26</th>
      <td>0.036389</td>
      <td>0.047751</td>
      <td>False</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0.062689</td>
      <td>0.075942</td>
      <td>False</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0.041184</td>
      <td>0.105141</td>
      <td>False</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0.020129</td>
      <td>0.087288</td>
      <td>False</td>
    </tr>
    <tr>
      <th>30</th>
      <td>0.047751</td>
      <td>0.070545</td>
      <td>False</td>
    </tr>
    <tr>
      <th>31</th>
      <td>0.075942</td>
      <td>0.102638</td>
      <td>False</td>
    </tr>
    <tr>
      <th>32</th>
      <td>0.105141</td>
      <td>0.135878</td>
      <td>False</td>
    </tr>
    <tr>
      <th>33</th>
      <td>0.087288</td>
      <td>0.122923</td>
      <td>False</td>
    </tr>
    <tr>
      <th>34</th>
      <td>0.070545</td>
      <td>0.111413</td>
      <td>False</td>
    </tr>
    <tr>
      <th>35</th>
      <td>0.102638</td>
      <td>0.147998</td>
      <td>False</td>
    </tr>
    <tr>
      <th>36</th>
      <td>0.135878</td>
      <td>0.185937</td>
      <td>False</td>
    </tr>
    <tr>
      <th>37</th>
      <td>0.122923</td>
      <td>0.225632</td>
      <td>False</td>
    </tr>
    <tr>
      <th>38</th>
      <td>0.111413</td>
      <td>0.221846</td>
      <td>True</td>
    </tr>
    <tr>
      <th>39</th>
      <td>0.147998</td>
      <td>0.221846</td>
      <td>True</td>
    </tr>
    <tr>
      <th>40</th>
      <td>0.185937</td>
      <td>0.221846</td>
      <td>True</td>
    </tr>
    <tr>
      <th>41</th>
      <td>0.225632</td>
      <td>0.221846</td>
      <td>True</td>
    </tr>
    <tr>
      <th>42</th>
      <td>0.003274</td>
      <td>-0.058183</td>
      <td>False</td>
    </tr>
    <tr>
      <th>43</th>
      <td>-0.023081</td>
      <td>-0.088124</td>
      <td>False</td>
    </tr>
    <tr>
      <th>44</th>
      <td>-0.049919</td>
      <td>-0.071139</td>
      <td>False</td>
    </tr>
    <tr>
      <th>45</th>
      <td>-0.077677</td>
      <td>-0.103364</td>
      <td>False</td>
    </tr>
    <tr>
      <th>46</th>
      <td>-0.058183</td>
      <td>-0.137063</td>
      <td>False</td>
    </tr>
    <tr>
      <th>47</th>
      <td>-0.088124</td>
      <td>-0.125099</td>
      <td>False</td>
    </tr>
    <tr>
      <th>48</th>
      <td>-0.071139</td>
      <td>-0.162047</td>
      <td>False</td>
    </tr>
    <tr>
      <th>49</th>
      <td>-0.103364</td>
      <td>-0.154456</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/fastrl_user/.local/lib/python3.8/site-packages/gym/logger.py:30: UserWarning: <span class="ansi-yellow-fg">WARN: Box bound precision lowered by casting to float32</span>
  warnings.warn(colorize(&#39;%s: %s&#39;%(&#39;WARN&#39;, msg % args), &#39;yellow&#39;))
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
WalkerBase::__init__
WalkerBase::__init__
argv[0]=
argv[0]=
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-3.661248</td>
      <td>-0.333313</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-9.046903</td>
      <td>-0.899325</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-11.993315</td>
      <td>-1.271708</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-15.924226</td>
      <td>-1.988402</td>
      <td>12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-20.206795</td>
      <td>-0.285302</td>
      <td>15</td>
    </tr>
    <tr>
      <th>5</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-26.113724</td>
      <td>-1.177552</td>
      <td>18</td>
    </tr>
    <tr>
      <th>6</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-30.283020</td>
      <td>-3.779318</td>
      <td>20</td>
    </tr>
    <tr>
      <th>7</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-7.261517</td>
      <td>-1.938820</td>
      <td>3</td>
    </tr>
    <tr>
      <th>8</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-14.633886</td>
      <td>-3.027365</td>
      <td>6</td>
    </tr>
    <tr>
      <th>9</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-18.117558</td>
      <td>-1.118295</td>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-22.884604</td>
      <td>-2.263593</td>
      <td>12</td>
    </tr>
    <tr>
      <th>11</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-28.684866</td>
      <td>-3.850334</td>
      <td>15</td>
    </tr>
    <tr>
      <th>12</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-38.039516</td>
      <td>-5.880764</td>
      <td>18</td>
    </tr>
    <tr>
      <th>13</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-44.120502</td>
      <td>-6.080986</td>
      <td>19</td>
    </tr>
    <tr>
      <th>14</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-1.529902</td>
      <td>-2.011593</td>
      <td>3</td>
    </tr>
    <tr>
      <th>15</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-7.634884</td>
      <td>-0.134570</td>
      <td>6</td>
    </tr>
    <tr>
      <th>16</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-15.026217</td>
      <td>-1.365077</td>
      <td>9</td>
    </tr>
    <tr>
      <th>17</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-24.168882</td>
      <td>-4.212185</td>
      <td>12</td>
    </tr>
    <tr>
      <th>18</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-30.013069</td>
      <td>-0.538923</td>
      <td>15</td>
    </tr>
    <tr>
      <th>19</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-33.434662</td>
      <td>-1.195339</td>
      <td>18</td>
    </tr>
    <tr>
      <th>20</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-38.855690</td>
      <td>-4.334508</td>
      <td>20</td>
    </tr>
    <tr>
      <th>21</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-4.147883</td>
      <td>-1.318820</td>
      <td>3</td>
    </tr>
    <tr>
      <th>22</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-9.352345</td>
      <td>-1.243731</td>
      <td>6</td>
    </tr>
    <tr>
      <th>23</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-12.342112</td>
      <td>-1.606035</td>
      <td>9</td>
    </tr>
    <tr>
      <th>24</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-20.257011</td>
      <td>-2.234111</td>
      <td>12</td>
    </tr>
    <tr>
      <th>25</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-22.500538</td>
      <td>-1.050539</td>
      <td>15</td>
    </tr>
    <tr>
      <th>26</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-27.855471</td>
      <td>-4.004893</td>
      <td>18</td>
    </tr>
    <tr>
      <th>27</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-3.071068</td>
      <td>-0.942555</td>
      <td>3</td>
    </tr>
    <tr>
      <th>28</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-14.742078</td>
      <td>-1.693805</td>
      <td>6</td>
    </tr>
    <tr>
      <th>29</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-19.817450</td>
      <td>-0.074149</td>
      <td>9</td>
    </tr>
    <tr>
      <th>30</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-23.395073</td>
      <td>-1.774648</td>
      <td>12</td>
    </tr>
    <tr>
      <th>31</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-29.495314</td>
      <td>-0.569925</td>
      <td>15</td>
    </tr>
    <tr>
      <th>32</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-38.437305</td>
      <td>-5.899004</td>
      <td>18</td>
    </tr>
    <tr>
      <th>33</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-6.097451</td>
      <td>-2.745735</td>
      <td>3</td>
    </tr>
    <tr>
      <th>34</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-11.184669</td>
      <td>-0.396155</td>
      <td>6</td>
    </tr>
    <tr>
      <th>35</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-16.875130</td>
      <td>-1.878185</td>
      <td>9</td>
    </tr>
    <tr>
      <th>36</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-19.626888</td>
      <td>-0.437903</td>
      <td>12</td>
    </tr>
    <tr>
      <th>37</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-24.645027</td>
      <td>-2.181582</td>
      <td>15</td>
    </tr>
    <tr>
      <th>38</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-32.517323</td>
      <td>-2.386982</td>
      <td>18</td>
    </tr>
    <tr>
      <th>39</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-40.851501</td>
      <td>-6.277852</td>
      <td>20</td>
    </tr>
    <tr>
      <th>40</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-2.471194</td>
      <td>-0.843793</td>
      <td>3</td>
    </tr>
    <tr>
      <th>41</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-7.369725</td>
      <td>-1.605930</td>
      <td>6</td>
    </tr>
    <tr>
      <th>42</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-14.734154</td>
      <td>-0.718450</td>
      <td>9</td>
    </tr>
    <tr>
      <th>43</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-22.592585</td>
      <td>-2.627511</td>
      <td>12</td>
    </tr>
    <tr>
      <th>44</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-27.045147</td>
      <td>-0.356624</td>
      <td>15</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-35.093491</td>
      <td>-5.931699</td>
      <td>18</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-2.982337</td>
      <td>-1.604773</td>
      <td>3</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-4.566295</td>
      <td>-0.589242</td>
      <td>6</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-5.964446</td>
      <td>-0.185426</td>
      <td>9</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-7.404365</td>
      <td>-0.281108</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Metrics">Metrics<a class="anchor-link" href="#Metrics"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Reward" class="doc_header"><code>class</code> <code>Reward</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L259" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Reward</code>() :: <code>Metric</code></p>
</blockquote>
<p>Blueprint for defining a metric</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NEpisodes" class="doc_header"><code>class</code> <code>NEpisodes</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L278" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NEpisodes</code>() :: <code>Metric</code></p>
</blockquote>
<p>Blueprint for defining a metric</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">torch.nn</span> <span class="kn">import</span> <span class="n">Linear</span>

<span class="k">class</span> <span class="nc">FakeModel</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span><span class="o">=</span><span class="n">Linear</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
<span class="c1">#         print(x)</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">])</span>
<span class="n">block</span><span class="o">=</span><span class="n">SourceDataBlock</span><span class="p">()</span>
<span class="n">dls</span><span class="o">=</span><span class="n">block</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">([</span><span class="n">source</span><span class="p">],</span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">learn</span><span class="o">=</span><span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span><span class="n">FakeModel</span><span class="p">(),</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">Reward</span><span class="p">,</span><span class="n">NEpisodes</span><span class="p">],</span><span class="n">loss_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">o</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Could not do one pass in your dataloader, there is something wrong in it
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>train_reward</th>
      <th>train_n_episodes</th>
      <th>valid_loss</th>
      <th>valid_reward</th>
      <th>valid_n_episodes</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.000000</td>
      <td>22.227273</td>
      <td>44</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.000000</td>
      <td>21.173913</td>
      <td>92</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.000000</td>
      <td>22.100000</td>
      <td>131</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.000000</td>
      <td>23.450000</td>
      <td>172</td>
      <td>00:05</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Export">Export<a class="anchor-link" href="#Export"> </a></h2>
</div>
</div>
</div>
</div>
 

