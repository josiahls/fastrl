---

title: Data Block Gym


keywords: fastai
sidebar: home_sidebar

summary: "openai gym sources"
description: "openai gym sources"
nb_path: "nbs/05c_data.gym.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/05c_data.gym.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="GymSource">GymSource<a class="anchor-link" href="#GymSource"> </a></h2><blockquote><p>The base iterable used for iterating through environments.</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_loop</span><span class="o">=</span><span class="n">L</span><span class="p">([</span><span class="s1">&#39;event.after_create&#39;</span><span class="p">,</span><span class="s1">&#39;Start Setup&#39;</span><span class="p">,</span><span class="s1">&#39;event.initialize&#39;</span><span class="p">,</span><span class="s1">&#39;End Setup&#39;</span><span class="p">,</span>
             <span class="s1">&#39;event.before_episodes&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Start Episodes&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.reset&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.do_action&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.do_step&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.do_render&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.before_history&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.history&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.after_history&#39;</span><span class="p">,</span>
             <span class="s1">&#39;End Episodes&#39;</span><span class="p">,</span>
             <span class="s1">&#39;event.after_episodes&#39;</span>
             <span class="p">])</span>

<span class="n">mk_class</span><span class="p">(</span><span class="s1">&#39;source_events&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">parse_events</span><span class="p">(</span><span class="n">_loop</span><span class="p">)</span><span class="o">.</span><span class="n">map_dict</span><span class="p">(),</span>
         <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;All possible events as attributes to get tab-completion and typo-proofing&quot;</span><span class="p">)</span>

<span class="n">_all_</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;source_events&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="return_data" class="doc_header"><code>return_data</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L52" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>return_data</code>(<strong><code>o</code></strong>:<code>dict</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Source" class="doc_header"><code>class</code> <code>Source</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block_simple.py#L53" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Source</code>(<strong><code>cbs</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/callback.core.html#Loop"><code>Loop</code></a></p>
</blockquote>
<p>Inherit from this to have all attr accesses in <code>self._xtra</code> passed down to <code>self.default</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">return_data</span><span class="p">(</span><span class="n">o</span><span class="p">:</span><span class="nb">dict</span><span class="p">):</span> 
    <span class="n">source</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">o</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">],</span><span class="n">o</span><span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;source&#39;</span><span class="p">:</span><span class="n">source</span><span class="p">,</span><span class="s1">&#39;history&#39;</span><span class="p">:</span><span class="n">data</span><span class="p">}</span>

<span class="k">class</span> <span class="nc">Source</span><span class="p">(</span><span class="n">Loop</span><span class="p">):</span>
    <span class="n">_loop</span><span class="o">=</span><span class="n">_loop</span>
    <span class="n">_events</span><span class="o">=</span><span class="n">source_events</span>
    <span class="n">_default</span><span class="o">=</span><span class="s1">&#39;source&#39;</span>    
    <span class="n">end_event</span><span class="o">=</span><span class="n">parse_events</span><span class="p">(</span><span class="n">_loop</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="nd">@delegates</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">test_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_fields</span><span class="o">=</span><span class="s1">&#39;state,next_state,done,all_done,env_id,worker_id&#39;</span>\
                           <span class="s1">&#39;,action,episode_id,accum_rewards,reward,step&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_fields</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_field</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">return_fn</span><span class="o">=</span><span class="n">return_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loop_history_yield</span><span class="o">=</span><span class="kc">False</span>
        <span class="n">store_attr</span><span class="p">(</span><span class="n">but</span><span class="o">=</span><span class="s1">&#39;cbs&#39;</span><span class="p">,</span><span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">next_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">done</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">all_done</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">env_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">episode_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">accum_rewards</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">reward</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                   <span class="n">skip_history_return</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cbs</span><span class="o">=</span><span class="n">cbs</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">after_create</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;initialize&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
    
    <span class="k">def</span> <span class="nf">_history</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loop_history_yield</span><span class="o">=</span><span class="kc">False</span>
        <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;history&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_mode</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">this</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;test_field&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fields</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;test_field&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_fn</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">history</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">()))[</span><span class="s1">&#39;history&#39;</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">BD</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">BD</span><span class="p">({</span><span class="n">s</span><span class="p">:(</span><span class="n">ifnone</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span><span class="n">TensorBatch</span><span class="p">([[</span><span class="mi">0</span><span class="p">]]))</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_mode</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">s</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fields</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">in_</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ignore_fields</span><span class="p">)})</span>
        
    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;before_episodes&#39;</span><span class="p">)</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="o">+=</span><span class="mi">1</span>
            <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;reset&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;do_action&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;do_step&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_mode</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_field</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;do_render&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;before_history&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_history_return</span><span class="p">:</span> <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">_history</span><span class="p">()</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">loop_history_yield</span><span class="p">:</span>   <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">_history</span><span class="p">()</span>
            <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;after_history&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So the <a href="/fastrl/data.gym.html#Source"><code>Source</code></a> object does a simple loop that returns a dictionary. 
This is going to be similar to what the rest of fastrl will be expecting.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span><span class="n">test_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)):</span> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[1, 1, 1, 1, 1]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[2, 2, 2, 2, 2]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[3, 3, 3, 3, 3]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[4, 4, 4, 4, 4]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[5, 5, 5, 5, 5]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[6, 6, 6, 6, 6]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[7, 7, 7, 7, 7]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[8, 8, 8, 8, 8]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[9, 9, 9, 9, 9]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[10, 10, 10, 10, 10]])}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Source</span><span class="p">()</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> - after_create   : []
Start Setup
   - initialize     : []
End Setup
 - before_episodes: []
Start Episodes
   - reset          : []
   - do_action      : []
   - do_step        : []
   - do_render      : []
   - before_history : []
   - history        : []
   - after_history  : []
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ReturnHistory" class="doc_header"><code>class</code> <code>ReturnHistory</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L108" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ReturnHistory</code>(<strong><code>enc</code></strong>=<em><code>None</code></em>, <strong><code>dec</code></strong>=<em><code>None</code></em>, <strong><code>split_idx</code></strong>=<em><code>None</code></em>, <strong><code>order</code></strong>=<em><code>None</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>Delegates (<code>__call__</code>,<code>decode</code>,<code>setup</code>) to (<code>encodes</code>,<code>decodes</code>,<code>setups</code>) if <code>split_idx</code> matches</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">LoopCallback</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>fastrl.callback.core.LoopCallback</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TstCallback" class="doc_header"><code>class</code> <code>TstCallback</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L119" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TstCallback</code>(<strong><code>action_space</code></strong>=<em><code>None</code></em>, <strong><code>constant</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/agent.html#AgentCallback"><code>AgentCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="np_type_cast" class="doc_header"><code>np_type_cast</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L128" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>np_type_cast</code>(<strong><code>a</code></strong>, <strong><code>dtype</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GymLoop" class="doc_header"><code>class</code> <code>GymLoop</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L130" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GymLoop</code>(<strong><code>env_name</code></strong>:<code>str</code>, <strong><code>agent</code></strong>=<em><code>None</code></em>, <strong><code>mode</code></strong>=<em><code>None</code></em>, <strong><code>steps_count</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>steps_delta</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>seed</code></strong>:<code>int</code>=<em><code>None</code></em>, <strong><code>worker_id</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>dtype</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/callback.core.html#LoopCallback"><code>LoopCallback</code></a></p>
</blockquote>
<p>Handles iterating through single openai gym (and varients).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>pybullet build time: Jul  5 2021 18:24:41
/home/fastrl_user/.local/lib/python3.8/site-packages/gym/logger.py:30: UserWarning: <span class="ansi-yellow-fg">WARN: Box bound precision lowered by casting to float32</span>
  warnings.warn(colorize(&#39;%s: %s&#39;%(&#39;WARN&#39;, msg % args), &#39;yellow&#39;))
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> - after_create   : [GymLoop]
Start Setup
   - initialize     : [GymLoop]
End Setup
 - before_episodes: [GymLoop]
Start Episodes
   - reset          : [GymLoop]
   - do_action      : []
   - do_step        : [GymLoop]
   - do_render      : []
   - before_history : [GymLoop]
   - history        : [GymLoop]
   - after_history  : []
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
WalkerBase::__init__
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-2.772392</td>
      <td>-0.703916</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-6.037870</td>
      <td>-3.265479</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-8.907743</td>
      <td>-1.723868</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-9.830730</td>
      <td>-0.922988</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-11.928905</td>
      <td>-1.108426</td>
      <td>11</td>
    </tr>
    <tr>
      <th>5</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-13.916922</td>
      <td>-1.988016</td>
      <td>12</td>
    </tr>
    <tr>
      <th>6</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-15.302870</td>
      <td>-0.364240</td>
      <td>15</td>
    </tr>
    <tr>
      <th>7</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-15.445946</td>
      <td>-0.143076</td>
      <td>16</td>
    </tr>
    <tr>
      <th>8</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-17.023933</td>
      <td>-1.031698</td>
      <td>18</td>
    </tr>
    <tr>
      <th>9</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-21.976149</td>
      <td>-4.952216</td>
      <td>19</td>
    </tr>
    <tr>
      <th>10</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-21.976149</td>
      <td>-4.952216</td>
      <td>19</td>
    </tr>
    <tr>
      <th>11</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-4.222231</td>
      <td>-1.646811</td>
      <td>3</td>
    </tr>
    <tr>
      <th>12</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-4.718509</td>
      <td>-0.496278</td>
      <td>4</td>
    </tr>
    <tr>
      <th>13</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-7.634906</td>
      <td>-1.648465</td>
      <td>7</td>
    </tr>
    <tr>
      <th>14</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-9.735494</td>
      <td>-2.100587</td>
      <td>8</td>
    </tr>
    <tr>
      <th>15</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-14.106408</td>
      <td>-2.196601</td>
      <td>11</td>
    </tr>
    <tr>
      <th>16</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-14.561575</td>
      <td>-0.455166</td>
      <td>12</td>
    </tr>
    <tr>
      <th>17</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-16.688889</td>
      <td>-0.896337</td>
      <td>15</td>
    </tr>
    <tr>
      <th>18</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-19.834337</td>
      <td>-3.145448</td>
      <td>16</td>
    </tr>
    <tr>
      <th>19</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-24.511082</td>
      <td>-2.627535</td>
      <td>18</td>
    </tr>
    <tr>
      <th>20</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-28.609730</td>
      <td>-4.098648</td>
      <td>19</td>
    </tr>
    <tr>
      <th>21</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-28.609730</td>
      <td>-4.098648</td>
      <td>19</td>
    </tr>
    <tr>
      <th>22</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-1.599829</td>
      <td>-0.120654</td>
      <td>3</td>
    </tr>
    <tr>
      <th>23</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-4.153436</td>
      <td>-2.553608</td>
      <td>4</td>
    </tr>
    <tr>
      <th>24</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-10.730353</td>
      <td>-3.300722</td>
      <td>7</td>
    </tr>
    <tr>
      <th>25</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-11.863098</td>
      <td>-1.132745</td>
      <td>8</td>
    </tr>
    <tr>
      <th>26</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-18.862953</td>
      <td>-3.599790</td>
      <td>11</td>
    </tr>
    <tr>
      <th>27</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-19.625526</td>
      <td>-0.762572</td>
      <td>12</td>
    </tr>
    <tr>
      <th>28</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-24.620237</td>
      <td>-1.639287</td>
      <td>15</td>
    </tr>
    <tr>
      <th>29</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-26.085754</td>
      <td>-1.465518</td>
      <td>16</td>
    </tr>
    <tr>
      <th>30</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-28.088503</td>
      <td>-2.002748</td>
      <td>17</td>
    </tr>
    <tr>
      <th>31</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-37.633804</td>
      <td>-9.545303</td>
      <td>18</td>
    </tr>
    <tr>
      <th>32</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-37.633804</td>
      <td>-9.545303</td>
      <td>18</td>
    </tr>
    <tr>
      <th>33</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-4.995764</td>
      <td>-0.560376</td>
      <td>3</td>
    </tr>
    <tr>
      <th>34</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-7.705706</td>
      <td>-2.709942</td>
      <td>4</td>
    </tr>
    <tr>
      <th>35</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-13.636304</td>
      <td>-3.054055</td>
      <td>7</td>
    </tr>
    <tr>
      <th>36</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-15.289376</td>
      <td>-1.653072</td>
      <td>8</td>
    </tr>
    <tr>
      <th>37</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-17.755810</td>
      <td>-0.857684</td>
      <td>11</td>
    </tr>
    <tr>
      <th>38</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-20.114172</td>
      <td>-2.358363</td>
      <td>12</td>
    </tr>
    <tr>
      <th>39</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-24.678286</td>
      <td>0.231855</td>
      <td>15</td>
    </tr>
    <tr>
      <th>40</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-24.482262</td>
      <td>0.196023</td>
      <td>16</td>
    </tr>
    <tr>
      <th>41</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-26.162098</td>
      <td>-1.679836</td>
      <td>17</td>
    </tr>
    <tr>
      <th>42</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-30.943676</td>
      <td>-4.781578</td>
      <td>18</td>
    </tr>
    <tr>
      <th>43</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-30.943676</td>
      <td>-4.781578</td>
      <td>18</td>
    </tr>
    <tr>
      <th>44</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-3.414682</td>
      <td>-1.001137</td>
      <td>3</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-4.249272</td>
      <td>-0.834590</td>
      <td>4</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-7.754905</td>
      <td>-0.832777</td>
      <td>7</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-9.958241</td>
      <td>-2.203336</td>
      <td>8</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-16.134068</td>
      <td>-1.188284</td>
      <td>11</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-16.788990</td>
      <td>-0.654923</td>
      <td>12</td>
    </tr>
    <tr>
      <th>50</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-21.873972</td>
      <td>-3.237127</td>
      <td>15</td>
    </tr>
    <tr>
      <th>51</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-24.375334</td>
      <td>-2.501361</td>
      <td>16</td>
    </tr>
    <tr>
      <th>52</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-24.937262</td>
      <td>-0.561928</td>
      <td>17</td>
    </tr>
    <tr>
      <th>53</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-28.566380</td>
      <td>-3.629117</td>
      <td>18</td>
    </tr>
    <tr>
      <th>54</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-28.566380</td>
      <td>-3.629117</td>
      <td>18</td>
    </tr>
    <tr>
      <th>55</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-3.349751</td>
      <td>-0.738286</td>
      <td>3</td>
    </tr>
    <tr>
      <th>56</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-3.808184</td>
      <td>-0.458433</td>
      <td>4</td>
    </tr>
    <tr>
      <th>57</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-5.616296</td>
      <td>-0.342194</td>
      <td>7</td>
    </tr>
    <tr>
      <th>58</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-6.482625</td>
      <td>-0.866329</td>
      <td>8</td>
    </tr>
    <tr>
      <th>59</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-9.983315</td>
      <td>-0.773771</td>
      <td>11</td>
    </tr>
    <tr>
      <th>60</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-9.417305</td>
      <td>0.566010</td>
      <td>12</td>
    </tr>
    <tr>
      <th>61</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-16.618393</td>
      <td>-1.665806</td>
      <td>15</td>
    </tr>
    <tr>
      <th>62</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-19.253141</td>
      <td>-2.634748</td>
      <td>16</td>
    </tr>
    <tr>
      <th>63</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-22.689598</td>
      <td>-2.931964</td>
      <td>18</td>
    </tr>
    <tr>
      <th>64</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-26.984053</td>
      <td>-4.294455</td>
      <td>19</td>
    </tr>
    <tr>
      <th>65</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-26.984053</td>
      <td>-4.294455</td>
      <td>19</td>
    </tr>
    <tr>
      <th>66</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-0.346445</td>
      <td>0.336984</td>
      <td>3</td>
    </tr>
    <tr>
      <th>67</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-1.607222</td>
      <td>-1.260777</td>
      <td>4</td>
    </tr>
    <tr>
      <th>68</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-5.116210</td>
      <td>-1.305842</td>
      <td>7</td>
    </tr>
    <tr>
      <th>69</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-5.546855</td>
      <td>-0.430646</td>
      <td>8</td>
    </tr>
    <tr>
      <th>70</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-7.426655</td>
      <td>-0.207850</td>
      <td>11</td>
    </tr>
    <tr>
      <th>71</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-10.516122</td>
      <td>-3.089466</td>
      <td>12</td>
    </tr>
    <tr>
      <th>72</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-14.315556</td>
      <td>-0.610432</td>
      <td>15</td>
    </tr>
    <tr>
      <th>73</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-15.727588</td>
      <td>-1.412032</td>
      <td>16</td>
    </tr>
    <tr>
      <th>74</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-21.490356</td>
      <td>-3.135665</td>
      <td>19</td>
    </tr>
    <tr>
      <th>75</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-22.893673</td>
      <td>-1.403317</td>
      <td>20</td>
    </tr>
    <tr>
      <th>76</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-22.893673</td>
      <td>-1.403317</td>
      <td>20</td>
    </tr>
    <tr>
      <th>77</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-25.884834</td>
      <td>-2.991162</td>
      <td>21</td>
    </tr>
    <tr>
      <th>78</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-25.884834</td>
      <td>-2.991162</td>
      <td>21</td>
    </tr>
    <tr>
      <th>79</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-2.277223</td>
      <td>0.039623</td>
      <td>3</td>
    </tr>
    <tr>
      <th>80</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-4.329580</td>
      <td>-2.052356</td>
      <td>4</td>
    </tr>
    <tr>
      <th>81</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-11.617547</td>
      <td>-0.693511</td>
      <td>7</td>
    </tr>
    <tr>
      <th>82</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-12.330168</td>
      <td>-0.712620</td>
      <td>8</td>
    </tr>
    <tr>
      <th>83</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-17.139971</td>
      <td>-2.106302</td>
      <td>11</td>
    </tr>
    <tr>
      <th>84</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-19.018978</td>
      <td>-1.879007</td>
      <td>12</td>
    </tr>
    <tr>
      <th>85</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-25.877340</td>
      <td>-1.394762</td>
      <td>15</td>
    </tr>
    <tr>
      <th>86</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-28.240461</td>
      <td>-2.363121</td>
      <td>16</td>
    </tr>
    <tr>
      <th>87</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-29.767754</td>
      <td>-1.527293</td>
      <td>17</td>
    </tr>
    <tr>
      <th>88</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-35.604412</td>
      <td>-5.836659</td>
      <td>18</td>
    </tr>
    <tr>
      <th>89</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-35.604412</td>
      <td>-5.836659</td>
      <td>18</td>
    </tr>
    <tr>
      <th>90</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>9</td>
      <td>-0.837417</td>
      <td>-0.271403</td>
      <td>3</td>
    </tr>
    <tr>
      <th>91</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>9</td>
      <td>-1.759355</td>
      <td>-0.921939</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FirstLastTfm" class="doc_header"><code>class</code> <code>FirstLastTfm</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L218" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FirstLastTfm</code>(<strong><code>enc</code></strong>=<em><code>None</code></em>, <strong><code>dec</code></strong>=<em><code>None</code></em>, <strong><code>split_idx</code></strong>=<em><code>None</code></em>, <strong><code>order</code></strong>=<em><code>None</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>Delegates (<code>__call__</code>,<code>decode</code>,<code>setup</code>) to (<code>encodes</code>,<code>decodes</code>,<code>setups</code>) if <code>split_idx</code> matches</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FirstLast" class="doc_header"><code>class</code> <code>FirstLast</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L235" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FirstLast</code>(<strong><code>gamma</code></strong>=<em><code>0.99</code></em>) :: <a href="/fastrl/callback.core.html#LoopCallback"><code>LoopCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> - after_create   : [GymLoop]
Start Setup
   - initialize     : [GymLoop]
End Setup
 - before_episodes: [GymLoop]
Start Episodes
   - reset          : [GymLoop]
   - do_action      : []
   - do_step        : [GymLoop]
   - do_render      : []
   - before_history : [GymLoop]
   - history        : [GymLoop]
   - after_history  : []
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
WalkerBase::__init__
WalkerBase::__init__
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/fastrl_user/.local/lib/python3.8/site-packages/gym/logger.py:30: UserWarning: <span class="ansi-yellow-fg">WARN: Box bound precision lowered by casting to float32</span>
  warnings.warn(colorize(&#39;%s: %s&#39;%(&#39;WARN&#39;, msg % args), &#39;yellow&#39;))
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-5.286104</td>
      <td>-2.976642</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-8.538820</td>
      <td>0.132065</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-11.833439</td>
      <td>0.070774</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-15.690530</td>
      <td>-1.612930</td>
      <td>12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-23.130953</td>
      <td>-1.301780</td>
      <td>15</td>
    </tr>
    <tr>
      <th>5</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-27.691254</td>
      <td>-0.920398</td>
      <td>18</td>
    </tr>
    <tr>
      <th>6</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-34.299675</td>
      <td>-5.217374</td>
      <td>20</td>
    </tr>
    <tr>
      <th>7</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-1.859004</td>
      <td>0.149776</td>
      <td>3</td>
    </tr>
    <tr>
      <th>8</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-6.107593</td>
      <td>-1.283192</td>
      <td>6</td>
    </tr>
    <tr>
      <th>9</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-16.012341</td>
      <td>-3.008198</td>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-17.162737</td>
      <td>0.118767</td>
      <td>12</td>
    </tr>
    <tr>
      <th>11</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-19.722340</td>
      <td>-0.586667</td>
      <td>15</td>
    </tr>
    <tr>
      <th>12</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-25.099253</td>
      <td>-4.171678</td>
      <td>18</td>
    </tr>
    <tr>
      <th>13</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-4.258598</td>
      <td>-0.614551</td>
      <td>3</td>
    </tr>
    <tr>
      <th>14</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-8.199117</td>
      <td>-1.979575</td>
      <td>6</td>
    </tr>
    <tr>
      <th>15</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-13.766356</td>
      <td>-3.695593</td>
      <td>9</td>
    </tr>
    <tr>
      <th>16</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-18.829597</td>
      <td>-4.072575</td>
      <td>12</td>
    </tr>
    <tr>
      <th>17</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-21.675209</td>
      <td>0.628857</td>
      <td>15</td>
    </tr>
    <tr>
      <th>18</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-29.289783</td>
      <td>-3.895962</td>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-32.195938</td>
      <td>-2.906153</td>
      <td>19</td>
    </tr>
    <tr>
      <th>20</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-2.008703</td>
      <td>-0.844009</td>
      <td>3</td>
    </tr>
    <tr>
      <th>21</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-3.975831</td>
      <td>-0.708411</td>
      <td>6</td>
    </tr>
    <tr>
      <th>22</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-6.382496</td>
      <td>-1.179051</td>
      <td>9</td>
    </tr>
    <tr>
      <th>23</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-11.367834</td>
      <td>-2.148569</td>
      <td>12</td>
    </tr>
    <tr>
      <th>24</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-13.185616</td>
      <td>-1.699597</td>
      <td>15</td>
    </tr>
    <tr>
      <th>25</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-19.573315</td>
      <td>-1.831546</td>
      <td>18</td>
    </tr>
    <tr>
      <th>26</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-25.207582</td>
      <td>-3.562773</td>
      <td>20</td>
    </tr>
    <tr>
      <th>27</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-3.329488</td>
      <td>-1.603983</td>
      <td>3</td>
    </tr>
    <tr>
      <th>28</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-6.104959</td>
      <td>-3.037370</td>
      <td>6</td>
    </tr>
    <tr>
      <th>29</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-14.912557</td>
      <td>-1.324166</td>
      <td>9</td>
    </tr>
    <tr>
      <th>30</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-21.814486</td>
      <td>-3.273962</td>
      <td>12</td>
    </tr>
    <tr>
      <th>31</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-25.918337</td>
      <td>-1.193678</td>
      <td>15</td>
    </tr>
    <tr>
      <th>32</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-30.389999</td>
      <td>-1.088036</td>
      <td>18</td>
    </tr>
    <tr>
      <th>33</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-34.998470</td>
      <td>-4.608471</td>
      <td>19</td>
    </tr>
    <tr>
      <th>34</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-1.351885</td>
      <td>-1.704382</td>
      <td>3</td>
    </tr>
    <tr>
      <th>35</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-4.681279</td>
      <td>-2.305839</td>
      <td>6</td>
    </tr>
    <tr>
      <th>36</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-9.892431</td>
      <td>-0.495581</td>
      <td>9</td>
    </tr>
    <tr>
      <th>37</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-15.306586</td>
      <td>-2.140765</td>
      <td>12</td>
    </tr>
    <tr>
      <th>38</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-19.310686</td>
      <td>-1.513433</td>
      <td>15</td>
    </tr>
    <tr>
      <th>39</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-22.071871</td>
      <td>0.090023</td>
      <td>18</td>
    </tr>
    <tr>
      <th>40</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-26.391861</td>
      <td>-4.319991</td>
      <td>19</td>
    </tr>
    <tr>
      <th>41</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-3.176344</td>
      <td>-1.876098</td>
      <td>3</td>
    </tr>
    <tr>
      <th>42</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-8.644979</td>
      <td>-0.555572</td>
      <td>6</td>
    </tr>
    <tr>
      <th>43</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-16.063450</td>
      <td>-1.581760</td>
      <td>9</td>
    </tr>
    <tr>
      <th>44</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-21.800528</td>
      <td>-2.113345</td>
      <td>12</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-26.467413</td>
      <td>-1.339564</td>
      <td>15</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-31.746658</td>
      <td>-0.827939</td>
      <td>18</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-35.997593</td>
      <td>-4.250936</td>
      <td>19</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-7.680771</td>
      <td>-4.506265</td>
      <td>3</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-17.021788</td>
      <td>-3.956140</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Metrics">Metrics<a class="anchor-link" href="#Metrics"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Reward" class="doc_header"><code>class</code> <code>Reward</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L250" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Reward</code>() :: <code>Metric</code></p>
</blockquote>
<p>Blueprint for defining a metric</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">torch.nn</span> <span class="kn">import</span> <span class="n">Linear</span>

<span class="k">class</span> <span class="nc">FakeModel</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span><span class="o">=</span><span class="n">Linear</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
<span class="c1">#         print(x)</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">])</span>
<span class="n">block</span><span class="o">=</span><span class="n">SourceDataBlock</span><span class="p">()</span>
<span class="n">dls</span><span class="o">=</span><span class="n">block</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">([</span><span class="n">source</span><span class="p">],</span><span class="n">n</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">bs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">learn</span><span class="o">=</span><span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span><span class="n">FakeModel</span><span class="p">(),</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">Reward</span><span class="p">],</span><span class="n">loss_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">o</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Could not do one pass in your dataloader, there is something wrong in it
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>train_reward</th>
      <th>valid_loss</th>
      <th>valid_reward</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.000000</td>
      <td>19.000000</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.000000</td>
      <td>18.894737</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.000000</td>
      <td>21.720000</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.000000</td>
      <td>22.593750</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Export">Export<a class="anchor-link" href="#Export"> </a></h2>
</div>
</div>
</div>
</div>
 

