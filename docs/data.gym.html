---

title: Data Block Gym


keywords: fastai
sidebar: home_sidebar

summary: "openai gym sources"
description: "openai gym sources"
nb_path: "nbs/05b_data.gym.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/05b_data.gym.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="GymSource">GymSource<a class="anchor-link" href="#GymSource"> </a></h2><blockquote><p>The base iterable used for iterating through environments.</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ReturnHistory" class="doc_header"><code>class</code> <code>ReturnHistory</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L35" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ReturnHistory</code>(<strong><code>enc</code></strong>=<em><code>None</code></em>, <strong><code>dec</code></strong>=<em><code>None</code></em>, <strong><code>split_idx</code></strong>=<em><code>None</code></em>, <strong><code>order</code></strong>=<em><code>None</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>Delegates (<code>__call__</code>,<code>decode</code>,<code>setup</code>) to (<code>encodes</code>,<code>decodes</code>,<code>setups</code>) if <code>split_idx</code> matches</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>enc</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>dec</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>split_idx</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>order</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">%(asctime)s</span><span class="s1">.</span><span class="si">%(msecs)03d</span><span class="s1">] p</span><span class="si">%(process)s</span><span class="s1"> {</span><span class="si">%(filename)s</span><span class="s1">:</span><span class="si">%(lineno)d</span><span class="s1">} </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">datefmt</span><span class="o">=</span><span class="s1">&#39;%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;INFO&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TstCallback" class="doc_header"><code>class</code> <code>TstCallback</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L46" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TstCallback</code>(<strong><code>action_space</code></strong>=<em><code>None</code></em>, <strong><code>constant</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/agent.html#AgentCallback"><code>AgentCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>action_space</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>constant</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="np_type_cast" class="doc_header"><code>np_type_cast</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L60" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>np_type_cast</code>(<strong><code>a</code></strong>, <strong><code>dtype</code></strong>)</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>a</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>dtype</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GymLoop" class="doc_header"><code>class</code> <code>GymLoop</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L62" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GymLoop</code>(<strong><code>env_name</code></strong>:<code>str</code>, <strong><code>agent</code></strong>=<em><code>None</code></em>, <strong><code>mode</code></strong>=<em><code>None</code></em>, <strong><code>steps_count</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>steps_delta</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>seed</code></strong>:<code>int</code>=<em><code>None</code></em>, <strong><code>worker_id</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>dtype</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/callback.core.html#LoopCallback"><code>LoopCallback</code></a></p>
</blockquote>
<p>Handles iterating through single openai gym (and varients).</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>env_name</code></strong> : <em><code>&lt;class 'str'&gt;</code></em></p>
</li>
<li><p><strong><code>agent</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>mode</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>steps_count</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>steps_delta</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>seed</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>worker_id</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>dtype</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/fastrl_user/.local/lib/python3.8/site-packages/gym/spaces/box.py:73: UserWarning: <span class="ansi-yellow-fg">WARN: Box bound precision lowered by casting to float32</span>
  logger.warn(
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> - after_create   : [GymLoop]
Start Setup
   - initialize     : [GymLoop]
End Setup
 - before_episodes: [GymLoop]
Start Episodes
   - reset          : [GymLoop]
   - do_action      : []
   - do_step        : [GymLoop]
   - do_render      : []
   - before_history : [GymLoop]
   - history        : [GymLoop]
   - after_history  : [GymLoop]
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">.</span><span class="n">cbs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">cbs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">action_executions</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">persistent</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
WalkerBase::__init__
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-0.346395</td>
      <td>-0.346395</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-1.989278</td>
      <td>-1.642883</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-2.606266</td>
      <td>-0.616988</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-3.601757</td>
      <td>-0.995490</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-3.847432</td>
      <td>-0.245675</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-8.673800</td>
      <td>-4.826368</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-9.286748</td>
      <td>-0.612949</td>
      <td>7</td>
    </tr>
    <tr>
      <th>7</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-12.093250</td>
      <td>-2.806502</td>
      <td>8</td>
    </tr>
    <tr>
      <th>8</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-12.642214</td>
      <td>-0.548963</td>
      <td>9</td>
    </tr>
    <tr>
      <th>9</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-15.417149</td>
      <td>-2.774935</td>
      <td>10</td>
    </tr>
    <tr>
      <th>10</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-18.067287</td>
      <td>-2.650138</td>
      <td>11</td>
    </tr>
    <tr>
      <th>11</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-21.938345</td>
      <td>-3.871057</td>
      <td>12</td>
    </tr>
    <tr>
      <th>12</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-22.794874</td>
      <td>-0.856530</td>
      <td>13</td>
    </tr>
    <tr>
      <th>13</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-23.477703</td>
      <td>-0.682830</td>
      <td>14</td>
    </tr>
    <tr>
      <th>14</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-23.153770</td>
      <td>0.323933</td>
      <td>15</td>
    </tr>
    <tr>
      <th>15</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-24.123732</td>
      <td>-0.969961</td>
      <td>16</td>
    </tr>
    <tr>
      <th>16</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-25.293123</td>
      <td>-1.169391</td>
      <td>17</td>
    </tr>
    <tr>
      <th>17</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-25.944977</td>
      <td>-0.651853</td>
      <td>18</td>
    </tr>
    <tr>
      <th>18</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-26.668486</td>
      <td>-0.723508</td>
      <td>19</td>
    </tr>
    <tr>
      <th>19</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-27.142799</td>
      <td>-0.474314</td>
      <td>20</td>
    </tr>
    <tr>
      <th>20</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-28.526520</td>
      <td>-1.383721</td>
      <td>21</td>
    </tr>
    <tr>
      <th>21</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-30.086580</td>
      <td>-1.560060</td>
      <td>22</td>
    </tr>
    <tr>
      <th>22</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-30.536558</td>
      <td>-0.449978</td>
      <td>23</td>
    </tr>
    <tr>
      <th>23</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-31.159590</td>
      <td>-0.623032</td>
      <td>24</td>
    </tr>
    <tr>
      <th>24</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-31.814390</td>
      <td>-0.654800</td>
      <td>25</td>
    </tr>
    <tr>
      <th>25</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-33.304089</td>
      <td>-1.489698</td>
      <td>26</td>
    </tr>
    <tr>
      <th>26</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-37.086315</td>
      <td>-3.782226</td>
      <td>27</td>
    </tr>
    <tr>
      <th>27</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>0.566735</td>
      <td>0.566735</td>
      <td>1</td>
    </tr>
    <tr>
      <th>28</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-0.874712</td>
      <td>-1.441447</td>
      <td>2</td>
    </tr>
    <tr>
      <th>29</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-4.845281</td>
      <td>-3.970569</td>
      <td>3</td>
    </tr>
    <tr>
      <th>30</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-6.964592</td>
      <td>-2.119311</td>
      <td>4</td>
    </tr>
    <tr>
      <th>31</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-9.182858</td>
      <td>-2.218267</td>
      <td>5</td>
    </tr>
    <tr>
      <th>32</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-9.357814</td>
      <td>-0.174955</td>
      <td>6</td>
    </tr>
    <tr>
      <th>33</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-11.279369</td>
      <td>-1.921556</td>
      <td>7</td>
    </tr>
    <tr>
      <th>34</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-12.712489</td>
      <td>-1.433120</td>
      <td>8</td>
    </tr>
    <tr>
      <th>35</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-13.091838</td>
      <td>-0.379349</td>
      <td>9</td>
    </tr>
    <tr>
      <th>36</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-14.461898</td>
      <td>-1.370060</td>
      <td>10</td>
    </tr>
    <tr>
      <th>37</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-16.725962</td>
      <td>-2.264065</td>
      <td>11</td>
    </tr>
    <tr>
      <th>38</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-21.084782</td>
      <td>-4.358819</td>
      <td>12</td>
    </tr>
    <tr>
      <th>39</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-26.180101</td>
      <td>-5.095320</td>
      <td>13</td>
    </tr>
    <tr>
      <th>40</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-29.151077</td>
      <td>-2.970977</td>
      <td>14</td>
    </tr>
    <tr>
      <th>41</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-31.299671</td>
      <td>-2.148594</td>
      <td>15</td>
    </tr>
    <tr>
      <th>42</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-31.917971</td>
      <td>-0.618299</td>
      <td>16</td>
    </tr>
    <tr>
      <th>43</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-31.716896</td>
      <td>0.201075</td>
      <td>17</td>
    </tr>
    <tr>
      <th>44</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-36.098579</td>
      <td>-4.381685</td>
      <td>18</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>0.236424</td>
      <td>0.236424</td>
      <td>1</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-3.228021</td>
      <td>-3.464445</td>
      <td>2</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-3.908509</td>
      <td>-0.680488</td>
      <td>3</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-6.289166</td>
      <td>-2.380658</td>
      <td>4</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-7.225783</td>
      <td>-0.936616</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">persistent</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/fastrl_user/.local/lib/python3.8/site-packages/gym/spaces/box.py:73: UserWarning: <span class="ansi-yellow-fg">WARN: Box bound precision lowered by casting to float32</span>
  logger.warn(
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
WalkerBase::__init__
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-1.792712</td>
      <td>0.068031</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-6.884916</td>
      <td>-5.092204</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-10.973625</td>
      <td>-1.848232</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-13.052986</td>
      <td>-2.079361</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-15.384211</td>
      <td>-1.074983</td>
      <td>11</td>
    </tr>
    <tr>
      <th>5</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-16.623713</td>
      <td>-1.239502</td>
      <td>12</td>
    </tr>
    <tr>
      <th>6</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-20.650810</td>
      <td>-3.448398</td>
      <td>15</td>
    </tr>
    <tr>
      <th>7</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-21.901648</td>
      <td>-1.250838</td>
      <td>16</td>
    </tr>
    <tr>
      <th>8</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-24.091351</td>
      <td>-1.628185</td>
      <td>18</td>
    </tr>
    <tr>
      <th>9</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-27.275190</td>
      <td>-3.183840</td>
      <td>19</td>
    </tr>
    <tr>
      <th>10</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-27.275190</td>
      <td>-3.183840</td>
      <td>19</td>
    </tr>
    <tr>
      <th>11</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-0.310941</td>
      <td>0.641965</td>
      <td>3</td>
    </tr>
    <tr>
      <th>12</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>0.172411</td>
      <td>0.483352</td>
      <td>4</td>
    </tr>
    <tr>
      <th>13</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-3.715571</td>
      <td>-2.769975</td>
      <td>7</td>
    </tr>
    <tr>
      <th>14</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-7.125558</td>
      <td>-3.409987</td>
      <td>8</td>
    </tr>
    <tr>
      <th>15</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-20.606375</td>
      <td>-4.426263</td>
      <td>11</td>
    </tr>
    <tr>
      <th>16</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-21.824005</td>
      <td>-1.217630</td>
      <td>12</td>
    </tr>
    <tr>
      <th>17</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-26.261145</td>
      <td>-0.789717</td>
      <td>15</td>
    </tr>
    <tr>
      <th>18</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-27.433624</td>
      <td>-1.172480</td>
      <td>16</td>
    </tr>
    <tr>
      <th>19</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-29.183830</td>
      <td>-0.139227</td>
      <td>18</td>
    </tr>
    <tr>
      <th>20</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-32.599075</td>
      <td>-3.415245</td>
      <td>19</td>
    </tr>
    <tr>
      <th>21</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-32.599075</td>
      <td>-3.415245</td>
      <td>19</td>
    </tr>
    <tr>
      <th>22</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-1.314217</td>
      <td>-1.910712</td>
      <td>3</td>
    </tr>
    <tr>
      <th>23</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-6.411792</td>
      <td>-5.097575</td>
      <td>4</td>
    </tr>
    <tr>
      <th>24</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-18.930330</td>
      <td>-2.389738</td>
      <td>7</td>
    </tr>
    <tr>
      <th>25</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-20.104860</td>
      <td>-1.174530</td>
      <td>8</td>
    </tr>
    <tr>
      <th>26</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-29.826389</td>
      <td>-5.658732</td>
      <td>11</td>
    </tr>
    <tr>
      <th>27</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-33.833237</td>
      <td>-4.006847</td>
      <td>12</td>
    </tr>
    <tr>
      <th>28</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-40.098171</td>
      <td>-2.114181</td>
      <td>15</td>
    </tr>
    <tr>
      <th>29</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-39.709385</td>
      <td>0.388786</td>
      <td>16</td>
    </tr>
    <tr>
      <th>30</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-39.709385</td>
      <td>0.388786</td>
      <td>16</td>
    </tr>
    <tr>
      <th>31</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-45.139557</td>
      <td>-5.430171</td>
      <td>17</td>
    </tr>
    <tr>
      <th>32</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-45.139557</td>
      <td>-5.430171</td>
      <td>17</td>
    </tr>
    <tr>
      <th>33</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-1.783228</td>
      <td>-0.083922</td>
      <td>3</td>
    </tr>
    <tr>
      <th>34</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-5.753044</td>
      <td>-3.969816</td>
      <td>4</td>
    </tr>
    <tr>
      <th>35</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-8.708631</td>
      <td>-1.295232</td>
      <td>7</td>
    </tr>
    <tr>
      <th>36</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-9.968853</td>
      <td>-1.260223</td>
      <td>8</td>
    </tr>
    <tr>
      <th>37</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-10.623779</td>
      <td>-0.586170</td>
      <td>11</td>
    </tr>
    <tr>
      <th>38</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-11.345322</td>
      <td>-0.721542</td>
      <td>12</td>
    </tr>
    <tr>
      <th>39</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-11.593336</td>
      <td>-0.051809</td>
      <td>15</td>
    </tr>
    <tr>
      <th>40</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-12.885249</td>
      <td>-1.291913</td>
      <td>16</td>
    </tr>
    <tr>
      <th>41</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-13.196037</td>
      <td>-0.310788</td>
      <td>17</td>
    </tr>
    <tr>
      <th>42</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-17.778309</td>
      <td>-4.582271</td>
      <td>18</td>
    </tr>
    <tr>
      <th>43</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-17.778309</td>
      <td>-4.582271</td>
      <td>18</td>
    </tr>
    <tr>
      <th>44</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-3.158614</td>
      <td>-2.499297</td>
      <td>3</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-6.096073</td>
      <td>-2.937459</td>
      <td>4</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-12.314001</td>
      <td>-1.261957</td>
      <td>7</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-12.924459</td>
      <td>-0.610458</td>
      <td>8</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-22.135664</td>
      <td>-5.583134</td>
      <td>11</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-23.318302</td>
      <td>-1.182637</td>
      <td>12</td>
    </tr>
    <tr>
      <th>50</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-22.355883</td>
      <td>-0.019306</td>
      <td>15</td>
    </tr>
    <tr>
      <th>51</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-24.087723</td>
      <td>-1.731839</td>
      <td>16</td>
    </tr>
    <tr>
      <th>52</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-28.506302</td>
      <td>-1.929650</td>
      <td>18</td>
    </tr>
    <tr>
      <th>53</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-33.566399</td>
      <td>-5.060096</td>
      <td>19</td>
    </tr>
    <tr>
      <th>54</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-33.566399</td>
      <td>-5.060096</td>
      <td>19</td>
    </tr>
    <tr>
      <th>55</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-0.159753</td>
      <td>-0.379976</td>
      <td>3</td>
    </tr>
    <tr>
      <th>56</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-1.982470</td>
      <td>-1.822717</td>
      <td>4</td>
    </tr>
    <tr>
      <th>57</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-7.354927</td>
      <td>-0.900265</td>
      <td>7</td>
    </tr>
    <tr>
      <th>58</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-8.911375</td>
      <td>-1.556448</td>
      <td>8</td>
    </tr>
    <tr>
      <th>59</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-13.275818</td>
      <td>-3.546825</td>
      <td>11</td>
    </tr>
    <tr>
      <th>60</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-13.842143</td>
      <td>-0.566325</td>
      <td>12</td>
    </tr>
    <tr>
      <th>61</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-19.595833</td>
      <td>-0.540278</td>
      <td>15</td>
    </tr>
    <tr>
      <th>62</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-20.216309</td>
      <td>-0.620476</td>
      <td>16</td>
    </tr>
    <tr>
      <th>63</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-27.911470</td>
      <td>-0.533796</td>
      <td>19</td>
    </tr>
    <tr>
      <th>64</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-31.809921</td>
      <td>-3.898450</td>
      <td>20</td>
    </tr>
    <tr>
      <th>65</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-31.809921</td>
      <td>-3.898450</td>
      <td>20</td>
    </tr>
    <tr>
      <th>66</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-6.707186</td>
      <td>-1.964957</td>
      <td>3</td>
    </tr>
    <tr>
      <th>67</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-9.224418</td>
      <td>-2.517231</td>
      <td>4</td>
    </tr>
    <tr>
      <th>68</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-16.128902</td>
      <td>-3.457415</td>
      <td>7</td>
    </tr>
    <tr>
      <th>69</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-17.681189</td>
      <td>-1.552286</td>
      <td>8</td>
    </tr>
    <tr>
      <th>70</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-24.055399</td>
      <td>-0.329856</td>
      <td>11</td>
    </tr>
    <tr>
      <th>71</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-27.891127</td>
      <td>-3.835727</td>
      <td>12</td>
    </tr>
    <tr>
      <th>72</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-29.804609</td>
      <td>0.148543</td>
      <td>15</td>
    </tr>
    <tr>
      <th>73</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-30.269485</td>
      <td>-0.464876</td>
      <td>16</td>
    </tr>
    <tr>
      <th>74</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-29.941313</td>
      <td>0.100072</td>
      <td>18</td>
    </tr>
    <tr>
      <th>75</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-32.390968</td>
      <td>-2.449654</td>
      <td>19</td>
    </tr>
    <tr>
      <th>76</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-32.390968</td>
      <td>-2.449654</td>
      <td>19</td>
    </tr>
    <tr>
      <th>77</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-2.088791</td>
      <td>-1.641573</td>
      <td>3</td>
    </tr>
    <tr>
      <th>78</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-2.522034</td>
      <td>-0.433243</td>
      <td>4</td>
    </tr>
    <tr>
      <th>79</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-8.567922</td>
      <td>-0.749785</td>
      <td>7</td>
    </tr>
    <tr>
      <th>80</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-11.171768</td>
      <td>-2.603847</td>
      <td>8</td>
    </tr>
    <tr>
      <th>81</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-16.324415</td>
      <td>-2.035160</td>
      <td>11</td>
    </tr>
    <tr>
      <th>82</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-16.831976</td>
      <td>-0.507560</td>
      <td>12</td>
    </tr>
    <tr>
      <th>83</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-21.533304</td>
      <td>-1.221722</td>
      <td>15</td>
    </tr>
    <tr>
      <th>84</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-24.614176</td>
      <td>-3.080871</td>
      <td>16</td>
    </tr>
    <tr>
      <th>85</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-30.253746</td>
      <td>-2.513954</td>
      <td>19</td>
    </tr>
    <tr>
      <th>86</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-32.789143</td>
      <td>-2.535396</td>
      <td>20</td>
    </tr>
    <tr>
      <th>87</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-32.789143</td>
      <td>-2.535396</td>
      <td>20</td>
    </tr>
    <tr>
      <th>88</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-36.264389</td>
      <td>-3.475247</td>
      <td>21</td>
    </tr>
    <tr>
      <th>89</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-36.264389</td>
      <td>-3.475247</td>
      <td>21</td>
    </tr>
    <tr>
      <th>90</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>9</td>
      <td>-3.330243</td>
      <td>-2.287215</td>
      <td>3</td>
    </tr>
    <tr>
      <th>91</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>9</td>
      <td>-4.007404</td>
      <td>-0.677161</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FirstLastTfm" class="doc_header"><code>class</code> <code>FirstLastTfm</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L158" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FirstLastTfm</code>(<strong><code>gamma</code></strong>) :: <code>Transform</code></p>
</blockquote>
<p>Delegates (<code>__call__</code>,<code>decode</code>,<code>setup</code>) to (<code>encodes</code>,<code>decodes</code>,<code>setups</code>) if <code>split_idx</code> matches</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>gamma</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FirstLast" class="doc_header"><code>class</code> <code>FirstLast</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L182" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FirstLast</code>(<strong><code>gamma</code></strong>=<em><code>0.99</code></em>) :: <a href="/fastrl/callback.core.html#LoopCallback"><code>LoopCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>gamma</code></strong> : <em><code>&lt;class 'float'&gt;</code></em>, <em>optional</em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> - after_create   : [GymLoop]
Start Setup
   - initialize     : [GymLoop]
End Setup
 - before_episodes: [GymLoop]
Start Episodes
   - reset          : [GymLoop]
   - do_action      : []
   - do_step        : [GymLoop]
   - do_render      : []
   - before_history : [GymLoop]
   - history        : [GymLoop]
   - after_history  : [GymLoop]
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>25.0</td>
      <td>1.0</td>
      <td>25</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>3</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>3</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>3</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>3</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>50 rows × 11 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)[[</span><span class="s1">&#39;state_mu&#39;</span><span class="p">,</span><span class="s1">&#39;next_state_mu&#39;</span><span class="p">,</span><span class="s1">&#39;done&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state_mu</th>
      <th>next_state_mu</th>
      <th>done</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.024080</td>
      <td>0.034778</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.003216</td>
      <td>0.061233</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.018060</td>
      <td>0.039545</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.008488</td>
      <td>0.066663</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.034778</td>
      <td>0.094412</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.061233</td>
      <td>0.123230</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.039545</td>
      <td>0.104977</td>
      <td>False</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.066663</td>
      <td>0.136268</td>
      <td>False</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.094412</td>
      <td>0.169110</td>
      <td>False</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.123230</td>
      <td>0.155996</td>
      <td>False</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.104977</td>
      <td>0.144796</td>
      <td>False</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.136268</td>
      <td>0.182131</td>
      <td>False</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.169110</td>
      <td>0.221171</td>
      <td>False</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.155996</td>
      <td>0.262302</td>
      <td>True</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.144796</td>
      <td>0.262302</td>
      <td>True</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.182131</td>
      <td>0.262302</td>
      <td>True</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.221171</td>
      <td>0.262302</td>
      <td>True</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.001680</td>
      <td>0.002614</td>
      <td>False</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.026068</td>
      <td>-0.021725</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.002173</td>
      <td>0.002240</td>
      <td>False</td>
    </tr>
    <tr>
      <th>20</th>
      <td>-0.021761</td>
      <td>0.026263</td>
      <td>False</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0.002614</td>
      <td>0.050777</td>
      <td>False</td>
    </tr>
    <tr>
      <th>22</th>
      <td>-0.021725</td>
      <td>0.076221</td>
      <td>False</td>
    </tr>
    <tr>
      <th>23</th>
      <td>0.002240</td>
      <td>0.103034</td>
      <td>False</td>
    </tr>
    <tr>
      <th>24</th>
      <td>0.026263</td>
      <td>0.082931</td>
      <td>False</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0.050777</td>
      <td>0.112801</td>
      <td>False</td>
    </tr>
    <tr>
      <th>26</th>
      <td>0.076221</td>
      <td>0.144488</td>
      <td>False</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0.103034</td>
      <td>0.178404</td>
      <td>False</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0.082931</td>
      <td>0.214931</td>
      <td>False</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0.112801</td>
      <td>0.254412</td>
      <td>False</td>
    </tr>
    <tr>
      <th>30</th>
      <td>0.144488</td>
      <td>0.297135</td>
      <td>True</td>
    </tr>
    <tr>
      <th>31</th>
      <td>0.178404</td>
      <td>0.297135</td>
      <td>True</td>
    </tr>
    <tr>
      <th>32</th>
      <td>0.214931</td>
      <td>0.297135</td>
      <td>True</td>
    </tr>
    <tr>
      <th>33</th>
      <td>0.254412</td>
      <td>0.297135</td>
      <td>True</td>
    </tr>
    <tr>
      <th>34</th>
      <td>-0.007063</td>
      <td>0.040848</td>
      <td>False</td>
    </tr>
    <tr>
      <th>35</th>
      <td>-0.031423</td>
      <td>0.066159</td>
      <td>False</td>
    </tr>
    <tr>
      <th>36</th>
      <td>-0.007507</td>
      <td>0.044042</td>
      <td>False</td>
    </tr>
    <tr>
      <th>37</th>
      <td>0.016439</td>
      <td>0.022785</td>
      <td>False</td>
    </tr>
    <tr>
      <th>38</th>
      <td>0.040848</td>
      <td>0.001981</td>
      <td>False</td>
    </tr>
    <tr>
      <th>39</th>
      <td>0.066159</td>
      <td>0.029823</td>
      <td>False</td>
    </tr>
    <tr>
      <th>40</th>
      <td>0.044042</td>
      <td>0.009629</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41</th>
      <td>0.022785</td>
      <td>0.038085</td>
      <td>False</td>
    </tr>
    <tr>
      <th>42</th>
      <td>0.001981</td>
      <td>0.018613</td>
      <td>False</td>
    </tr>
    <tr>
      <th>43</th>
      <td>0.029823</td>
      <td>0.047787</td>
      <td>False</td>
    </tr>
    <tr>
      <th>44</th>
      <td>0.009629</td>
      <td>0.029169</td>
      <td>False</td>
    </tr>
    <tr>
      <th>45</th>
      <td>0.038085</td>
      <td>0.010782</td>
      <td>False</td>
    </tr>
    <tr>
      <th>46</th>
      <td>0.018613</td>
      <td>0.040575</td>
      <td>False</td>
    </tr>
    <tr>
      <th>47</th>
      <td>0.047787</td>
      <td>0.070747</td>
      <td>False</td>
    </tr>
    <tr>
      <th>48</th>
      <td>0.029169</td>
      <td>0.053360</td>
      <td>False</td>
    </tr>
    <tr>
      <th>49</th>
      <td>0.010782</td>
      <td>0.084625</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/fastrl_user/.local/lib/python3.8/site-packages/gym/spaces/box.py:73: UserWarning: <span class="ansi-yellow-fg">WARN: Box bound precision lowered by casting to float32</span>
  logger.warn(
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
WalkerBase::__init__
WalkerBase::__init__
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>0.627942</td>
      <td>0.053319</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-2.044724</td>
      <td>-0.343039</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-6.386141</td>
      <td>-1.326247</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-8.822930</td>
      <td>-1.585965</td>
      <td>12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-11.430076</td>
      <td>-1.162164</td>
      <td>15</td>
    </tr>
    <tr>
      <th>5</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-17.712601</td>
      <td>-2.343799</td>
      <td>18</td>
    </tr>
    <tr>
      <th>6</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-25.301302</td>
      <td>-5.203572</td>
      <td>21</td>
    </tr>
    <tr>
      <th>7</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-2.818031</td>
      <td>-2.344539</td>
      <td>3</td>
    </tr>
    <tr>
      <th>8</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-5.589420</td>
      <td>-1.166740</td>
      <td>6</td>
    </tr>
    <tr>
      <th>9</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-13.026930</td>
      <td>-2.650364</td>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-14.556358</td>
      <td>-0.256437</td>
      <td>12</td>
    </tr>
    <tr>
      <th>11</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-20.520952</td>
      <td>-1.908656</td>
      <td>15</td>
    </tr>
    <tr>
      <th>12</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-25.628269</td>
      <td>-3.556746</td>
      <td>18</td>
    </tr>
    <tr>
      <th>13</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-38.924137</td>
      <td>-7.137619</td>
      <td>20</td>
    </tr>
    <tr>
      <th>14</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-4.839755</td>
      <td>-0.498671</td>
      <td>3</td>
    </tr>
    <tr>
      <th>15</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-10.471047</td>
      <td>-2.678038</td>
      <td>6</td>
    </tr>
    <tr>
      <th>16</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-13.226857</td>
      <td>-0.952194</td>
      <td>9</td>
    </tr>
    <tr>
      <th>17</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-17.740213</td>
      <td>-0.277891</td>
      <td>12</td>
    </tr>
    <tr>
      <th>18</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-22.916409</td>
      <td>-2.664318</td>
      <td>15</td>
    </tr>
    <tr>
      <th>19</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-25.639233</td>
      <td>-2.748614</td>
      <td>18</td>
    </tr>
    <tr>
      <th>20</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-1.182601</td>
      <td>-0.538640</td>
      <td>3</td>
    </tr>
    <tr>
      <th>21</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-4.418980</td>
      <td>-1.805466</td>
      <td>6</td>
    </tr>
    <tr>
      <th>22</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-7.462476</td>
      <td>0.173768</td>
      <td>9</td>
    </tr>
    <tr>
      <th>23</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-16.680456</td>
      <td>-1.426940</td>
      <td>12</td>
    </tr>
    <tr>
      <th>24</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-19.517315</td>
      <td>-0.286435</td>
      <td>15</td>
    </tr>
    <tr>
      <th>25</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-23.565435</td>
      <td>-2.838801</td>
      <td>18</td>
    </tr>
    <tr>
      <th>26</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-26.995213</td>
      <td>-3.429778</td>
      <td>19</td>
    </tr>
    <tr>
      <th>27</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-0.574649</td>
      <td>-0.815623</td>
      <td>3</td>
    </tr>
    <tr>
      <th>28</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-5.339489</td>
      <td>-0.142941</td>
      <td>6</td>
    </tr>
    <tr>
      <th>29</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-8.914589</td>
      <td>-0.928924</td>
      <td>9</td>
    </tr>
    <tr>
      <th>30</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-22.825569</td>
      <td>-3.190552</td>
      <td>12</td>
    </tr>
    <tr>
      <th>31</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-25.533512</td>
      <td>-0.471949</td>
      <td>15</td>
    </tr>
    <tr>
      <th>32</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-30.185755</td>
      <td>-2.369906</td>
      <td>18</td>
    </tr>
    <tr>
      <th>33</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-35.181675</td>
      <td>-4.995920</td>
      <td>19</td>
    </tr>
    <tr>
      <th>34</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-6.534710</td>
      <td>-2.288828</td>
      <td>3</td>
    </tr>
    <tr>
      <th>35</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-9.131213</td>
      <td>-0.108752</td>
      <td>6</td>
    </tr>
    <tr>
      <th>36</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-15.813971</td>
      <td>-3.278288</td>
      <td>9</td>
    </tr>
    <tr>
      <th>37</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-21.706867</td>
      <td>-2.918025</td>
      <td>12</td>
    </tr>
    <tr>
      <th>38</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-33.566479</td>
      <td>-4.676465</td>
      <td>15</td>
    </tr>
    <tr>
      <th>39</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-41.491394</td>
      <td>-2.998694</td>
      <td>18</td>
    </tr>
    <tr>
      <th>40</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-52.095028</td>
      <td>-4.963990</td>
      <td>21</td>
    </tr>
    <tr>
      <th>41</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-57.819080</td>
      <td>-5.724052</td>
      <td>22</td>
    </tr>
    <tr>
      <th>42</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-4.915798</td>
      <td>-1.184088</td>
      <td>3</td>
    </tr>
    <tr>
      <th>43</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-7.486410</td>
      <td>-0.738479</td>
      <td>6</td>
    </tr>
    <tr>
      <th>44</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-9.883441</td>
      <td>-0.346748</td>
      <td>9</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-18.673069</td>
      <td>-4.369957</td>
      <td>12</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-22.758854</td>
      <td>-2.106847</td>
      <td>15</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-29.514284</td>
      <td>-1.886796</td>
      <td>18</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-39.228722</td>
      <td>-4.715789</td>
      <td>21</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-0.495330</td>
      <td>-0.441521</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="show_source" class="doc_header"><code>show_source</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L195" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>show_source</code>(<strong><code>src</code></strong>, <strong><code>iters</code></strong>=<em><code>50</code></em>)</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>src</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>iters</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rgb_array&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">show_source</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rgb_array&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">show_source</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ResReduce" class="doc_header"><code>class</code> <code>ResReduce</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L207" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ResReduce</code>(<strong><code>reduce_by</code></strong>=<em><code>2</code></em>) :: <a href="/fastrl/callback.core.html#LoopCallback"><code>LoopCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>reduce_by</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em>  <p>The amount to reduce the `image` resolution by e.g.: 400x400 -> 200x200 if default is used.</p></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rgb_array&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">ResReduce</span><span class="p">(</span><span class="n">reduce_by</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>
<span class="p">)</span>
<span class="n">show_source</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAACGCAIAAAAXaFLVAAAB2ElEQVR4nO3c0UnDYBSAUSNupDOlM7VzdAydo2PEh2KRaG0KfobIOU8l6cNP+LjcQugwTdMD/LbHtQ/A/yQsEsIiISwSwiIhLBLCIiEsEsIiISwSwiIhLBLCIiEsEsIiISwSwiIhLBLCIiEsEsIiISwSwiIhLBLCIiEsEsIiISwSwiIhLBLCIiEsEsIiISwSwiIhLBLCIiEsEsIiISwSwiIhLBLCIiEsEsIiISwSwiIhLBLCIiEsEsIiISwSwiIhLBLCIiEsEsIi8bT2ATbj7bC7fH4e9yueZBNMLBLCIiEsEsIiISwSwrqbn4RLCIuEsEgIi4SwSAiLhLBICIuEsEgIi4SwSAiLhLAW+fz6KEsIi4SwSAiLhLBICIuEsEgI6z7eS15IWCSERUJYJIRFQlgkhEVCWCSERUJYJIRFQlgk/Lnt3DAMsyuv+/GHu9M05WfaIBNrkeNpPJ7G29/jg7BuuySlreWERWKwIsx83aLOzpvWy+4wu+4Bwt8xseauTaxrPMBv2bFICIuEsEjYsUiYWCSERUJYJIRFQlgkhEVCWCSERUJYJIRFQlgkhEVCWCSERUJYJIRFQlgkhEVCWCSERUJYJIRFQlgkhEVCWCSERUJYJIRF4h3YBCoDFyclOQAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Metrics">Metrics<a class="anchor-link" href="#Metrics"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Reward" class="doc_header"><code>class</code> <code>Reward</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L226" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Reward</code>() :: <code>Metric</code></p>
</blockquote>
<p>Blueprint for defining a metric</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NEpisodes" class="doc_header"><code>class</code> <code>NEpisodes</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L245" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NEpisodes</code>() :: <code>Metric</code></p>
</blockquote>
<p>Blueprint for defining a metric</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fake_gym_learner" class="doc_header"><code>fake_gym_learner</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L263" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fake_gym_learner</code>(<strong><code>source</code></strong>, <strong><code>n</code></strong>=<em><code>1000</code></em>, <strong><code>bs</code></strong>=<em><code>1</code></em>, <strong><code>num_workers</code></strong>=<em><code>0</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>source</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>n</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>bs</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>num_workers</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>kwargs</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">],</span><span class="n">persistent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">learn</span><span class="o">=</span><span class="n">fake_gym_learner</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Could not do one pass in your dataloader, there is something wrong in it
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>train_reward</th>
      <th>train_n_episodes</th>
      <th>valid_loss</th>
      <th>valid_reward</th>
      <th>valid_n_episodes</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.000000</td>
      <td>20.204082</td>
      <td>49</td>
      <td>00:03</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.000000</td>
      <td>23.317647</td>
      <td>85</td>
      <td>00:03</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.000000</td>
      <td>23.930000</td>
      <td>131</td>
      <td>00:03</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.000000</td>
      <td>22.720000</td>
      <td>175</td>
      <td>00:03</td>
    </tr>
  </tbody>
</table>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>argv[0]=
argv[0]=
argv[0]=
argv[0]=
argv[0]=
argv[0]=
argv[0]=
argv[0]=
argv[0]=
argv[0]=
argv[0]=
argv[0]=
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">cbs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">cbs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">action_executions</span><span class="p">,</span><span class="mi">4000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Export">Export<a class="anchor-link" href="#Export"> </a></h2>
</div>
</div>
</div>
</div>
 

