---

title: Data Block Gym


keywords: fastai
sidebar: home_sidebar

summary: "openai gym sources"
description: "openai gym sources"
nb_path: "nbs/05c_data.gym.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/05c_data.gym.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="GymSource">GymSource<a class="anchor-link" href="#GymSource"> </a></h2><blockquote><p>The base iterable used for iterating through environments.</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_loop</span><span class="o">=</span><span class="n">L</span><span class="p">([</span><span class="s1">&#39;event.after_create&#39;</span><span class="p">,</span><span class="s1">&#39;Start Setup&#39;</span><span class="p">,</span><span class="s1">&#39;event.initialize&#39;</span><span class="p">,</span><span class="s1">&#39;End Setup&#39;</span><span class="p">,</span>
             <span class="s1">&#39;event.before_episodes&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Start Episodes&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.reset&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.do_action&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.do_step&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.do_render&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.before_history&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.history&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;event.after_history&#39;</span><span class="p">,</span>
             <span class="s1">&#39;End Episodes&#39;</span><span class="p">,</span>
             <span class="s1">&#39;event.after_episodes&#39;</span>
             <span class="p">])</span>

<span class="n">mk_class</span><span class="p">(</span><span class="s1">&#39;source_events&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">parse_events</span><span class="p">(</span><span class="n">_loop</span><span class="p">)</span><span class="o">.</span><span class="n">map_dict</span><span class="p">(),</span>
         <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;All possible events as attributes to get tab-completion and typo-proofing&quot;</span><span class="p">)</span>

<span class="n">_all_</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;source_events&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="return_data" class="doc_header"><code>return_data</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L52" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>return_data</code>(<strong><code>o</code></strong>:<code>dict</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Source" class="doc_header"><code>class</code> <code>Source</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block_simple.py#L53" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Source</code>(<strong><code>cbs</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/callback.core.html#Loop"><code>Loop</code></a></p>
</blockquote>
<p>Inherit from this to have all attr accesses in <code>self._xtra</code> passed down to <code>self.default</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">return_data</span><span class="p">(</span><span class="n">o</span><span class="p">:</span><span class="nb">dict</span><span class="p">):</span> 
    <span class="n">source</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">o</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">],</span><span class="n">o</span><span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;source&#39;</span><span class="p">:</span><span class="n">source</span><span class="p">,</span><span class="s1">&#39;history&#39;</span><span class="p">:</span><span class="n">data</span><span class="p">}</span>

<span class="k">class</span> <span class="nc">Source</span><span class="p">(</span><span class="n">Loop</span><span class="p">):</span>
    <span class="n">_loop</span><span class="o">=</span><span class="n">_loop</span>
    <span class="n">_events</span><span class="o">=</span><span class="n">source_events</span>
    <span class="n">_default</span><span class="o">=</span><span class="s1">&#39;source&#39;</span>    
    <span class="n">end_event</span><span class="o">=</span><span class="n">parse_events</span><span class="p">(</span><span class="n">_loop</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="nd">@delegates</span><span class="p">(</span><span class="n">Loop</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">test_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_fields</span><span class="o">=</span><span class="s1">&#39;state,next_state,done,all_done,env_id,worker_id&#39;</span>\
                           <span class="s1">&#39;,action,episode_id,accum_rewards,reward,step&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_fields</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_field</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">return_fn</span><span class="o">=</span><span class="n">return_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loop_history_yield</span><span class="o">=</span><span class="kc">False</span>
        <span class="n">store_attr</span><span class="p">(</span><span class="n">but</span><span class="o">=</span><span class="s1">&#39;cbs&#39;</span><span class="p">,</span><span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">next_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">done</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">all_done</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">env_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">action</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">episode_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">accum_rewards</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">reward</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                   <span class="n">skip_history_return</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cbs</span><span class="o">=</span><span class="n">cbs</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">after_create</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;initialize&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>
    
    <span class="k">def</span> <span class="nf">_history</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loop_history_yield</span><span class="o">=</span><span class="kc">False</span>
        <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;history&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_mode</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">this</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;test_field&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fields</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;test_field&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_fn</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">history</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">()))[</span><span class="s1">&#39;history&#39;</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">BD</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">BD</span><span class="p">({</span><span class="n">s</span><span class="p">:(</span><span class="n">ifnone</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span><span class="n">TensorBatch</span><span class="p">([[</span><span class="mi">0</span><span class="p">]]))</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_mode</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">s</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_fields</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">in_</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ignore_fields</span><span class="p">)})</span>
        
    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;before_episodes&#39;</span><span class="p">)</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="o">+=</span><span class="mi">1</span>
            <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;reset&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;do_action&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;do_step&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_mode</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_field</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;do_render&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;before_history&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_history_return</span><span class="p">:</span> <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">_history</span><span class="p">()</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">loop_history_yield</span><span class="p">:</span>   <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">_history</span><span class="p">()</span>
            <span class="bp">self</span><span class="p">(</span><span class="s1">&#39;after_history&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So the <a href="/fastrl/data.gym.html#Source"><code>Source</code></a> object does a simple loop that returns a dictionary. 
This is going to be similar to what the rest of fastrl will be expecting.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span><span class="n">test_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)):</span> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[1, 1, 1, 1, 1]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[2, 2, 2, 2, 2]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[3, 3, 3, 3, 3]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[4, 4, 4, 4, 4]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[5, 5, 5, 5, 5]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[6, 6, 6, 6, 6]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[7, 7, 7, 7, 7]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[8, 8, 8, 8, 8]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[9, 9, 9, 9, 9]])}
{&#39;state&#39;: TensorBatch([[0]]), &#39;next_state&#39;: TensorBatch([[0]]), &#39;done&#39;: TensorBatch([[0]]), &#39;all_done&#39;: TensorBatch([[0]]), &#39;env_id&#39;: 0, &#39;worker_id&#39;: TensorBatch([[0]]), &#39;action&#39;: TensorBatch([[0]]), &#39;episode_id&#39;: 0, &#39;accum_rewards&#39;: 0, &#39;reward&#39;: 0, &#39;step&#39;: 0, &#39;test_field&#39;: tensor([[10, 10, 10, 10, 10]])}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Source</span><span class="p">()</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> - after_create   : []
Start Setup
   - initialize     : []
End Setup
 - before_episodes: []
Start Episodes
   - reset          : []
   - do_action      : []
   - do_step        : []
   - do_render      : []
   - before_history : []
   - history        : []
   - after_history  : []
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ReturnHistory" class="doc_header"><code>class</code> <code>ReturnHistory</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L108" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ReturnHistory</code>(<strong><code>enc</code></strong>=<em><code>None</code></em>, <strong><code>dec</code></strong>=<em><code>None</code></em>, <strong><code>split_idx</code></strong>=<em><code>None</code></em>, <strong><code>order</code></strong>=<em><code>None</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>Delegates (<code>__call__</code>,<code>decode</code>,<code>setup</code>) to (<code>encodes</code>,<code>decodes</code>,<code>setups</code>) if <code>split_idx</code> matches</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">LoopCallback</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>fastrl.callback.core.LoopCallback</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TstCallback" class="doc_header"><code>class</code> <code>TstCallback</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L119" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TstCallback</code>(<strong><code>action_space</code></strong>=<em><code>None</code></em>, <strong><code>constant</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/agent.html#AgentCallback"><code>AgentCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="np_type_cast" class="doc_header"><code>np_type_cast</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L128" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>np_type_cast</code>(<strong><code>a</code></strong>, <strong><code>dtype</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GymLoop" class="doc_header"><code>class</code> <code>GymLoop</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L130" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GymLoop</code>(<strong><code>env_name</code></strong>:<code>str</code>, <strong><code>agent</code></strong>=<em><code>None</code></em>, <strong><code>mode</code></strong>=<em><code>None</code></em>, <strong><code>steps_count</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>steps_delta</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>seed</code></strong>:<code>int</code>=<em><code>None</code></em>, <strong><code>worker_id</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>dtype</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/callback.core.html#LoopCallback"><code>LoopCallback</code></a></p>
</blockquote>
<p>Handles iterating through single openai gym (and varients).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/fastrl_user/.local/lib/python3.8/site-packages/gym/logger.py:30: UserWarning: <span class="ansi-yellow-fg">WARN: Box bound precision lowered by casting to float32</span>
  warnings.warn(colorize(&#39;%s: %s&#39;%(&#39;WARN&#39;, msg % args), &#39;yellow&#39;))
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> - after_create   : [GymLoop]
Start Setup
   - initialize     : [GymLoop]
End Setup
 - before_episodes: [GymLoop]
Start Episodes
   - reset          : [GymLoop]
   - do_action      : []
   - do_step        : [GymLoop]
   - do_render      : []
   - before_history : [GymLoop]
   - history        : [GymLoop]
   - after_history  : []
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
WalkerBase::__init__
argv[0]=
argv[0]=
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-0.534263</td>
      <td>-0.656729</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-6.708178</td>
      <td>-6.173915</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-14.813457</td>
      <td>-2.442479</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-16.260263</td>
      <td>-1.446807</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-17.954454</td>
      <td>0.363357</td>
      <td>11</td>
    </tr>
    <tr>
      <th>5</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-18.154480</td>
      <td>-0.200026</td>
      <td>12</td>
    </tr>
    <tr>
      <th>6</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-24.507427</td>
      <td>-2.606827</td>
      <td>15</td>
    </tr>
    <tr>
      <th>7</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-28.268850</td>
      <td>-3.761423</td>
      <td>16</td>
    </tr>
    <tr>
      <th>8</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-35.040119</td>
      <td>-1.404458</td>
      <td>19</td>
    </tr>
    <tr>
      <th>9</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-34.759171</td>
      <td>0.280948</td>
      <td>20</td>
    </tr>
    <tr>
      <th>10</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-34.622311</td>
      <td>0.136858</td>
      <td>21</td>
    </tr>
    <tr>
      <th>11</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-39.680630</td>
      <td>-5.058320</td>
      <td>22</td>
    </tr>
    <tr>
      <th>12</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-39.680630</td>
      <td>-5.058320</td>
      <td>22</td>
    </tr>
    <tr>
      <th>13</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-1.826763</td>
      <td>-1.185882</td>
      <td>3</td>
    </tr>
    <tr>
      <th>14</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-1.834462</td>
      <td>-0.007700</td>
      <td>4</td>
    </tr>
    <tr>
      <th>15</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-3.347557</td>
      <td>-0.107164</td>
      <td>7</td>
    </tr>
    <tr>
      <th>16</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-3.671887</td>
      <td>-0.324331</td>
      <td>8</td>
    </tr>
    <tr>
      <th>17</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-7.615092</td>
      <td>-0.759765</td>
      <td>11</td>
    </tr>
    <tr>
      <th>18</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-8.781977</td>
      <td>-1.166885</td>
      <td>12</td>
    </tr>
    <tr>
      <th>19</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-14.629818</td>
      <td>-1.429361</td>
      <td>15</td>
    </tr>
    <tr>
      <th>20</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-15.156466</td>
      <td>-0.526648</td>
      <td>16</td>
    </tr>
    <tr>
      <th>21</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-16.500965</td>
      <td>-0.750149</td>
      <td>18</td>
    </tr>
    <tr>
      <th>22</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-19.956367</td>
      <td>-3.455401</td>
      <td>19</td>
    </tr>
    <tr>
      <th>23</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-19.956367</td>
      <td>-3.455401</td>
      <td>19</td>
    </tr>
    <tr>
      <th>24</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-3.221883</td>
      <td>-1.453121</td>
      <td>3</td>
    </tr>
    <tr>
      <th>25</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-4.128774</td>
      <td>-0.906890</td>
      <td>4</td>
    </tr>
    <tr>
      <th>26</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-9.058023</td>
      <td>-1.346228</td>
      <td>7</td>
    </tr>
    <tr>
      <th>27</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-11.554961</td>
      <td>-2.496938</td>
      <td>8</td>
    </tr>
    <tr>
      <th>28</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-19.834307</td>
      <td>-2.079082</td>
      <td>11</td>
    </tr>
    <tr>
      <th>29</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-22.484304</td>
      <td>-2.649997</td>
      <td>12</td>
    </tr>
    <tr>
      <th>30</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-27.749235</td>
      <td>-1.724790</td>
      <td>15</td>
    </tr>
    <tr>
      <th>31</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-27.260014</td>
      <td>0.489221</td>
      <td>16</td>
    </tr>
    <tr>
      <th>32</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-32.418419</td>
      <td>-2.889942</td>
      <td>18</td>
    </tr>
    <tr>
      <th>33</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-36.542767</td>
      <td>-4.124349</td>
      <td>19</td>
    </tr>
    <tr>
      <th>34</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-36.542767</td>
      <td>-4.124349</td>
      <td>19</td>
    </tr>
    <tr>
      <th>35</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-3.453347</td>
      <td>-1.805649</td>
      <td>3</td>
    </tr>
    <tr>
      <th>36</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-3.930880</td>
      <td>-0.477533</td>
      <td>4</td>
    </tr>
    <tr>
      <th>37</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-8.870763</td>
      <td>-1.989123</td>
      <td>7</td>
    </tr>
    <tr>
      <th>38</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-9.578520</td>
      <td>-0.707757</td>
      <td>8</td>
    </tr>
    <tr>
      <th>39</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-18.277700</td>
      <td>-3.041107</td>
      <td>11</td>
    </tr>
    <tr>
      <th>40</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-20.917925</td>
      <td>-2.640225</td>
      <td>12</td>
    </tr>
    <tr>
      <th>41</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-27.218409</td>
      <td>-1.406703</td>
      <td>15</td>
    </tr>
    <tr>
      <th>42</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-29.117409</td>
      <td>-1.899000</td>
      <td>16</td>
    </tr>
    <tr>
      <th>43</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-30.710583</td>
      <td>-1.593174</td>
      <td>17</td>
    </tr>
    <tr>
      <th>44</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-36.178482</td>
      <td>-5.467901</td>
      <td>18</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-36.178482</td>
      <td>-5.467901</td>
      <td>18</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-4.025253</td>
      <td>-1.856786</td>
      <td>3</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-9.132345</td>
      <td>-5.107092</td>
      <td>4</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-13.398110</td>
      <td>-0.852938</td>
      <td>7</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-15.588814</td>
      <td>-2.190703</td>
      <td>8</td>
    </tr>
    <tr>
      <th>50</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-19.874060</td>
      <td>-1.780863</td>
      <td>11</td>
    </tr>
    <tr>
      <th>51</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-24.795683</td>
      <td>-4.921623</td>
      <td>12</td>
    </tr>
    <tr>
      <th>52</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-30.508179</td>
      <td>-0.619533</td>
      <td>15</td>
    </tr>
    <tr>
      <th>53</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-32.195290</td>
      <td>-1.687111</td>
      <td>16</td>
    </tr>
    <tr>
      <th>54</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-39.041672</td>
      <td>-1.109635</td>
      <td>19</td>
    </tr>
    <tr>
      <th>55</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-45.737011</td>
      <td>-6.695338</td>
      <td>20</td>
    </tr>
    <tr>
      <th>56</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-45.737011</td>
      <td>-6.695338</td>
      <td>20</td>
    </tr>
    <tr>
      <th>57</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>1.041893</td>
      <td>-0.415902</td>
      <td>3</td>
    </tr>
    <tr>
      <th>58</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>0.678681</td>
      <td>-0.363212</td>
      <td>4</td>
    </tr>
    <tr>
      <th>59</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-4.435575</td>
      <td>-3.165344</td>
      <td>7</td>
    </tr>
    <tr>
      <th>60</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-7.082162</td>
      <td>-2.646587</td>
      <td>8</td>
    </tr>
    <tr>
      <th>61</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-10.471999</td>
      <td>-1.192301</td>
      <td>11</td>
    </tr>
    <tr>
      <th>62</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-12.517709</td>
      <td>-2.045710</td>
      <td>12</td>
    </tr>
    <tr>
      <th>63</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-16.702414</td>
      <td>-1.125458</td>
      <td>15</td>
    </tr>
    <tr>
      <th>64</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-18.318899</td>
      <td>-1.616486</td>
      <td>16</td>
    </tr>
    <tr>
      <th>65</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-19.743927</td>
      <td>-1.425028</td>
      <td>17</td>
    </tr>
    <tr>
      <th>66</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-23.420918</td>
      <td>-3.676990</td>
      <td>18</td>
    </tr>
    <tr>
      <th>67</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-23.420918</td>
      <td>-3.676990</td>
      <td>18</td>
    </tr>
    <tr>
      <th>68</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>0.126660</td>
      <td>-0.772628</td>
      <td>3</td>
    </tr>
    <tr>
      <th>69</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-1.547306</td>
      <td>-1.673965</td>
      <td>4</td>
    </tr>
    <tr>
      <th>70</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-6.075899</td>
      <td>-0.235314</td>
      <td>7</td>
    </tr>
    <tr>
      <th>71</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-7.283608</td>
      <td>-1.207710</td>
      <td>8</td>
    </tr>
    <tr>
      <th>72</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-11.217655</td>
      <td>-1.232258</td>
      <td>11</td>
    </tr>
    <tr>
      <th>73</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-13.122036</td>
      <td>-1.904381</td>
      <td>12</td>
    </tr>
    <tr>
      <th>74</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-19.254879</td>
      <td>-3.064253</td>
      <td>15</td>
    </tr>
    <tr>
      <th>75</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-20.307182</td>
      <td>-1.052303</td>
      <td>16</td>
    </tr>
    <tr>
      <th>76</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-27.948944</td>
      <td>-4.981923</td>
      <td>19</td>
    </tr>
    <tr>
      <th>77</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-29.327879</td>
      <td>-1.378936</td>
      <td>20</td>
    </tr>
    <tr>
      <th>78</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-34.279320</td>
      <td>-0.994861</td>
      <td>23</td>
    </tr>
    <tr>
      <th>79</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-34.192375</td>
      <td>0.086946</td>
      <td>24</td>
    </tr>
    <tr>
      <th>80</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-36.038448</td>
      <td>-1.846075</td>
      <td>25</td>
    </tr>
    <tr>
      <th>81</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-41.803852</td>
      <td>-5.765405</td>
      <td>26</td>
    </tr>
    <tr>
      <th>82</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-41.803852</td>
      <td>-5.765405</td>
      <td>26</td>
    </tr>
    <tr>
      <th>83</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-2.501039</td>
      <td>-1.385941</td>
      <td>3</td>
    </tr>
    <tr>
      <th>84</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-2.543603</td>
      <td>-0.042564</td>
      <td>4</td>
    </tr>
    <tr>
      <th>85</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-8.348289</td>
      <td>-2.158688</td>
      <td>7</td>
    </tr>
    <tr>
      <th>86</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-9.032112</td>
      <td>-0.683822</td>
      <td>8</td>
    </tr>
    <tr>
      <th>87</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-17.389624</td>
      <td>-3.625694</td>
      <td>11</td>
    </tr>
    <tr>
      <th>88</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-18.627491</td>
      <td>-1.237868</td>
      <td>12</td>
    </tr>
    <tr>
      <th>89</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-20.273880</td>
      <td>-0.426151</td>
      <td>15</td>
    </tr>
    <tr>
      <th>90</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-20.183018</td>
      <td>0.090863</td>
      <td>16</td>
    </tr>
    <tr>
      <th>91</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-21.451553</td>
      <td>-0.070178</td>
      <td>19</td>
    </tr>
    <tr>
      <th>92</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-21.936630</td>
      <td>-0.485077</td>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FirstLastTfm" class="doc_header"><code>class</code> <code>FirstLastTfm</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L218" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FirstLastTfm</code>(<strong><code>gamma</code></strong>) :: <code>Transform</code></p>
</blockquote>
<p>Delegates (<code>__call__</code>,<code>decode</code>,<code>setup</code>) to (<code>encodes</code>,<code>decodes</code>,<code>setups</code>) if <code>split_idx</code> matches</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FirstLast" class="doc_header"><code>class</code> <code>FirstLast</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L242" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FirstLast</code>(<strong><code>gamma</code></strong>=<em><code>0.99</code></em>) :: <a href="/fastrl/callback.core.html#LoopCallback"><code>LoopCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> - after_create   : [GymLoop, FirstLast]
Start Setup
   - initialize     : [GymLoop, FirstLast]
End Setup
 - before_episodes: [GymLoop, FirstLast]
Start Episodes
   - reset          : [GymLoop]
   - do_action      : []
   - do_step        : [GymLoop]
   - do_render      : []
   - before_history : [GymLoop]
   - history        : [GymLoop]
   - after_history  : []
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>20.0</td>
      <td>1.0</td>
      <td>20</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>21.0</td>
      <td>1.0</td>
      <td>21</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>22.0</td>
      <td>1.0</td>
      <td>22</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>23.0</td>
      <td>1.0</td>
      <td>23</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>24.0</td>
      <td>1.0</td>
      <td>24</td>
    </tr>
  </tbody>
</table>
<p>50 rows × 11 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>3.940399</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>3.940399</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>3.940399</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>5.0</td>
      <td>3.940399</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>6.0</td>
      <td>3.940399</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>7.0</td>
      <td>3.940399</td>
      <td>7</td>
    </tr>
    <tr>
      <th>7</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>8.0</td>
      <td>3.940399</td>
      <td>8</td>
    </tr>
    <tr>
      <th>8</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>9.0</td>
      <td>3.940399</td>
      <td>9</td>
    </tr>
    <tr>
      <th>9</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>10.0</td>
      <td>3.940399</td>
      <td>10</td>
    </tr>
    <tr>
      <th>10</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>11.0</td>
      <td>3.940399</td>
      <td>11</td>
    </tr>
    <tr>
      <th>11</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>12.0</td>
      <td>3.940399</td>
      <td>12</td>
    </tr>
    <tr>
      <th>12</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>13.0</td>
      <td>3.940399</td>
      <td>13</td>
    </tr>
    <tr>
      <th>13</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>14.0</td>
      <td>3.940399</td>
      <td>14</td>
    </tr>
    <tr>
      <th>14</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>15.0</td>
      <td>3.940399</td>
      <td>15</td>
    </tr>
    <tr>
      <th>15</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>16.0</td>
      <td>2.970100</td>
      <td>16</td>
    </tr>
    <tr>
      <th>16</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>17.0</td>
      <td>1.990000</td>
      <td>17</td>
    </tr>
    <tr>
      <th>17</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>18.0</td>
      <td>1.000000</td>
      <td>18</td>
    </tr>
    <tr>
      <th>18</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>1</td>
    </tr>
    <tr>
      <th>19</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>2.0</td>
      <td>3.940399</td>
      <td>2</td>
    </tr>
    <tr>
      <th>20</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>3.0</td>
      <td>3.940399</td>
      <td>3</td>
    </tr>
    <tr>
      <th>21</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>4.0</td>
      <td>3.940399</td>
      <td>4</td>
    </tr>
    <tr>
      <th>22</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>5.0</td>
      <td>3.940399</td>
      <td>5</td>
    </tr>
    <tr>
      <th>23</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>6.0</td>
      <td>3.940399</td>
      <td>6</td>
    </tr>
    <tr>
      <th>24</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>7.0</td>
      <td>3.940399</td>
      <td>7</td>
    </tr>
    <tr>
      <th>25</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>8.0</td>
      <td>3.940399</td>
      <td>8</td>
    </tr>
    <tr>
      <th>26</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>9.0</td>
      <td>3.940399</td>
      <td>9</td>
    </tr>
    <tr>
      <th>27</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>10.0</td>
      <td>3.940399</td>
      <td>10</td>
    </tr>
    <tr>
      <th>28</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>11.0</td>
      <td>3.940399</td>
      <td>11</td>
    </tr>
    <tr>
      <th>29</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>12.0</td>
      <td>3.940399</td>
      <td>12</td>
    </tr>
    <tr>
      <th>30</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>13.0</td>
      <td>3.940399</td>
      <td>13</td>
    </tr>
    <tr>
      <th>31</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>14.0</td>
      <td>3.940399</td>
      <td>14</td>
    </tr>
    <tr>
      <th>32</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>15.0</td>
      <td>3.940399</td>
      <td>15</td>
    </tr>
    <tr>
      <th>33</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>16.0</td>
      <td>3.940399</td>
      <td>16</td>
    </tr>
    <tr>
      <th>34</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>17.0</td>
      <td>3.940399</td>
      <td>17</td>
    </tr>
    <tr>
      <th>35</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>18.0</td>
      <td>3.940399</td>
      <td>18</td>
    </tr>
    <tr>
      <th>36</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>19.0</td>
      <td>3.940399</td>
      <td>19</td>
    </tr>
    <tr>
      <th>37</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>20.0</td>
      <td>3.940399</td>
      <td>20</td>
    </tr>
    <tr>
      <th>38</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>21.0</td>
      <td>3.940399</td>
      <td>21</td>
    </tr>
    <tr>
      <th>39</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>22.0</td>
      <td>3.940399</td>
      <td>22</td>
    </tr>
    <tr>
      <th>40</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>23.0</td>
      <td>3.940399</td>
      <td>23</td>
    </tr>
    <tr>
      <th>41</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>24.0</td>
      <td>3.940399</td>
      <td>24</td>
    </tr>
    <tr>
      <th>42</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>25.0</td>
      <td>3.940399</td>
      <td>25</td>
    </tr>
    <tr>
      <th>43</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>26.0</td>
      <td>3.940399</td>
      <td>26</td>
    </tr>
    <tr>
      <th>44</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>27.0</td>
      <td>3.940399</td>
      <td>27</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>28.0</td>
      <td>3.940399</td>
      <td>28</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>29.0</td>
      <td>3.940399</td>
      <td>29</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>30.0</td>
      <td>3.940399</td>
      <td>30</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>31.0</td>
      <td>3.940399</td>
      <td>31</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>32.0</td>
      <td>3.940399</td>
      <td>32</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/fastrl_user/.local/lib/python3.8/site-packages/gym/logger.py:30: UserWarning: <span class="ansi-yellow-fg">WARN: Box bound precision lowered by casting to float32</span>
  warnings.warn(colorize(&#39;%s: %s&#39;%(&#39;WARN&#39;, msg % args), &#39;yellow&#39;))
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
WalkerBase::__init__
WalkerBase::__init__
argv[0]=
argv[0]=
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-5.460649</td>
      <td>-0.925029</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-7.589081</td>
      <td>-0.192170</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-13.785332</td>
      <td>-5.211381</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-20.560429</td>
      <td>-1.355723</td>
      <td>12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-24.781374</td>
      <td>-1.836308</td>
      <td>15</td>
    </tr>
    <tr>
      <th>5</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-29.287111</td>
      <td>-3.751504</td>
      <td>18</td>
    </tr>
    <tr>
      <th>6</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-39.026463</td>
      <td>-9.739350</td>
      <td>19</td>
    </tr>
    <tr>
      <th>7</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-5.658057</td>
      <td>-2.912030</td>
      <td>3</td>
    </tr>
    <tr>
      <th>8</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-11.764021</td>
      <td>-1.163851</td>
      <td>6</td>
    </tr>
    <tr>
      <th>9</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-15.854069</td>
      <td>-2.173017</td>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-24.035669</td>
      <td>-3.804121</td>
      <td>12</td>
    </tr>
    <tr>
      <th>11</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-30.130154</td>
      <td>-2.130040</td>
      <td>15</td>
    </tr>
    <tr>
      <th>12</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-33.633038</td>
      <td>-3.512017</td>
      <td>17</td>
    </tr>
    <tr>
      <th>13</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-3.907875</td>
      <td>-4.017416</td>
      <td>3</td>
    </tr>
    <tr>
      <th>14</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-8.825839</td>
      <td>-1.564122</td>
      <td>6</td>
    </tr>
    <tr>
      <th>15</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-12.425820</td>
      <td>-0.266897</td>
      <td>9</td>
    </tr>
    <tr>
      <th>16</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-13.927518</td>
      <td>-0.301701</td>
      <td>12</td>
    </tr>
    <tr>
      <th>17</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-14.934414</td>
      <td>-0.161045</td>
      <td>15</td>
    </tr>
    <tr>
      <th>18</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-18.569820</td>
      <td>-0.123941</td>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-21.829731</td>
      <td>-3.259911</td>
      <td>19</td>
    </tr>
    <tr>
      <th>20</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-3.331529</td>
      <td>0.274922</td>
      <td>3</td>
    </tr>
    <tr>
      <th>21</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-6.332394</td>
      <td>-0.756185</td>
      <td>6</td>
    </tr>
    <tr>
      <th>22</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-11.466064</td>
      <td>-1.785308</td>
      <td>9</td>
    </tr>
    <tr>
      <th>23</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-14.476315</td>
      <td>-0.044112</td>
      <td>12</td>
    </tr>
    <tr>
      <th>24</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-19.911324</td>
      <td>-2.378121</td>
      <td>15</td>
    </tr>
    <tr>
      <th>25</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-25.741055</td>
      <td>-2.644940</td>
      <td>18</td>
    </tr>
    <tr>
      <th>26</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-35.511288</td>
      <td>-5.467644</td>
      <td>21</td>
    </tr>
    <tr>
      <th>27</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-1.789758</td>
      <td>-0.116494</td>
      <td>3</td>
    </tr>
    <tr>
      <th>28</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-12.547633</td>
      <td>-2.845086</td>
      <td>6</td>
    </tr>
    <tr>
      <th>29</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-24.397577</td>
      <td>-4.083155</td>
      <td>9</td>
    </tr>
    <tr>
      <th>30</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-35.423641</td>
      <td>-3.937268</td>
      <td>12</td>
    </tr>
    <tr>
      <th>31</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-37.201710</td>
      <td>-1.410563</td>
      <td>15</td>
    </tr>
    <tr>
      <th>32</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-50.040470</td>
      <td>-7.341498</td>
      <td>18</td>
    </tr>
    <tr>
      <th>33</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-1.453207</td>
      <td>-1.061626</td>
      <td>3</td>
    </tr>
    <tr>
      <th>34</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-2.246274</td>
      <td>-0.524251</td>
      <td>6</td>
    </tr>
    <tr>
      <th>35</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-4.733473</td>
      <td>0.352671</td>
      <td>9</td>
    </tr>
    <tr>
      <th>36</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-7.568768</td>
      <td>-1.092766</td>
      <td>12</td>
    </tr>
    <tr>
      <th>37</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-15.015378</td>
      <td>-4.219254</td>
      <td>15</td>
    </tr>
    <tr>
      <th>38</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-21.251606</td>
      <td>-1.551186</td>
      <td>18</td>
    </tr>
    <tr>
      <th>39</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-26.296288</td>
      <td>-5.044683</td>
      <td>19</td>
    </tr>
    <tr>
      <th>40</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-2.799258</td>
      <td>-0.882969</td>
      <td>3</td>
    </tr>
    <tr>
      <th>41</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-16.057045</td>
      <td>-4.157443</td>
      <td>6</td>
    </tr>
    <tr>
      <th>42</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-18.170053</td>
      <td>-1.245300</td>
      <td>9</td>
    </tr>
    <tr>
      <th>43</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-19.443439</td>
      <td>-0.950453</td>
      <td>12</td>
    </tr>
    <tr>
      <th>44</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-24.025082</td>
      <td>-0.632523</td>
      <td>15</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-31.605280</td>
      <td>-3.602634</td>
      <td>18</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-6.083467</td>
      <td>-1.319777</td>
      <td>3</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-10.237586</td>
      <td>-1.638564</td>
      <td>6</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-16.522840</td>
      <td>-1.353775</td>
      <td>9</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-18.326366</td>
      <td>0.206006</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Metrics">Metrics<a class="anchor-link" href="#Metrics"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Reward" class="doc_header"><code>class</code> <code>Reward</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L255" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Reward</code>() :: <code>Metric</code></p>
</blockquote>
<p>Blueprint for defining a metric</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NEpisodes" class="doc_header"><code>class</code> <code>NEpisodes</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L274" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NEpisodes</code>() :: <code>Metric</code></p>
</blockquote>
<p>Blueprint for defining a metric</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">torch.nn</span> <span class="kn">import</span> <span class="n">Linear</span>

<span class="k">class</span> <span class="nc">FakeModel</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span><span class="o">=</span><span class="n">Linear</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
<span class="c1">#         print(x)</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">])</span>
<span class="n">block</span><span class="o">=</span><span class="n">SourceDataBlock</span><span class="p">()</span>
<span class="n">dls</span><span class="o">=</span><span class="n">block</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">([</span><span class="n">source</span><span class="p">],</span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">learn</span><span class="o">=</span><span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span><span class="n">FakeModel</span><span class="p">(),</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">Reward</span><span class="p">,</span><span class="n">NEpisodes</span><span class="p">],</span><span class="n">loss_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">o</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Could not do one pass in your dataloader, there is something wrong in it
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>train_reward</th>
      <th>train_n_episodes</th>
      <th>valid_loss</th>
      <th>valid_reward</th>
      <th>valid_n_episodes</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.000000</td>
      <td>22.704545</td>
      <td>44</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.000000</td>
      <td>23.619048</td>
      <td>84</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.000000</td>
      <td>23.130000</td>
      <td>128</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.000000</td>
      <td>24.000000</td>
      <td>169</td>
      <td>00:02</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Export">Export<a class="anchor-link" href="#Export"> </a></h2>
</div>
</div>
</div>
</div>
 

