---

title: Data Block Gym


keywords: fastai
sidebar: home_sidebar

summary: "openai gym sources"
description: "openai gym sources"
nb_path: "nbs/05b_data.gym.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/05b_data.gym.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="GymSource">GymSource<a class="anchor-link" href="#GymSource"> </a></h2><blockquote><p>The base iterable used for iterating through environments.</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ReturnHistory" class="doc_header"><code>class</code> <code>ReturnHistory</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L36" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ReturnHistory</code>(<strong><code>enc</code></strong>=<em><code>None</code></em>, <strong><code>dec</code></strong>=<em><code>None</code></em>, <strong><code>split_idx</code></strong>=<em><code>None</code></em>, <strong><code>order</code></strong>=<em><code>None</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>Delegates (<code>__call__</code>,<code>decode</code>,<code>setup</code>) to (<code>encodes</code>,<code>decodes</code>,<code>setups</code>) if <code>split_idx</code> matches</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>enc</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>dec</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>split_idx</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>order</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">%(asctime)s</span><span class="s1">.</span><span class="si">%(msecs)03d</span><span class="s1">] p</span><span class="si">%(process)s</span><span class="s1"> {</span><span class="si">%(filename)s</span><span class="s1">:</span><span class="si">%(lineno)d</span><span class="s1">} </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">datefmt</span><span class="o">=</span><span class="s1">&#39;%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;INFO&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TstCallback" class="doc_header"><code>class</code> <code>TstCallback</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L47" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TstCallback</code>(<strong><code>action_space</code></strong>=<em><code>None</code></em>, <strong><code>constant</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/agent.html#AgentCallback"><code>AgentCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>action_space</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>constant</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="np_type_cast" class="doc_header"><code>np_type_cast</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L61" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>np_type_cast</code>(<strong><code>a</code></strong>, <strong><code>dtype</code></strong>)</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>a</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>dtype</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GymLoop" class="doc_header"><code>class</code> <code>GymLoop</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L63" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GymLoop</code>(<strong><code>env_name</code></strong>:<code>str</code>, <strong><code>agent</code></strong>=<em><code>None</code></em>, <strong><code>mode</code></strong>=<em><code>None</code></em>, <strong><code>steps_count</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>steps_delta</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>seed</code></strong>:<code>int</code>=<em><code>None</code></em>, <strong><code>worker_id</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>dtype</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/callback.core.html#LoopCallback"><code>LoopCallback</code></a></p>
</blockquote>
<p>Handles iterating through single openai gym (and varients).</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>env_name</code></strong> : <em><code>&lt;class 'str'&gt;</code></em></p>
</li>
<li><p><strong><code>agent</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>mode</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>steps_count</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>steps_delta</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>seed</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>worker_id</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>dtype</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> - after_create   : [GymLoop]
Start Setup
   - initialize     : [GymLoop]
End Setup
 - before_episodes: [GymLoop]
Start Episodes
   - reset          : [GymLoop]
   - do_action      : []
   - do_step        : [GymLoop]
   - do_render      : []
   - before_history : [GymLoop]
   - history        : [GymLoop]
   - after_history  : [GymLoop]
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">.</span><span class="n">cbs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">cbs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">action_executions</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">persistent</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
WalkerBase::__init__
argv[0]=
argv[0]=
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>0.224209</td>
      <td>0.224209</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-1.036889</td>
      <td>-1.261098</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-2.243361</td>
      <td>-1.206472</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-2.652465</td>
      <td>-0.409104</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-3.891244</td>
      <td>-1.238779</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-6.191977</td>
      <td>-2.300733</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-8.738767</td>
      <td>-2.546790</td>
      <td>7</td>
    </tr>
    <tr>
      <th>7</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-9.420101</td>
      <td>-0.681334</td>
      <td>8</td>
    </tr>
    <tr>
      <th>8</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-11.450974</td>
      <td>-2.030873</td>
      <td>9</td>
    </tr>
    <tr>
      <th>9</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-12.823546</td>
      <td>-1.372573</td>
      <td>10</td>
    </tr>
    <tr>
      <th>10</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-15.530539</td>
      <td>-2.706993</td>
      <td>11</td>
    </tr>
    <tr>
      <th>11</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-16.861963</td>
      <td>-1.331424</td>
      <td>12</td>
    </tr>
    <tr>
      <th>12</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-18.683912</td>
      <td>-1.821949</td>
      <td>13</td>
    </tr>
    <tr>
      <th>13</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-20.680334</td>
      <td>-1.996422</td>
      <td>14</td>
    </tr>
    <tr>
      <th>14</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-20.565121</td>
      <td>0.115214</td>
      <td>15</td>
    </tr>
    <tr>
      <th>15</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-21.951899</td>
      <td>-1.386778</td>
      <td>16</td>
    </tr>
    <tr>
      <th>16</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-22.020096</td>
      <td>-0.068197</td>
      <td>17</td>
    </tr>
    <tr>
      <th>17</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-25.110855</td>
      <td>-3.090760</td>
      <td>18</td>
    </tr>
    <tr>
      <th>18</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-31.257797</td>
      <td>-6.146942</td>
      <td>19</td>
    </tr>
    <tr>
      <th>19</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-0.159001</td>
      <td>-0.159001</td>
      <td>1</td>
    </tr>
    <tr>
      <th>20</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-1.634214</td>
      <td>-1.475212</td>
      <td>2</td>
    </tr>
    <tr>
      <th>21</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-1.646052</td>
      <td>-0.011839</td>
      <td>3</td>
    </tr>
    <tr>
      <th>22</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-1.967394</td>
      <td>-0.321342</td>
      <td>4</td>
    </tr>
    <tr>
      <th>23</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-3.252871</td>
      <td>-1.285477</td>
      <td>5</td>
    </tr>
    <tr>
      <th>24</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-4.587852</td>
      <td>-1.334981</td>
      <td>6</td>
    </tr>
    <tr>
      <th>25</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-7.117702</td>
      <td>-2.529850</td>
      <td>7</td>
    </tr>
    <tr>
      <th>26</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-10.211718</td>
      <td>-3.094016</td>
      <td>8</td>
    </tr>
    <tr>
      <th>27</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-13.925764</td>
      <td>-3.714046</td>
      <td>9</td>
    </tr>
    <tr>
      <th>28</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-16.269648</td>
      <td>-2.343884</td>
      <td>10</td>
    </tr>
    <tr>
      <th>29</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-18.483387</td>
      <td>-2.213740</td>
      <td>11</td>
    </tr>
    <tr>
      <th>30</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-19.939098</td>
      <td>-1.455711</td>
      <td>12</td>
    </tr>
    <tr>
      <th>31</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-19.912306</td>
      <td>0.026793</td>
      <td>13</td>
    </tr>
    <tr>
      <th>32</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-20.192194</td>
      <td>-0.279888</td>
      <td>14</td>
    </tr>
    <tr>
      <th>33</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-22.648502</td>
      <td>-2.456308</td>
      <td>15</td>
    </tr>
    <tr>
      <th>34</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-23.457413</td>
      <td>-0.808910</td>
      <td>16</td>
    </tr>
    <tr>
      <th>35</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-24.081093</td>
      <td>-0.623680</td>
      <td>17</td>
    </tr>
    <tr>
      <th>36</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-27.927200</td>
      <td>-3.846108</td>
      <td>18</td>
    </tr>
    <tr>
      <th>37</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>0.113291</td>
      <td>0.113291</td>
      <td>1</td>
    </tr>
    <tr>
      <th>38</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>0.187320</td>
      <td>0.074029</td>
      <td>2</td>
    </tr>
    <tr>
      <th>39</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>0.116449</td>
      <td>-0.070870</td>
      <td>3</td>
    </tr>
    <tr>
      <th>40</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-0.712331</td>
      <td>-0.828780</td>
      <td>4</td>
    </tr>
    <tr>
      <th>41</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-1.811917</td>
      <td>-1.099586</td>
      <td>5</td>
    </tr>
    <tr>
      <th>42</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-4.578411</td>
      <td>-2.766494</td>
      <td>6</td>
    </tr>
    <tr>
      <th>43</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-11.913105</td>
      <td>-7.334694</td>
      <td>7</td>
    </tr>
    <tr>
      <th>44</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-12.008710</td>
      <td>-0.095605</td>
      <td>8</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-14.041313</td>
      <td>-2.032603</td>
      <td>9</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-16.730339</td>
      <td>-2.689026</td>
      <td>10</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-19.159153</td>
      <td>-2.428814</td>
      <td>11</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-20.626999</td>
      <td>-1.467846</td>
      <td>12</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-22.555603</td>
      <td>-1.928604</td>
      <td>13</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">persistent</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/fastrl_user/.local/lib/python3.8/site-packages/gym/spaces/box.py:73: UserWarning: <span class="ansi-yellow-fg">WARN: Box bound precision lowered by casting to float32</span>
  logger.warn(
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
WalkerBase::__init__
argv[0]=
argv[0]=
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-1.054040</td>
      <td>-0.542324</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-2.702384</td>
      <td>-1.648345</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-6.899103</td>
      <td>-0.829668</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-7.553154</td>
      <td>-0.654051</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-15.424783</td>
      <td>-2.618064</td>
      <td>11</td>
    </tr>
    <tr>
      <th>5</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-16.750374</td>
      <td>-1.325592</td>
      <td>12</td>
    </tr>
    <tr>
      <th>6</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-19.674646</td>
      <td>-1.699259</td>
      <td>15</td>
    </tr>
    <tr>
      <th>7</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-19.624516</td>
      <td>0.050131</td>
      <td>16</td>
    </tr>
    <tr>
      <th>8</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-25.014269</td>
      <td>-3.887028</td>
      <td>19</td>
    </tr>
    <tr>
      <th>9</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-26.500366</td>
      <td>-1.486096</td>
      <td>20</td>
    </tr>
    <tr>
      <th>10</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-30.334404</td>
      <td>1.389526</td>
      <td>23</td>
    </tr>
    <tr>
      <th>11</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-28.888805</td>
      <td>1.445599</td>
      <td>24</td>
    </tr>
    <tr>
      <th>12</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-34.481861</td>
      <td>-3.050864</td>
      <td>27</td>
    </tr>
    <tr>
      <th>13</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-35.420582</td>
      <td>-0.938720</td>
      <td>28</td>
    </tr>
    <tr>
      <th>14</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-37.514782</td>
      <td>-0.707692</td>
      <td>31</td>
    </tr>
    <tr>
      <th>15</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-36.168720</td>
      <td>1.346062</td>
      <td>32</td>
    </tr>
    <tr>
      <th>16</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-36.168720</td>
      <td>1.346062</td>
      <td>32</td>
    </tr>
    <tr>
      <th>17</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-39.259811</td>
      <td>-3.091091</td>
      <td>33</td>
    </tr>
    <tr>
      <th>18</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-39.259811</td>
      <td>-3.091091</td>
      <td>33</td>
    </tr>
    <tr>
      <th>19</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-3.984093</td>
      <td>-0.694471</td>
      <td>3</td>
    </tr>
    <tr>
      <th>20</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-3.539786</td>
      <td>0.444307</td>
      <td>4</td>
    </tr>
    <tr>
      <th>21</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-8.876405</td>
      <td>-3.339910</td>
      <td>7</td>
    </tr>
    <tr>
      <th>22</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-8.848678</td>
      <td>0.027727</td>
      <td>8</td>
    </tr>
    <tr>
      <th>23</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-11.757010</td>
      <td>-0.643331</td>
      <td>11</td>
    </tr>
    <tr>
      <th>24</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-12.410851</td>
      <td>-0.653841</td>
      <td>12</td>
    </tr>
    <tr>
      <th>25</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-16.194485</td>
      <td>-0.923995</td>
      <td>15</td>
    </tr>
    <tr>
      <th>26</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-17.867395</td>
      <td>-1.672911</td>
      <td>16</td>
    </tr>
    <tr>
      <th>27</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-26.137564</td>
      <td>-3.396601</td>
      <td>19</td>
    </tr>
    <tr>
      <th>28</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-27.626383</td>
      <td>-1.488820</td>
      <td>20</td>
    </tr>
    <tr>
      <th>29</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-30.643425</td>
      <td>-1.678596</td>
      <td>22</td>
    </tr>
    <tr>
      <th>30</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-35.616962</td>
      <td>-4.973536</td>
      <td>23</td>
    </tr>
    <tr>
      <th>31</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-35.616962</td>
      <td>-4.973536</td>
      <td>23</td>
    </tr>
    <tr>
      <th>32</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-1.992343</td>
      <td>-0.385802</td>
      <td>3</td>
    </tr>
    <tr>
      <th>33</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-4.498386</td>
      <td>-2.506044</td>
      <td>4</td>
    </tr>
    <tr>
      <th>34</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-12.829090</td>
      <td>-3.051767</td>
      <td>7</td>
    </tr>
    <tr>
      <th>35</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-14.829434</td>
      <td>-2.000345</td>
      <td>8</td>
    </tr>
    <tr>
      <th>36</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-22.672085</td>
      <td>-1.828913</td>
      <td>11</td>
    </tr>
    <tr>
      <th>37</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-24.235409</td>
      <td>-1.563323</td>
      <td>12</td>
    </tr>
    <tr>
      <th>38</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-26.851128</td>
      <td>-1.094098</td>
      <td>15</td>
    </tr>
    <tr>
      <th>39</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-28.073902</td>
      <td>-1.222775</td>
      <td>16</td>
    </tr>
    <tr>
      <th>40</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-29.060274</td>
      <td>-0.986372</td>
      <td>17</td>
    </tr>
    <tr>
      <th>41</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-32.763111</td>
      <td>-3.702835</td>
      <td>18</td>
    </tr>
    <tr>
      <th>42</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-32.763111</td>
      <td>-3.702835</td>
      <td>18</td>
    </tr>
    <tr>
      <th>43</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-1.055471</td>
      <td>-0.657142</td>
      <td>3</td>
    </tr>
    <tr>
      <th>44</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-1.795626</td>
      <td>-0.740156</td>
      <td>4</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-3.263175</td>
      <td>-0.512509</td>
      <td>7</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-5.308920</td>
      <td>-2.045745</td>
      <td>8</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-14.199278</td>
      <td>-6.892894</td>
      <td>11</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-16.661377</td>
      <td>-2.462098</td>
      <td>12</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-23.404762</td>
      <td>-2.716537</td>
      <td>15</td>
    </tr>
    <tr>
      <th>50</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-24.973028</td>
      <td>-1.568266</td>
      <td>16</td>
    </tr>
    <tr>
      <th>51</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-25.197664</td>
      <td>0.641098</td>
      <td>18</td>
    </tr>
    <tr>
      <th>52</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-28.686319</td>
      <td>-3.488655</td>
      <td>19</td>
    </tr>
    <tr>
      <th>53</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-28.686319</td>
      <td>-3.488655</td>
      <td>19</td>
    </tr>
    <tr>
      <th>54</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-0.530288</td>
      <td>0.312611</td>
      <td>3</td>
    </tr>
    <tr>
      <th>55</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-1.350622</td>
      <td>-0.820334</td>
      <td>4</td>
    </tr>
    <tr>
      <th>56</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-7.748623</td>
      <td>-3.014027</td>
      <td>7</td>
    </tr>
    <tr>
      <th>57</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-8.455316</td>
      <td>-0.706693</td>
      <td>8</td>
    </tr>
    <tr>
      <th>58</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-16.177582</td>
      <td>-3.486815</td>
      <td>11</td>
    </tr>
    <tr>
      <th>59</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-17.903538</td>
      <td>-1.725955</td>
      <td>12</td>
    </tr>
    <tr>
      <th>60</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-24.232111</td>
      <td>-1.451163</td>
      <td>15</td>
    </tr>
    <tr>
      <th>61</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-25.305227</td>
      <td>-1.073117</td>
      <td>16</td>
    </tr>
    <tr>
      <th>62</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-36.253319</td>
      <td>-3.493410</td>
      <td>19</td>
    </tr>
    <tr>
      <th>63</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-36.599155</td>
      <td>-0.345835</td>
      <td>20</td>
    </tr>
    <tr>
      <th>64</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-36.599155</td>
      <td>-0.345835</td>
      <td>20</td>
    </tr>
    <tr>
      <th>65</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-40.883301</td>
      <td>-4.284144</td>
      <td>21</td>
    </tr>
    <tr>
      <th>66</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-40.883301</td>
      <td>-4.284144</td>
      <td>21</td>
    </tr>
    <tr>
      <th>67</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-6.669263</td>
      <td>-2.313206</td>
      <td>3</td>
    </tr>
    <tr>
      <th>68</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-9.118885</td>
      <td>-2.449622</td>
      <td>4</td>
    </tr>
    <tr>
      <th>69</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-18.239443</td>
      <td>-3.222784</td>
      <td>7</td>
    </tr>
    <tr>
      <th>70</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-18.356726</td>
      <td>-0.117282</td>
      <td>8</td>
    </tr>
    <tr>
      <th>71</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-25.142986</td>
      <td>-2.604519</td>
      <td>11</td>
    </tr>
    <tr>
      <th>72</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-28.779047</td>
      <td>-3.636060</td>
      <td>12</td>
    </tr>
    <tr>
      <th>73</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-34.139397</td>
      <td>-1.274438</td>
      <td>15</td>
    </tr>
    <tr>
      <th>74</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-36.424839</td>
      <td>-2.285443</td>
      <td>16</td>
    </tr>
    <tr>
      <th>75</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-39.301987</td>
      <td>-0.383274</td>
      <td>18</td>
    </tr>
    <tr>
      <th>76</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-42.920143</td>
      <td>-3.618156</td>
      <td>19</td>
    </tr>
    <tr>
      <th>77</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-42.920143</td>
      <td>-3.618156</td>
      <td>19</td>
    </tr>
    <tr>
      <th>78</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-2.602334</td>
      <td>-0.080707</td>
      <td>3</td>
    </tr>
    <tr>
      <th>79</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-3.686775</td>
      <td>-1.084440</td>
      <td>4</td>
    </tr>
    <tr>
      <th>80</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-10.376181</td>
      <td>-4.171218</td>
      <td>7</td>
    </tr>
    <tr>
      <th>81</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-15.922807</td>
      <td>-5.546626</td>
      <td>8</td>
    </tr>
    <tr>
      <th>82</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-26.705441</td>
      <td>-3.935713</td>
      <td>11</td>
    </tr>
    <tr>
      <th>83</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-29.160206</td>
      <td>-2.454765</td>
      <td>12</td>
    </tr>
    <tr>
      <th>84</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-34.693718</td>
      <td>-1.503091</td>
      <td>15</td>
    </tr>
    <tr>
      <th>85</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-35.026680</td>
      <td>-0.332963</td>
      <td>16</td>
    </tr>
    <tr>
      <th>86</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-37.237690</td>
      <td>-1.484164</td>
      <td>18</td>
    </tr>
    <tr>
      <th>87</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-42.238441</td>
      <td>-5.000752</td>
      <td>19</td>
    </tr>
    <tr>
      <th>88</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-42.238441</td>
      <td>-5.000752</td>
      <td>19</td>
    </tr>
    <tr>
      <th>89</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-3.352186</td>
      <td>-0.002168</td>
      <td>3</td>
    </tr>
    <tr>
      <th>90</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-6.313209</td>
      <td>-2.961022</td>
      <td>4</td>
    </tr>
    <tr>
      <th>91</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-10.984173</td>
      <td>-1.058541</td>
      <td>7</td>
    </tr>
    <tr>
      <th>92</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-10.390368</td>
      <td>0.593804</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FirstLastTfm" class="doc_header"><code>class</code> <code>FirstLastTfm</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L159" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FirstLastTfm</code>(<strong><code>gamma</code></strong>) :: <code>Transform</code></p>
</blockquote>
<p>Delegates (<code>__call__</code>,<code>decode</code>,<code>setup</code>) to (<code>encodes</code>,<code>decodes</code>,<code>setups</code>) if <code>split_idx</code> matches</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>gamma</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FirstLast" class="doc_header"><code>class</code> <code>FirstLast</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L183" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FirstLast</code>(<strong><code>gamma</code></strong>=<em><code>0.99</code></em>) :: <a href="/fastrl/callback.core.html#LoopCallback"><code>LoopCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>gamma</code></strong> : <em><code>&lt;class 'float'&gt;</code></em>, <em>optional</em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> - after_create   : [GymLoop]
Start Setup
   - initialize     : [GymLoop]
End Setup
 - before_episodes: [GymLoop]
Start Episodes
   - reset          : [GymLoop]
   - do_action      : []
   - do_step        : [GymLoop]
   - do_render      : []
   - before_history : [GymLoop]
   - history        : [GymLoop]
   - after_history  : [GymLoop]
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>35.0</td>
      <td>1.0</td>
      <td>35</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>36.0</td>
      <td>1.0</td>
      <td>36</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>37.0</td>
      <td>1.0</td>
      <td>37</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>38.0</td>
      <td>1.0</td>
      <td>38</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>3</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>50 rows × 11 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)[[</span><span class="s1">&#39;state_mu&#39;</span><span class="p">,</span><span class="s1">&#39;next_state_mu&#39;</span><span class="p">,</span><span class="s1">&#39;done&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state_mu</th>
      <th>next_state_mu</th>
      <th>done</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.004724</td>
      <td>0.031226</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.016113</td>
      <td>0.004767</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.011280</td>
      <td>-0.021490</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.009797</td>
      <td>-0.047971</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.031226</td>
      <td>-0.075111</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.004767</td>
      <td>-0.054650</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-0.021490</td>
      <td>-0.083452</td>
      <td>False</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-0.047971</td>
      <td>-0.113395</td>
      <td>False</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-0.075111</td>
      <td>-0.096496</td>
      <td>False</td>
    </tr>
    <tr>
      <th>9</th>
      <td>-0.054650</td>
      <td>-0.129051</td>
      <td>False</td>
    </tr>
    <tr>
      <th>10</th>
      <td>-0.083452</td>
      <td>-0.163235</td>
      <td>False</td>
    </tr>
    <tr>
      <th>11</th>
      <td>-0.113395</td>
      <td>-0.151896</td>
      <td>False</td>
    </tr>
    <tr>
      <th>12</th>
      <td>-0.096496</td>
      <td>-0.142658</td>
      <td>False</td>
    </tr>
    <tr>
      <th>13</th>
      <td>-0.129051</td>
      <td>-0.135178</td>
      <td>False</td>
    </tr>
    <tr>
      <th>14</th>
      <td>-0.163235</td>
      <td>-0.129102</td>
      <td>False</td>
    </tr>
    <tr>
      <th>15</th>
      <td>-0.151896</td>
      <td>-0.124063</td>
      <td>True</td>
    </tr>
    <tr>
      <th>16</th>
      <td>-0.142658</td>
      <td>-0.124063</td>
      <td>True</td>
    </tr>
    <tr>
      <th>17</th>
      <td>-0.135178</td>
      <td>-0.124063</td>
      <td>True</td>
    </tr>
    <tr>
      <th>18</th>
      <td>-0.129102</td>
      <td>-0.124063</td>
      <td>True</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.009831</td>
      <td>0.022323</td>
      <td>False</td>
    </tr>
    <tr>
      <th>20</th>
      <td>0.036250</td>
      <td>0.050839</td>
      <td>False</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0.063230</td>
      <td>0.080009</td>
      <td>False</td>
    </tr>
    <tr>
      <th>22</th>
      <td>0.042507</td>
      <td>0.110270</td>
      <td>False</td>
    </tr>
    <tr>
      <th>23</th>
      <td>0.022323</td>
      <td>0.093693</td>
      <td>False</td>
    </tr>
    <tr>
      <th>24</th>
      <td>0.050839</td>
      <td>0.126469</td>
      <td>False</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0.080009</td>
      <td>0.160830</td>
      <td>False</td>
    </tr>
    <tr>
      <th>26</th>
      <td>0.110270</td>
      <td>0.149685</td>
      <td>False</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0.093693</td>
      <td>0.140597</td>
      <td>False</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0.126469</td>
      <td>0.179558</td>
      <td>False</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0.160830</td>
      <td>0.220277</td>
      <td>True</td>
    </tr>
    <tr>
      <th>30</th>
      <td>0.149685</td>
      <td>0.220277</td>
      <td>True</td>
    </tr>
    <tr>
      <th>31</th>
      <td>0.140597</td>
      <td>0.220277</td>
      <td>True</td>
    </tr>
    <tr>
      <th>32</th>
      <td>0.179558</td>
      <td>0.220277</td>
      <td>True</td>
    </tr>
    <tr>
      <th>33</th>
      <td>0.040876</td>
      <td>0.000790</td>
      <td>False</td>
    </tr>
    <tr>
      <th>34</th>
      <td>0.018962</td>
      <td>-0.022483</td>
      <td>False</td>
    </tr>
    <tr>
      <th>35</th>
      <td>0.045397</td>
      <td>0.001787</td>
      <td>False</td>
    </tr>
    <tr>
      <th>36</th>
      <td>0.023271</td>
      <td>-0.023410</td>
      <td>False</td>
    </tr>
    <tr>
      <th>37</th>
      <td>0.000790</td>
      <td>-0.049844</td>
      <td>False</td>
    </tr>
    <tr>
      <th>38</th>
      <td>-0.022483</td>
      <td>-0.077949</td>
      <td>False</td>
    </tr>
    <tr>
      <th>39</th>
      <td>0.001787</td>
      <td>-0.108148</td>
      <td>False</td>
    </tr>
    <tr>
      <th>40</th>
      <td>-0.023410</td>
      <td>-0.092577</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41</th>
      <td>-0.049844</td>
      <td>-0.079451</td>
      <td>False</td>
    </tr>
    <tr>
      <th>42</th>
      <td>-0.077949</td>
      <td>-0.115627</td>
      <td>False</td>
    </tr>
    <tr>
      <th>43</th>
      <td>-0.108148</td>
      <td>-0.153940</td>
      <td>False</td>
    </tr>
    <tr>
      <th>44</th>
      <td>-0.092577</td>
      <td>-0.194747</td>
      <td>True</td>
    </tr>
    <tr>
      <th>45</th>
      <td>-0.079451</td>
      <td>-0.194747</td>
      <td>True</td>
    </tr>
    <tr>
      <th>46</th>
      <td>-0.115627</td>
      <td>-0.194747</td>
      <td>True</td>
    </tr>
    <tr>
      <th>47</th>
      <td>-0.153940</td>
      <td>-0.194747</td>
      <td>True</td>
    </tr>
    <tr>
      <th>48</th>
      <td>-0.008585</td>
      <td>-0.070245</td>
      <td>False</td>
    </tr>
    <tr>
      <th>49</th>
      <td>-0.034913</td>
      <td>-0.100378</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/fastrl_user/.local/lib/python3.8/site-packages/gym/spaces/box.py:73: UserWarning: <span class="ansi-yellow-fg">WARN: Box bound precision lowered by casting to float32</span>
  logger.warn(
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
WalkerBase::__init__
WalkerBase::__init__
argv[0]=
argv[0]=
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-10.466591</td>
      <td>-3.129092</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-15.341833</td>
      <td>-1.188536</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-23.888718</td>
      <td>-2.391367</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-34.182518</td>
      <td>-2.666425</td>
      <td>12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-42.651329</td>
      <td>-1.740501</td>
      <td>15</td>
    </tr>
    <tr>
      <th>5</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-53.223206</td>
      <td>-3.097689</td>
      <td>18</td>
    </tr>
    <tr>
      <th>6</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-60.937790</td>
      <td>-6.024866</td>
      <td>20</td>
    </tr>
    <tr>
      <th>7</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-12.035754</td>
      <td>-4.848444</td>
      <td>3</td>
    </tr>
    <tr>
      <th>8</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-17.088457</td>
      <td>-1.554627</td>
      <td>6</td>
    </tr>
    <tr>
      <th>9</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-22.791599</td>
      <td>-1.265003</td>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-23.833071</td>
      <td>-0.185288</td>
      <td>12</td>
    </tr>
    <tr>
      <th>11</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-30.792171</td>
      <td>-3.633424</td>
      <td>15</td>
    </tr>
    <tr>
      <th>12</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-36.892895</td>
      <td>-2.455958</td>
      <td>18</td>
    </tr>
    <tr>
      <th>13</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-42.593063</td>
      <td>-5.700169</td>
      <td>19</td>
    </tr>
    <tr>
      <th>14</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-5.039013</td>
      <td>-1.659217</td>
      <td>3</td>
    </tr>
    <tr>
      <th>15</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-17.647131</td>
      <td>-5.122095</td>
      <td>6</td>
    </tr>
    <tr>
      <th>16</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-20.613611</td>
      <td>-1.367492</td>
      <td>9</td>
    </tr>
    <tr>
      <th>17</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-29.437246</td>
      <td>-5.728907</td>
      <td>12</td>
    </tr>
    <tr>
      <th>18</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-35.115334</td>
      <td>-2.941422</td>
      <td>15</td>
    </tr>
    <tr>
      <th>19</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-41.086048</td>
      <td>-3.418911</td>
      <td>18</td>
    </tr>
    <tr>
      <th>20</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-4.245522</td>
      <td>-3.406236</td>
      <td>3</td>
    </tr>
    <tr>
      <th>21</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-8.454030</td>
      <td>0.086686</td>
      <td>6</td>
    </tr>
    <tr>
      <th>22</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-12.625296</td>
      <td>-0.668282</td>
      <td>9</td>
    </tr>
    <tr>
      <th>23</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-13.695427</td>
      <td>0.185921</td>
      <td>12</td>
    </tr>
    <tr>
      <th>24</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-14.971830</td>
      <td>-0.018389</td>
      <td>15</td>
    </tr>
    <tr>
      <th>25</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-15.403198</td>
      <td>0.146364</td>
      <td>18</td>
    </tr>
    <tr>
      <th>26</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-21.580807</td>
      <td>-3.320113</td>
      <td>21</td>
    </tr>
    <tr>
      <th>27</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-2.806898</td>
      <td>-0.467919</td>
      <td>3</td>
    </tr>
    <tr>
      <th>28</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-15.895551</td>
      <td>-1.434428</td>
      <td>6</td>
    </tr>
    <tr>
      <th>29</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-20.239458</td>
      <td>-0.648024</td>
      <td>9</td>
    </tr>
    <tr>
      <th>30</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-22.539848</td>
      <td>-0.294408</td>
      <td>12</td>
    </tr>
    <tr>
      <th>31</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-27.009743</td>
      <td>-1.725241</td>
      <td>15</td>
    </tr>
    <tr>
      <th>32</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-33.864178</td>
      <td>-4.169717</td>
      <td>18</td>
    </tr>
    <tr>
      <th>33</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-2.629019</td>
      <td>-2.543620</td>
      <td>3</td>
    </tr>
    <tr>
      <th>34</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-7.680727</td>
      <td>-2.600699</td>
      <td>6</td>
    </tr>
    <tr>
      <th>35</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-13.262449</td>
      <td>-2.782605</td>
      <td>9</td>
    </tr>
    <tr>
      <th>36</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-17.245853</td>
      <td>-1.158971</td>
      <td>12</td>
    </tr>
    <tr>
      <th>37</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-20.127718</td>
      <td>-0.823819</td>
      <td>15</td>
    </tr>
    <tr>
      <th>38</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-27.486616</td>
      <td>-5.707702</td>
      <td>18</td>
    </tr>
    <tr>
      <th>39</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-3.240240</td>
      <td>-1.753200</td>
      <td>3</td>
    </tr>
    <tr>
      <th>40</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-11.891174</td>
      <td>-1.797556</td>
      <td>6</td>
    </tr>
    <tr>
      <th>41</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-17.265911</td>
      <td>-1.552301</td>
      <td>9</td>
    </tr>
    <tr>
      <th>42</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-24.391708</td>
      <td>-3.303290</td>
      <td>12</td>
    </tr>
    <tr>
      <th>43</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-25.978971</td>
      <td>-0.330943</td>
      <td>15</td>
    </tr>
    <tr>
      <th>44</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-27.646544</td>
      <td>-0.769039</td>
      <td>18</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-31.563299</td>
      <td>-3.957856</td>
      <td>20</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-0.662107</td>
      <td>-0.090655</td>
      <td>3</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-3.451362</td>
      <td>-1.470447</td>
      <td>6</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-10.663258</td>
      <td>-1.954481</td>
      <td>9</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-13.822918</td>
      <td>-0.044883</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="show_source" class="doc_header"><code>show_source</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L196" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>show_source</code>(<strong><code>src</code></strong>, <strong><code>iters</code></strong>=<em><code>50</code></em>)</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>src</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>iters</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rgb_array&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">show_source</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rgb_array&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">show_source</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ResReduce" class="doc_header"><code>class</code> <code>ResReduce</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L208" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ResReduce</code>(<strong><code>reduce_by</code></strong>=<em><code>2</code></em>) :: <a href="/fastrl/callback.core.html#LoopCallback"><code>LoopCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>reduce_by</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em>  <p>The amount to reduce the `image` resolution by e.g.: 400x400 -> 200x200 if default is used.</p></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rgb_array&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">ResReduce</span><span class="p">(</span><span class="n">reduce_by</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>
<span class="p">)</span>
<span class="n">show_source</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAACGCAIAAAAXaFLVAAACAElEQVR4nO3WwW3bQABFQTJwR0lNUk1WHSkjriNlMAcjgIPI1JLKM+Vg5qCDwMOCeFj+eVmWCf61L0cfgP+TsEgIi4SwSAiLhLBICIuEsEgIi4SwSAiLhLBICIuEsEgIi4SwSAiLhLBICIuEsEgIi4SwSAiLhLBICIuEsEgIi4SwSAiLhLBICIuEsEgIi4SwSAiLhLBICIuEsEgIi4SwSAiLhLBICIuEsEgIi4SwSAiLhLBICIuEsEgIi4SwSAiLhLBICIuEsEgIi4Sw9nu5nI8+wuMS1l1eLmd5XSUsEsIiIaydfAHXCYuEsO719fR89BEekbBICGsPA+smYZEQ1l0MrPcIi4SwSAhrM8t9hLBICGs/y32FsEgIi4SwtrHcBwmLhLB2stzXCYuEsDYwsMYJi4Sw9jCwbhIWCWGRENYoy30TYZEQ1maW+whhkRAWCWENsdy3EhYJYW1juQ8SFglhkXg6+gCPZZ7nv//88XxaeWBZlvZMn5Mba8j3n6dpmr6dL0cf5NMQ1m2vVb3+MkhYJGYT4a2rG2v6PbOufgq9QPg4bqw/vHdjrfACr7KxSAiLhLBI2Fgk3FgkhEVCWCSERUJYJIRFQlgkhEVCWCSERUJYJIRFQlgkhEVCWCSERUJYJIRFQlgkhEVCWCSERUJYJIRFQlgkhEVCWCSEReIXkUA8bZdY7PoAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Metrics">Metrics<a class="anchor-link" href="#Metrics"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Reward" class="doc_header"><code>class</code> <code>Reward</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L227" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Reward</code>(<strong><code>writer</code></strong>:<code>SummaryWriter</code>=<em><code>None</code></em>) :: <code>Metric</code></p>
</blockquote>
<p>Blueprint for defining a metric</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>writer</code></strong> : <em><code>&lt;class 'torch.utils.tensorboard.writer.SummaryWriter'&gt;</code></em>, <em>optional</em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NEpisodes" class="doc_header"><code>class</code> <code>NEpisodes</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L253" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NEpisodes</code>() :: <code>Metric</code></p>
</blockquote>
<p>Blueprint for defining a metric</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fake_gym_learner" class="doc_header"><code>fake_gym_learner</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L271" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fake_gym_learner</code>(<strong><code>source</code></strong>, <strong><code>n</code></strong>=<em><code>1000</code></em>, <strong><code>bs</code></strong>=<em><code>1</code></em>, <strong><code>num_workers</code></strong>=<em><code>0</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>source</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>n</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>bs</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>num_workers</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>kwargs</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">],</span><span class="n">persistent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">learn</span><span class="o">=</span><span class="n">fake_gym_learner</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Could not do one pass in your dataloader, there is something wrong in it
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>train_reward</th>
      <th>train_n_episodes</th>
      <th>valid_loss</th>
      <th>valid_reward</th>
      <th>valid_n_episodes</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.000000</td>
      <td>23.600000</td>
      <td>40</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.000000</td>
      <td>23.597561</td>
      <td>82</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.000000</td>
      <td>22.960000</td>
      <td>127</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.000000</td>
      <td>21.670000</td>
      <td>175</td>
      <td>00:03</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">cbs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">cbs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">action_executions</span><span class="p">,</span><span class="mi">4000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Export">Export<a class="anchor-link" href="#Export"> </a></h2>
</div>
</div>
</div>
</div>
 

