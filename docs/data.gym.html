---

title: Data Block Gym


keywords: fastai
sidebar: home_sidebar

summary: "openai gym sources"
description: "openai gym sources"
nb_path: "nbs/05b_data.gym.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/05b_data.gym.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="GymSource">GymSource<a class="anchor-link" href="#GymSource"> </a></h2><blockquote><p>The base iterable used for iterating through environments.</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># _loop=L([&#39;event.after_create&#39;,&#39;Start Setup&#39;,&#39;event.initialize&#39;,&#39;End Setup&#39;,</span>
<span class="c1">#              &#39;event.before_episodes&#39;,</span>
<span class="c1">#              &#39;Start Episodes&#39;,</span>
<span class="c1">#                  &#39;event.reset&#39;,</span>
<span class="c1">#                  &#39;event.do_action&#39;,</span>
<span class="c1">#                  &#39;event.do_step&#39;,</span>
<span class="c1">#                  &#39;event.do_render&#39;,</span>
<span class="c1">#                  &#39;event.before_history&#39;,</span>
<span class="c1">#                  &#39;event.history&#39;,</span>
<span class="c1">#                  &#39;event.after_history&#39;,</span>
<span class="c1">#              &#39;End Episodes&#39;,</span>
<span class="c1">#              &#39;event.after_episodes&#39;</span>
<span class="c1">#              ])</span>

<span class="c1"># mk_class(&#39;source_events&#39;, **parse_events(_loop).map_dict(),</span>
<span class="c1">#          doc=&quot;All possible events as attributes to get tab-completion and typo-proofing&quot;)</span>

<span class="c1"># _all_=[&#39;source_events&#39;]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># def return_data(o:dict): </span>
<span class="c1">#     source,data=o[&#39;source&#39;],o[&#39;history&#39;]</span>
    
<span class="c1">#     return {&#39;source&#39;:source,&#39;history&#39;:data}</span>

<span class="c1"># class Source(Loop):</span>
<span class="c1">#     _loop=_loop</span>
<span class="c1">#     _events=source_events</span>
<span class="c1">#     _default=&#39;source&#39;    </span>
<span class="c1">#     end_event=parse_events(_loop)[-1]</span>
    
<span class="c1">#     @delegates(Loop)</span>
<span class="c1">#     def __init__(self,cbs=None,test_mode=False,**kwargs):</span>
<span class="c1">#         self.idx=0</span>
<span class="c1">#         self.data_fields=&#39;state,next_state,done,all_done,env_id,worker_id&#39;\</span>
<span class="c1">#                            &#39;,action,episode_id,accum_rewards,reward,step,image&#39;.split(&#39;,&#39;)</span>
<span class="c1">#         self.ignore_fields=[]</span>
<span class="c1">#         self.test_field=torch.full((1,5),self.idx)</span>
<span class="c1">#         self.return_fn=return_data</span>
<span class="c1">#         self.loop_history_yield=False</span>
<span class="c1">#         store_attr(but=&#39;cbs&#39;,state=None,next_state=None,done=None,all_done=None,</span>
<span class="c1">#                    env_id=0,action=None,episode_id=0,accum_rewards=0,reward=0,step=0,</span>
<span class="c1">#                    skip_history_return=False)</span>
<span class="c1">#         super().__init__(cbs=cbs,**kwargs)</span>
        
<span class="c1">#     def after_create(self):</span>
<span class="c1">#         self(&#39;initialize&#39;)</span>
<span class="c1">#         return self</span>
    
<span class="c1">#     def _history(self):</span>
<span class="c1">#         self.loop_history_yield=False</span>
<span class="c1">#         self(&#39;history&#39;)</span>
<span class="c1">#         if self.test_mode: </span>
<span class="c1">#             self.this=torch.full((1,5),self.idx)</span>
<span class="c1">#             if &#39;test_field&#39; not in self.data_fields: self.data_fields.append(&#39;test_field&#39;)</span>
<span class="c1">#         return self.return_fn(dict(source=self,history=self.data()))[&#39;history&#39;]</span>
    
<span class="c1">#     def data(self)-&gt;BD: </span>
<span class="c1">#         return BD({s:(ifnone(getattr(self,s,None),TensorBatch([[0]])) if self.test_mode else getattr(self,s))</span>
<span class="c1">#                 for s in self.data_fields if not in_(s,self.ignore_fields)})</span>
        
<span class="c1">#     def __iter__(self):</span>
<span class="c1">#         self(&#39;before_episodes&#39;)</span>
<span class="c1">#         while True:</span>
<span class="c1">#             self.idx+=1</span>
<span class="c1">#             self(&#39;reset&#39;)</span>
<span class="c1">#             self(&#39;do_action&#39;)</span>
<span class="c1">#             self(&#39;do_step&#39;)</span>
<span class="c1">#             if self.test_mode: self.test_field=torch.full((1,5),self.idx)</span>
<span class="c1">#             self(&#39;do_render&#39;)</span>
<span class="c1">#             self(&#39;before_history&#39;)</span>
<span class="c1">#             if not self.skip_history_return: yield self._history()</span>
<span class="c1">#             while self.loop_history_yield:   yield self._history()</span>
<span class="c1">#             self(&#39;after_history&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So the <a href="/fastrl/data.block.html#Source"><code>Source</code></a> object does a simple loop that returns a dictionary. 
This is going to be similar to what the rest of fastrl will be expecting.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># for x,_ in zip(iter(source),range(10)): print(x)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ReturnHistory" class="doc_header"><code>class</code> <code>ReturnHistory</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L34" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ReturnHistory</code>(<strong><code>enc</code></strong>=<em><code>None</code></em>, <strong><code>dec</code></strong>=<em><code>None</code></em>, <strong><code>split_idx</code></strong>=<em><code>None</code></em>, <strong><code>order</code></strong>=<em><code>None</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>Delegates (<code>__call__</code>,<code>decode</code>,<code>setup</code>) to (<code>encodes</code>,<code>decodes</code>,<code>setups</code>) if <code>split_idx</code> matches</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">%(asctime)s</span><span class="s1">.</span><span class="si">%(msecs)03d</span><span class="s1">] p</span><span class="si">%(process)s</span><span class="s1"> {</span><span class="si">%(filename)s</span><span class="s1">:</span><span class="si">%(lineno)d</span><span class="s1">} </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">datefmt</span><span class="o">=</span><span class="s1">&#39;%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;INFO&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TstCallback" class="doc_header"><code>class</code> <code>TstCallback</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L45" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TstCallback</code>(<strong><code>action_space</code></strong>=<em><code>None</code></em>, <strong><code>constant</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/agent.html#AgentCallback"><code>AgentCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="np_type_cast" class="doc_header"><code>np_type_cast</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L54" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>np_type_cast</code>(<strong><code>a</code></strong>, <strong><code>dtype</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GymLoop" class="doc_header"><code>class</code> <code>GymLoop</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L56" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GymLoop</code>(<strong><code>env_name</code></strong>:<code>str</code>, <strong><code>agent</code></strong>=<em><code>None</code></em>, <strong><code>mode</code></strong>=<em><code>None</code></em>, <strong><code>steps_count</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>steps_delta</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>seed</code></strong>:<code>int</code>=<em><code>None</code></em>, <strong><code>worker_id</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>dtype</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/callback.core.html#LoopCallback"><code>LoopCallback</code></a></p>
</blockquote>
<p>Handles iterating through single openai gym (and varients).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>pybullet build time: Sep 20 2021 20:33:29
/home/fastrl_user/.local/lib/python3.8/site-packages/gym/logger.py:34: UserWarning: <span class="ansi-yellow-fg">WARN: Box bound precision lowered by casting to float32</span>
  warnings.warn(colorize(&#34;%s: %s&#34; % (&#34;WARN&#34;, msg % args), &#34;yellow&#34;))
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> - after_create   : [GymLoop]
Start Setup
   - initialize     : [GymLoop]
End Setup
 - before_episodes: [GymLoop]
Start Episodes
   - reset          : [GymLoop]
   - do_action      : []
   - do_step        : [GymLoop]
   - do_render      : []
   - before_history : [GymLoop]
   - history        : [GymLoop]
   - after_history  : [GymLoop]
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
WalkerBase::__init__
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-5.246545</td>
      <td>-0.834541</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-6.488873</td>
      <td>-1.242329</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-9.831295</td>
      <td>-0.925516</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-10.226918</td>
      <td>-0.395623</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-12.232553</td>
      <td>-0.718702</td>
      <td>11</td>
    </tr>
    <tr>
      <th>5</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-13.175136</td>
      <td>-0.942583</td>
      <td>12</td>
    </tr>
    <tr>
      <th>6</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-19.003386</td>
      <td>-2.261546</td>
      <td>15</td>
    </tr>
    <tr>
      <th>7</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-19.798702</td>
      <td>-0.795317</td>
      <td>16</td>
    </tr>
    <tr>
      <th>8</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-25.215620</td>
      <td>-1.492786</td>
      <td>19</td>
    </tr>
    <tr>
      <th>9</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-26.060734</td>
      <td>-0.845114</td>
      <td>20</td>
    </tr>
    <tr>
      <th>10</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-26.185038</td>
      <td>-0.124305</td>
      <td>21</td>
    </tr>
    <tr>
      <th>11</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-29.419088</td>
      <td>-3.234051</td>
      <td>22</td>
    </tr>
    <tr>
      <th>12</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>1</td>
      <td>-29.419088</td>
      <td>-3.234051</td>
      <td>22</td>
    </tr>
    <tr>
      <th>13</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-6.365284</td>
      <td>-1.451759</td>
      <td>3</td>
    </tr>
    <tr>
      <th>14</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-6.790556</td>
      <td>-0.425273</td>
      <td>4</td>
    </tr>
    <tr>
      <th>15</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-10.006384</td>
      <td>-0.885764</td>
      <td>7</td>
    </tr>
    <tr>
      <th>16</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-12.059158</td>
      <td>-2.052774</td>
      <td>8</td>
    </tr>
    <tr>
      <th>17</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-19.041721</td>
      <td>-2.481894</td>
      <td>11</td>
    </tr>
    <tr>
      <th>18</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-21.718193</td>
      <td>-2.676472</td>
      <td>12</td>
    </tr>
    <tr>
      <th>19</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-25.046354</td>
      <td>0.107420</td>
      <td>15</td>
    </tr>
    <tr>
      <th>20</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-25.383503</td>
      <td>-0.337149</td>
      <td>16</td>
    </tr>
    <tr>
      <th>21</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-26.492157</td>
      <td>-0.148990</td>
      <td>19</td>
    </tr>
    <tr>
      <th>22</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-26.972290</td>
      <td>-0.480133</td>
      <td>20</td>
    </tr>
    <tr>
      <th>23</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-28.413446</td>
      <td>0.314342</td>
      <td>23</td>
    </tr>
    <tr>
      <th>24</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-29.898129</td>
      <td>-1.484682</td>
      <td>24</td>
    </tr>
    <tr>
      <th>25</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-29.898129</td>
      <td>-1.484682</td>
      <td>24</td>
    </tr>
    <tr>
      <th>26</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-33.254826</td>
      <td>-3.356699</td>
      <td>25</td>
    </tr>
    <tr>
      <th>27</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>2</td>
      <td>-33.254826</td>
      <td>-3.356699</td>
      <td>25</td>
    </tr>
    <tr>
      <th>28</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-0.199881</td>
      <td>-0.720443</td>
      <td>3</td>
    </tr>
    <tr>
      <th>29</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-1.751157</td>
      <td>-1.551275</td>
      <td>4</td>
    </tr>
    <tr>
      <th>30</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-4.388593</td>
      <td>-1.580864</td>
      <td>7</td>
    </tr>
    <tr>
      <th>31</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-4.864276</td>
      <td>-0.475684</td>
      <td>8</td>
    </tr>
    <tr>
      <th>32</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-8.717867</td>
      <td>-1.220505</td>
      <td>11</td>
    </tr>
    <tr>
      <th>33</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-10.666442</td>
      <td>-1.948575</td>
      <td>12</td>
    </tr>
    <tr>
      <th>34</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-16.772846</td>
      <td>0.045969</td>
      <td>15</td>
    </tr>
    <tr>
      <th>35</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-16.630890</td>
      <td>0.141956</td>
      <td>16</td>
    </tr>
    <tr>
      <th>36</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-18.609598</td>
      <td>-0.486903</td>
      <td>19</td>
    </tr>
    <tr>
      <th>37</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-22.722624</td>
      <td>-4.113026</td>
      <td>20</td>
    </tr>
    <tr>
      <th>38</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>3</td>
      <td>-22.722624</td>
      <td>-4.113026</td>
      <td>20</td>
    </tr>
    <tr>
      <th>39</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-1.222839</td>
      <td>-2.079054</td>
      <td>3</td>
    </tr>
    <tr>
      <th>40</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-1.444411</td>
      <td>-0.221571</td>
      <td>4</td>
    </tr>
    <tr>
      <th>41</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-6.553443</td>
      <td>-3.019559</td>
      <td>7</td>
    </tr>
    <tr>
      <th>42</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-9.276321</td>
      <td>-2.722878</td>
      <td>8</td>
    </tr>
    <tr>
      <th>43</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-10.573095</td>
      <td>-1.880196</td>
      <td>11</td>
    </tr>
    <tr>
      <th>44</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-12.117062</td>
      <td>-1.543967</td>
      <td>12</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-13.801270</td>
      <td>-1.250449</td>
      <td>15</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-15.393574</td>
      <td>-1.592304</td>
      <td>16</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-19.560415</td>
      <td>-4.077777</td>
      <td>18</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-26.224310</td>
      <td>-6.663894</td>
      <td>19</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>4</td>
      <td>-26.224310</td>
      <td>-6.663894</td>
      <td>19</td>
    </tr>
    <tr>
      <th>50</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-8.501894</td>
      <td>-3.770721</td>
      <td>3</td>
    </tr>
    <tr>
      <th>51</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-10.622575</td>
      <td>-2.120681</td>
      <td>4</td>
    </tr>
    <tr>
      <th>52</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-17.490488</td>
      <td>-2.777277</td>
      <td>7</td>
    </tr>
    <tr>
      <th>53</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-18.718639</td>
      <td>-1.228150</td>
      <td>8</td>
    </tr>
    <tr>
      <th>54</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-24.723728</td>
      <td>-2.483125</td>
      <td>11</td>
    </tr>
    <tr>
      <th>55</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-25.309450</td>
      <td>-0.585723</td>
      <td>12</td>
    </tr>
    <tr>
      <th>56</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-29.776041</td>
      <td>-2.031084</td>
      <td>15</td>
    </tr>
    <tr>
      <th>57</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-30.765507</td>
      <td>-0.989466</td>
      <td>16</td>
    </tr>
    <tr>
      <th>58</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-32.691219</td>
      <td>-0.142280</td>
      <td>18</td>
    </tr>
    <tr>
      <th>59</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-36.486217</td>
      <td>-3.794999</td>
      <td>19</td>
    </tr>
    <tr>
      <th>60</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>5</td>
      <td>-36.486217</td>
      <td>-3.794999</td>
      <td>19</td>
    </tr>
    <tr>
      <th>61</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-3.222947</td>
      <td>-1.539171</td>
      <td>3</td>
    </tr>
    <tr>
      <th>62</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-5.318645</td>
      <td>-2.095698</td>
      <td>4</td>
    </tr>
    <tr>
      <th>63</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-8.767493</td>
      <td>-1.725290</td>
      <td>7</td>
    </tr>
    <tr>
      <th>64</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-8.730830</td>
      <td>0.036663</td>
      <td>8</td>
    </tr>
    <tr>
      <th>65</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-12.946632</td>
      <td>-2.300692</td>
      <td>11</td>
    </tr>
    <tr>
      <th>66</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-15.282846</td>
      <td>-2.336214</td>
      <td>12</td>
    </tr>
    <tr>
      <th>67</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-19.091257</td>
      <td>-0.830302</td>
      <td>15</td>
    </tr>
    <tr>
      <th>68</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-18.894882</td>
      <td>0.196375</td>
      <td>16</td>
    </tr>
    <tr>
      <th>69</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-21.212759</td>
      <td>-1.156133</td>
      <td>18</td>
    </tr>
    <tr>
      <th>70</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-23.641655</td>
      <td>-2.428896</td>
      <td>19</td>
    </tr>
    <tr>
      <th>71</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>6</td>
      <td>-23.641655</td>
      <td>-2.428896</td>
      <td>19</td>
    </tr>
    <tr>
      <th>72</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-4.053820</td>
      <td>-1.442475</td>
      <td>3</td>
    </tr>
    <tr>
      <th>73</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-7.741077</td>
      <td>-3.687257</td>
      <td>4</td>
    </tr>
    <tr>
      <th>74</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-16.141367</td>
      <td>-0.712765</td>
      <td>7</td>
    </tr>
    <tr>
      <th>75</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-16.420643</td>
      <td>-0.279276</td>
      <td>8</td>
    </tr>
    <tr>
      <th>76</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-25.566160</td>
      <td>-1.466947</td>
      <td>11</td>
    </tr>
    <tr>
      <th>77</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-27.457655</td>
      <td>-1.891495</td>
      <td>12</td>
    </tr>
    <tr>
      <th>78</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-34.978195</td>
      <td>-2.633105</td>
      <td>15</td>
    </tr>
    <tr>
      <th>79</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-34.932289</td>
      <td>0.045905</td>
      <td>16</td>
    </tr>
    <tr>
      <th>80</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-36.702728</td>
      <td>-0.916466</td>
      <td>18</td>
    </tr>
    <tr>
      <th>81</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-41.194447</td>
      <td>-4.491718</td>
      <td>19</td>
    </tr>
    <tr>
      <th>82</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>7</td>
      <td>-41.194447</td>
      <td>-4.491718</td>
      <td>19</td>
    </tr>
    <tr>
      <th>83</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-1.778950</td>
      <td>-1.724709</td>
      <td>3</td>
    </tr>
    <tr>
      <th>84</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-4.479325</td>
      <td>-2.700375</td>
      <td>4</td>
    </tr>
    <tr>
      <th>85</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-6.899253</td>
      <td>-1.993687</td>
      <td>7</td>
    </tr>
    <tr>
      <th>86</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-8.978047</td>
      <td>-2.078794</td>
      <td>8</td>
    </tr>
    <tr>
      <th>87</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-13.153445</td>
      <td>-1.969172</td>
      <td>11</td>
    </tr>
    <tr>
      <th>88</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-13.689668</td>
      <td>-0.536222</td>
      <td>12</td>
    </tr>
    <tr>
      <th>89</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-14.728541</td>
      <td>0.161559</td>
      <td>15</td>
    </tr>
    <tr>
      <th>90</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-15.578798</td>
      <td>-0.850257</td>
      <td>16</td>
    </tr>
    <tr>
      <th>91</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-25.189880</td>
      <td>-2.554444</td>
      <td>18</td>
    </tr>
    <tr>
      <th>92</th>
      <td>torch.Size([93, 44])</td>
      <td>torch.Size([93, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([93, 17])</td>
      <td>8</td>
      <td>-32.127380</td>
      <td>-6.937498</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FirstLastTfm" class="doc_header"><code>class</code> <code>FirstLastTfm</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L152" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FirstLastTfm</code>(<strong><code>gamma</code></strong>) :: <code>Transform</code></p>
</blockquote>
<p>Delegates (<code>__call__</code>,<code>decode</code>,<code>setup</code>) to (<code>encodes</code>,<code>decodes</code>,<code>setups</code>) if <code>split_idx</code> matches</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FirstLast" class="doc_header"><code>class</code> <code>FirstLast</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L176" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FirstLast</code>(<strong><code>gamma</code></strong>=<em><code>0.99</code></em>) :: <a href="/fastrl/callback.core.html#LoopCallback"><code>LoopCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> - after_create   : [GymLoop]
Start Setup
   - initialize     : [GymLoop]
End Setup
 - before_episodes: [GymLoop]
Start Episodes
   - reset          : [GymLoop]
   - do_action      : []
   - do_step        : [GymLoop]
   - do_render      : []
   - before_history : [GymLoop]
   - history        : [GymLoop]
   - after_history  : [GymLoop]
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>3</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>3</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>3</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>3</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>3</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
<p>50 rows × 11 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)[[</span><span class="s1">&#39;state_mu&#39;</span><span class="p">,</span><span class="s1">&#39;next_state_mu&#39;</span><span class="p">,</span><span class="s1">&#39;done&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state_mu</th>
      <th>next_state_mu</th>
      <th>done</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000255</td>
      <td>0.053080</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.024760</td>
      <td>0.031514</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.049732</td>
      <td>0.010391</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.026832</td>
      <td>0.037947</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.053080</td>
      <td>0.066066</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.031514</td>
      <td>0.046573</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.010391</td>
      <td>0.027650</td>
      <td>False</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.037947</td>
      <td>0.008882</td>
      <td>False</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.066066</td>
      <td>0.038273</td>
      <td>False</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.046573</td>
      <td>0.067968</td>
      <td>False</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.027650</td>
      <td>0.049953</td>
      <td>False</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.008882</td>
      <td>0.032236</td>
      <td>False</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.038273</td>
      <td>0.014396</td>
      <td>False</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.067968</td>
      <td>-0.003998</td>
      <td>False</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.049953</td>
      <td>0.025052</td>
      <td>False</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.032236</td>
      <td>0.005220</td>
      <td>False</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.014396</td>
      <td>-0.015549</td>
      <td>False</td>
    </tr>
    <tr>
      <th>17</th>
      <td>-0.003998</td>
      <td>-0.037694</td>
      <td>False</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.025052</td>
      <td>-0.012890</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.005220</td>
      <td>0.010679</td>
      <td>False</td>
    </tr>
    <tr>
      <th>20</th>
      <td>-0.015549</td>
      <td>-0.015344</td>
      <td>False</td>
    </tr>
    <tr>
      <th>21</th>
      <td>-0.037694</td>
      <td>-0.042738</td>
      <td>False</td>
    </tr>
    <tr>
      <th>22</th>
      <td>-0.012890</td>
      <td>-0.071931</td>
      <td>False</td>
    </tr>
    <tr>
      <th>23</th>
      <td>0.010679</td>
      <td>-0.103341</td>
      <td>False</td>
    </tr>
    <tr>
      <th>24</th>
      <td>-0.015344</td>
      <td>-0.137355</td>
      <td>False</td>
    </tr>
    <tr>
      <th>25</th>
      <td>-0.042738</td>
      <td>-0.127094</td>
      <td>False</td>
    </tr>
    <tr>
      <th>26</th>
      <td>-0.071931</td>
      <td>-0.166431</td>
      <td>True</td>
    </tr>
    <tr>
      <th>27</th>
      <td>-0.103341</td>
      <td>-0.166431</td>
      <td>True</td>
    </tr>
    <tr>
      <th>28</th>
      <td>-0.137355</td>
      <td>-0.166431</td>
      <td>True</td>
    </tr>
    <tr>
      <th>29</th>
      <td>-0.127094</td>
      <td>-0.166431</td>
      <td>True</td>
    </tr>
    <tr>
      <th>30</th>
      <td>-0.013929</td>
      <td>-0.015047</td>
      <td>False</td>
    </tr>
    <tr>
      <th>31</th>
      <td>-0.038189</td>
      <td>0.008732</td>
      <td>False</td>
    </tr>
    <tr>
      <th>32</th>
      <td>-0.014121</td>
      <td>-0.015756</td>
      <td>False</td>
    </tr>
    <tr>
      <th>33</th>
      <td>-0.038746</td>
      <td>0.008510</td>
      <td>False</td>
    </tr>
    <tr>
      <th>34</th>
      <td>-0.015047</td>
      <td>0.033293</td>
      <td>False</td>
    </tr>
    <tr>
      <th>35</th>
      <td>0.008732</td>
      <td>0.059031</td>
      <td>False</td>
    </tr>
    <tr>
      <th>36</th>
      <td>-0.015756</td>
      <td>0.086163</td>
      <td>False</td>
    </tr>
    <tr>
      <th>37</th>
      <td>0.008510</td>
      <td>0.066445</td>
      <td>False</td>
    </tr>
    <tr>
      <th>38</th>
      <td>0.033293</td>
      <td>0.048188</td>
      <td>False</td>
    </tr>
    <tr>
      <th>39</th>
      <td>0.059031</td>
      <td>0.079312</td>
      <td>False</td>
    </tr>
    <tr>
      <th>40</th>
      <td>0.086163</td>
      <td>0.063783</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41</th>
      <td>0.066445</td>
      <td>0.097331</td>
      <td>False</td>
    </tr>
    <tr>
      <th>42</th>
      <td>0.048188</td>
      <td>0.084853</td>
      <td>False</td>
    </tr>
    <tr>
      <th>43</th>
      <td>0.079312</td>
      <td>0.073827</td>
      <td>False</td>
    </tr>
    <tr>
      <th>44</th>
      <td>0.063783</td>
      <td>0.110673</td>
      <td>False</td>
    </tr>
    <tr>
      <th>45</th>
      <td>0.097331</td>
      <td>0.102341</td>
      <td>False</td>
    </tr>
    <tr>
      <th>46</th>
      <td>0.084853</td>
      <td>0.141375</td>
      <td>False</td>
    </tr>
    <tr>
      <th>47</th>
      <td>0.073827</td>
      <td>0.136207</td>
      <td>True</td>
    </tr>
    <tr>
      <th>48</th>
      <td>0.110673</td>
      <td>0.136207</td>
      <td>True</td>
    </tr>
    <tr>
      <th>49</th>
      <td>0.102341</td>
      <td>0.136207</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/fastrl_user/.local/lib/python3.8/site-packages/gym/logger.py:34: UserWarning: <span class="ansi-yellow-fg">WARN: Box bound precision lowered by casting to float32</span>
  warnings.warn(colorize(&#34;%s: %s&#34; % (&#34;WARN&#34;, msg % args), &#34;yellow&#34;))
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
WalkerBase::__init__
WalkerBase::__init__
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-6.324941</td>
      <td>-1.678391</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-14.086597</td>
      <td>-2.488842</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-21.281883</td>
      <td>-2.852470</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-34.789528</td>
      <td>-4.309023</td>
      <td>12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-36.942932</td>
      <td>-1.501129</td>
      <td>15</td>
    </tr>
    <tr>
      <th>5</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-42.997581</td>
      <td>-0.791601</td>
      <td>18</td>
    </tr>
    <tr>
      <th>6</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-46.293945</td>
      <td>-3.296362</td>
      <td>19</td>
    </tr>
    <tr>
      <th>7</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-2.943001</td>
      <td>-1.372911</td>
      <td>3</td>
    </tr>
    <tr>
      <th>8</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-8.051725</td>
      <td>-2.691116</td>
      <td>6</td>
    </tr>
    <tr>
      <th>9</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-12.802928</td>
      <td>-1.632365</td>
      <td>9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-16.639927</td>
      <td>-2.342954</td>
      <td>12</td>
    </tr>
    <tr>
      <th>11</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-18.446821</td>
      <td>-0.745517</td>
      <td>15</td>
    </tr>
    <tr>
      <th>12</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-23.242567</td>
      <td>-2.994816</td>
      <td>17</td>
    </tr>
    <tr>
      <th>13</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-5.013060</td>
      <td>-0.913915</td>
      <td>3</td>
    </tr>
    <tr>
      <th>14</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-8.373739</td>
      <td>-1.613604</td>
      <td>6</td>
    </tr>
    <tr>
      <th>15</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-12.286534</td>
      <td>-0.782325</td>
      <td>9</td>
    </tr>
    <tr>
      <th>16</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-16.514158</td>
      <td>-2.923113</td>
      <td>12</td>
    </tr>
    <tr>
      <th>17</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-22.618427</td>
      <td>-1.291900</td>
      <td>15</td>
    </tr>
    <tr>
      <th>18</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-30.145002</td>
      <td>-5.194582</td>
      <td>18</td>
    </tr>
    <tr>
      <th>19</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-6.523764</td>
      <td>-3.501801</td>
      <td>3</td>
    </tr>
    <tr>
      <th>20</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-11.423867</td>
      <td>-0.243600</td>
      <td>6</td>
    </tr>
    <tr>
      <th>21</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-17.908451</td>
      <td>-2.349874</td>
      <td>9</td>
    </tr>
    <tr>
      <th>22</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-28.125677</td>
      <td>-0.736742</td>
      <td>12</td>
    </tr>
    <tr>
      <th>23</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-37.265102</td>
      <td>-4.825679</td>
      <td>15</td>
    </tr>
    <tr>
      <th>24</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-45.724197</td>
      <td>-4.092920</td>
      <td>17</td>
    </tr>
    <tr>
      <th>25</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-6.341789</td>
      <td>-3.488683</td>
      <td>3</td>
    </tr>
    <tr>
      <th>26</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-11.426238</td>
      <td>-0.640731</td>
      <td>6</td>
    </tr>
    <tr>
      <th>27</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-17.791025</td>
      <td>-1.472652</td>
      <td>9</td>
    </tr>
    <tr>
      <th>28</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-21.937000</td>
      <td>-2.102126</td>
      <td>12</td>
    </tr>
    <tr>
      <th>29</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-22.893606</td>
      <td>-0.061892</td>
      <td>15</td>
    </tr>
    <tr>
      <th>30</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-26.521639</td>
      <td>0.419428</td>
      <td>18</td>
    </tr>
    <tr>
      <th>31</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-31.894365</td>
      <td>-3.374607</td>
      <td>20</td>
    </tr>
    <tr>
      <th>32</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-0.492160</td>
      <td>-0.541499</td>
      <td>3</td>
    </tr>
    <tr>
      <th>33</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-1.316296</td>
      <td>0.054349</td>
      <td>6</td>
    </tr>
    <tr>
      <th>34</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-7.007789</td>
      <td>-2.219141</td>
      <td>9</td>
    </tr>
    <tr>
      <th>35</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-12.604356</td>
      <td>-3.318995</td>
      <td>12</td>
    </tr>
    <tr>
      <th>36</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-19.623796</td>
      <td>-2.205029</td>
      <td>15</td>
    </tr>
    <tr>
      <th>37</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-27.436338</td>
      <td>-3.464650</td>
      <td>18</td>
    </tr>
    <tr>
      <th>38</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-33.016651</td>
      <td>-5.580314</td>
      <td>19</td>
    </tr>
    <tr>
      <th>39</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-3.341371</td>
      <td>-1.523928</td>
      <td>3</td>
    </tr>
    <tr>
      <th>40</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-9.856960</td>
      <td>-1.121074</td>
      <td>6</td>
    </tr>
    <tr>
      <th>41</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-12.557890</td>
      <td>-0.763400</td>
      <td>9</td>
    </tr>
    <tr>
      <th>42</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-17.938286</td>
      <td>-1.245480</td>
      <td>12</td>
    </tr>
    <tr>
      <th>43</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-25.316242</td>
      <td>-1.663222</td>
      <td>15</td>
    </tr>
    <tr>
      <th>44</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-34.841381</td>
      <td>-3.338167</td>
      <td>18</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-38.208965</td>
      <td>-3.367583</td>
      <td>19</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-4.434434</td>
      <td>-0.737379</td>
      <td>3</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-13.671535</td>
      <td>-4.761226</td>
      <td>6</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-20.830454</td>
      <td>-1.752342</td>
      <td>9</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-23.876583</td>
      <td>-0.088513</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="show_source" class="doc_header"><code>show_source</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L189" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>show_source</code>(<strong><code>src</code></strong>, <strong><code>iters</code></strong>=<em><code>50</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rgb_array&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">show_source</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUAAAADwCAIAAAD+Tyo8AAAKGElEQVR4nO3dzWsd1R/H8bkz9ylpuqmgi2q7sG6EgguxXQuKoOCqd6Eg4p/WpaWLBqVQiqVduCkFdeFCrFYwpebpPszceZ4zv8UXL/mlaZpWzeRz5/1alNBM4IT2zZmHc+Z26rr2AGjymx4AgJdHwIAwAgaEETAgrDuZTJoeA4CXxAwMCCNgQBgBA8IIGBBGwIAwAgaEETAgjIABYQQMCCNgQBgBA8IIGBBGwIAwAgaEETAgjIABYQQMCCNgQBgBA8IIGBBGwIAwAgaEETAgjIABYQQMCCNgQBgBA8IIGBBGwIAwAgaEETAgjIABYQQMCCNgQBgBA8IIGBBGwIAwAgaEETAgjIABYQQMCCNgQBgBA8IIGBBGwIAwAgaEETAgjIABYQQMCCNgQBgBA8IIGBBGwIAwAgaEETAgjIABYQQMCCNgQBgBA8IIGBBGwIAwAgaEETAgjIABYQQMCCNgQBgBA8IIGBBGwIAwAgaEETAgjIABYQQMCCNgQBgBA8IIGBBGwIAwAgaEETAgjIABYQQMCCNgQBgBA8IIGBBGwIAwAgaEETAgjIABYQQMCCNgQBgBA8IIGF6/3y/LsulR4GV0mx4AGjMcDp1zZVmGYRhFUZ7ncRy/+eabTY8LL6AzHo+bHgMaUFWVcy7P87IssyxL0zRN0yzLkiR57733mh4djoqA22g6nXqeV/wtz/Psb2mazufzTz75pOkx4kg4hW6jOI6dc4t6zSLgJEmaHiCOihm4jX755ZdFwIsZOM/zNE0Xd7NGo1Gzg8RRMAO3URRFVVXtC7goiqbHhRdGwG00m82qqirL0urlGZIuTqHbyDl348aNsizruj7wAM6fVbCQo13SNN3d3X306NHZs2efVS+EEHCL7O7u2g3nJEniOH7WYV9++eUxDgr/CNfArdDpdOweVZIkSZLM5/P5fP70YV999VWn03HOHfsA8ZIIePklSVJVld1ntrnXVmt4/3+tOxwO67rudDq+76+srPA0WAIBL7nd3d2qquxBke/7eZ5HUXRgnGVZ+r7veV6n0zn2YeIlcQ285ObzeRRFURQ55+I4zrIsiqIwDD3PGwwGe4+0m9JPnjyp6zoIgl6v19CQ8QIIeMnFcWxXvGmaxnEcRZGto/Q8L8uyH3/88fvvv7cjq6r666+/dnZ27t271+iQ8QJ4DrzkHjx4UBSFcy4IAtswaMuw7Lvnz593zqVp6pyrqur111+fzWbj8TgMwy+++CJN02YHj+fiGnjJzefzoigGg0GSJM65MAz33mQOw9D3/V6vZysrf/vtN4vZ87y6rquqCoKgubHj+Qh4Od29e9c5ZzsWsiyz+1j2N3sPm0wm586dK4rCus3z3P7+s88+c851u10We5xwBLyEbt26Vde1TaF5ntsp9IELJy9cuJAkyWIz8OLUOsuybrfrnJvP52tra8f+G+CoCHjZfPvtt865uq4tWptyn95pNBqNfv755zAM7cGSzc+L75ZlaQ+Tul3+h5xo/PMsmyzLrN5Dzn4vX77866+/2uXxeDwuimLfwXme26KOqqo2NzdfffXV/37geBk8Rlo2ZVlWVXX4tWtd15PJpCiKzc1Na3XfATdv3lxsM+Q+1klGwK1z+fLl7e3tNE0fP35siR64ebAsS9sw7Jz7/fffj32YOBICXjbP3cq7vb09n88fP35sF712/NM/dfv27TzP7bYWV8InFgG3znQ6ffLkiX29t9vRaLQv4zt37hzlhBwNIuAl4Zzr9/tBEKRpesgk/Morr2xtbdnXa2tr169fX19f33vAvp8tisJOs+/fv/8fjBr/FEspl0Ge56urq8PhsCiK2Ww2mUxms9lbb73led7XX3/ted4HH3zw6NGjra2tyWRiPxIEweKprxmNRqdOnZrNZkEQ2E95nnfp0qUkSR4+fPjxxx8f66+EoyFgedvb26urq/1+39ZdTKfTKIrsDc9hGL722mtnzpzZ2dnZ2Ng4yhbfjz76yJZDX7x40TIejUbXrl27cuXKf/+r4IURsLw///xzOBx6nmev2kiSZPGmWNuE9PRke7i33347iqKdnR1m3ZOPu4vywjDMssw5Z6/LsWc/trzZthOtrKyUZblvrdUhJpNJFEUHvnMHJw0By9vZ2bHzZ3th3d4XPtsBVVXt2xhod6rW19cXS6b3TtG7u7tsJFTBKfQy+Oabb+xldFbv4TPt0/eo19fX7cMKn76t9e+PFf8qAtZmW4XKsrx69epzDz4kyMVt5yMejxOC58Cqer3e6upqp9PpdDpBEHz++eeHH/+iNVKvBGZgSbbbvtvt+r6/OHO2F9Z99913+w4mxSVGwHrm83m32w2CwPd92/Fn73y2TflxHP/000+Lg6l3uXEXWk9RFFVV2clzXdd7P+DXMj579uzGxgbptgEBi9nY2LAzZ9u1b6/dsAdIVrL9ubq62vRIcRwIWEwcx/1+3+Zeu/RdrNxYfM2ndbcH18Bifvjhh8FgsC9g2/S3N+AsyzwugFuAGVjMO++8c//+/SAIFgHbGoxFw3Y63fQwcUwIWE8Yhr1eb3ENvC9g276LlmAhh573338/DMM4jpM9bOsC9bYN18Cqrl+/buufn7XymQvgNmAGVvXcfQsHLm/GkiFgVUyw8AhYGg2DgLWNRqM33nhjbW1tOBzapxmhVXiMJG9ra4sXaLQWM7C8Z9XLCXYbMAMvG9ul1PQocEwIeKn4vt/tdjudzqefftr0WHAcOIUWZp/u++GHH3qeFwRBEASDwaDf7zc9LhwfZmBVf/zxR1EUvu+naXru3LmNjQ3f9+0NO0y/7UHASk6fPu2ci+N4Op16nheGob0I2j7ZLEkS2+HQ9DBxfAhYxmAwsE88SpIkjuOiKOq6zvO8ruvxeGwbgMuy5OZzqxCwBnvJhr16Mo7jOI7tY5Cm06nv+7YBmHRbiIA1RFFkm373TsJRFMVxvLKyUtc19bYTAQt4+PChfcLgIuA0TW0S9jwvSRLqbS0CFjAej3u9nnNu8b4r28Rv36XeNiNgAe++++7du3ct4DzP0zTlVjMMAWvY3Ny09280PRCcLKzE0nDlypUD6+X8ueV4J5aYxYtySBceAQPSOIUGhBEwIIyAAWEEDAgjYEAYAQPCCBgQRsCAMAIGhBEwIIyAAWEEDAgjYEAYAQPCCBgQRsCAMAIGhBEwIIyAAWEEDAgjYEAYAQPCCBgQRsCAMAIGhBEwIIyAAWEEDAgjYEAYAQPCCBgQRsCAMAIGhBEwIIyAAWEEDAgjYEAYAQPCCBgQRsCAMAIGhBEwIIyAAWEEDAgjYEAYAQPCCBgQRsCAMAIGhBEwIIyAAWEEDAgjYEAYAQPCCBgQRsCAMAIGhBEwIIyAAWEEDAgjYEAYAQPCCBgQRsCAMAIGhBEwIIyAAWEEDAgjYEAYAQPCCBgQRsCAMAIGhBEwIIyAAWEEDAgjYEDY/wCI60I88SK6NAAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rgb_array&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">show_source</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAGQCAIAAAD9V4nPAAAGlElEQVR4nO3d0U3CUBiAUTEs4Rw4hnPATDCHY8gcjlEfSEwEJSFIL/qd80TahPwvzZfe3LaLaZoeAKDqcfQAADCSEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApC1HDwBF+93m8GO13o6dBBBCuK3P5gH3ydIoAGlCCECaEAKQJoQApAkhAGlCCLd1/gEJe0phOCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBBubrXenjm7321mmwQ4JYQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQApAkhAGlCCECaEAKQJoQwh9V6e+bsfreZbRLgiBACkCaEAKQJIQBpQghAmhACkCaEAKQJIQBpQghAmhACkCaEAKQJIQBpQghAmhACkCaEAKQJIQBpQghAmhACkCaEAKQJIQBpQghAmhACkCaEAKQJIQBpQghAmhDCBRZXGPXPwHlCCECaEAKQthw9ALS8vq+Pjrw87YZMAhy4I4T5nFbwp4PAbIQQxtNCGEgIYSZqB/dJCAFIE0IA0oQQZmJ3KNwnIYTxNBIGEkKYz7fBU0EYazFN0+gZ4M+45sWeb9svu0afN7/WP1cxXEMI4QL3+YZrVzFcw9IoAABAlaVRuIClUfh/LI0CkCaEAKQJIQBpQghAmhACkCaEAKQJIQBpQghAmhACkCaEAKQJIQBpQghAmhACkObrEwCkuSMEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCANCEEIE0IAUgTQgDShBCAtA9QEjtXXDkrzAAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Metrics">Metrics<a class="anchor-link" href="#Metrics"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Reward" class="doc_header"><code>class</code> <code>Reward</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L201" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Reward</code>() :: <code>Metric</code></p>
</blockquote>
<p>Blueprint for defining a metric</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NEpisodes" class="doc_header"><code>class</code> <code>NEpisodes</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L220" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NEpisodes</code>() :: <code>Metric</code></p>
</blockquote>
<p>Blueprint for defining a metric</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fake_gym_learner" class="doc_header"><code>fake_gym_learner</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L238" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fake_gym_learner</code>(<strong><code>source</code></strong>, <strong><code>n</code></strong>=<em><code>1000</code></em>, <strong><code>bs</code></strong>=<em><code>1</code></em>, <strong><code>num_workers</code></strong>=<em><code>0</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">])</span>
<span class="n">learn</span><span class="o">=</span><span class="n">fake_gym_learner</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Could not do one pass in your dataloader, there is something wrong in it
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>train_reward</th>
      <th>train_n_episodes</th>
      <th>valid_loss</th>
      <th>valid_reward</th>
      <th>valid_n_episodes</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.000000</td>
      <td>22.590909</td>
      <td>44</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.000000</td>
      <td>21.279570</td>
      <td>93</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.000000</td>
      <td>21.420000</td>
      <td>136</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.000000</td>
      <td>23.130000</td>
      <td>173</td>
      <td>00:04</td>
    </tr>
  </tbody>
</table>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>argv[0]=
argv[0]=
argv[0]=
argv[0]=
argv[0]=
argv[0]=
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Export">Export<a class="anchor-link" href="#Export"> </a></h2>
</div>
</div>
</div>
</div>
 

