---

title: Data Block Gym


keywords: fastai
sidebar: home_sidebar

summary: "openai gym sources"
description: "openai gym sources"
nb_path: "nbs/05b_data.gym.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/05b_data.gym.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="GymSource">GymSource<a class="anchor-link" href="#GymSource"> </a></h2><blockquote><p>The base iterable used for iterating through environments.</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ReturnHistory" class="doc_header"><code>class</code> <code>ReturnHistory</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L35" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ReturnHistory</code>(<strong><code>enc</code></strong>=<em><code>None</code></em>, <strong><code>dec</code></strong>=<em><code>None</code></em>, <strong><code>split_idx</code></strong>=<em><code>None</code></em>, <strong><code>order</code></strong>=<em><code>None</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>Delegates (<code>__call__</code>,<code>decode</code>,<code>setup</code>) to (<code>encodes</code>,<code>decodes</code>,<code>setups</code>) if <code>split_idx</code> matches</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">%(asctime)s</span><span class="s1">.</span><span class="si">%(msecs)03d</span><span class="s1">] p</span><span class="si">%(process)s</span><span class="s1"> {</span><span class="si">%(filename)s</span><span class="s1">:</span><span class="si">%(lineno)d</span><span class="s1">} </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">datefmt</span><span class="o">=</span><span class="s1">&#39;%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;INFO&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TstCallback" class="doc_header"><code>class</code> <code>TstCallback</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L46" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TstCallback</code>(<strong><code>action_space</code></strong>=<em><code>None</code></em>, <strong><code>constant</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/agent.html#AgentCallback"><code>AgentCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="np_type_cast" class="doc_header"><code>np_type_cast</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L55" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>np_type_cast</code>(<strong><code>a</code></strong>, <strong><code>dtype</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GymLoop" class="doc_header"><code>class</code> <code>GymLoop</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L57" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GymLoop</code>(<strong><code>env_name</code></strong>:<code>str</code>, <strong><code>agent</code></strong>=<em><code>None</code></em>, <strong><code>mode</code></strong>=<em><code>None</code></em>, <strong><code>steps_count</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>steps_delta</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>seed</code></strong>:<code>int</code>=<em><code>None</code></em>, <strong><code>worker_id</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>dtype</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/callback.core.html#LoopCallback"><code>LoopCallback</code></a></p>
</blockquote>
<p>Handles iterating through single openai gym (and varients).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/fastrl_user/.local/lib/python3.8/site-packages/gym/logger.py:34: UserWarning: <span class="ansi-yellow-fg">WARN: Box bound precision lowered by casting to float32</span>
  warnings.warn(colorize(&#34;%s: %s&#34; % (&#34;WARN&#34;, msg % args), &#34;yellow&#34;))
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> - after_create   : [GymLoop]
Start Setup
   - initialize     : [GymLoop]
End Setup
 - before_episodes: [GymLoop]
Start Episodes
   - reset          : [GymLoop]
   - do_action      : []
   - do_step        : [GymLoop]
   - do_render      : []
   - before_history : [GymLoop]
   - history        : [GymLoop]
   - after_history  : [GymLoop]
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
WalkerBase::__init__
argv[0]=
argv[0]=
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-3.089832</td>
      <td>-2.358420</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-4.368107</td>
      <td>-1.278275</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-8.000291</td>
      <td>-1.493488</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-8.746354</td>
      <td>-0.746063</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-15.533927</td>
      <td>-1.302873</td>
      <td>11</td>
    </tr>
    <tr>
      <th>5</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-16.051287</td>
      <td>-0.517360</td>
      <td>12</td>
    </tr>
    <tr>
      <th>6</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-19.893143</td>
      <td>-1.256640</td>
      <td>15</td>
    </tr>
    <tr>
      <th>7</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-21.410906</td>
      <td>-1.517763</td>
      <td>16</td>
    </tr>
    <tr>
      <th>8</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-22.360659</td>
      <td>-1.198734</td>
      <td>18</td>
    </tr>
    <tr>
      <th>9</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-27.534264</td>
      <td>-5.173605</td>
      <td>19</td>
    </tr>
    <tr>
      <th>10</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>1</td>
      <td>-27.534264</td>
      <td>-5.173605</td>
      <td>19</td>
    </tr>
    <tr>
      <th>11</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-6.274433</td>
      <td>-1.172317</td>
      <td>3</td>
    </tr>
    <tr>
      <th>12</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-6.918247</td>
      <td>-0.643814</td>
      <td>4</td>
    </tr>
    <tr>
      <th>13</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-12.898165</td>
      <td>-1.398428</td>
      <td>7</td>
    </tr>
    <tr>
      <th>14</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-14.184212</td>
      <td>-1.286047</td>
      <td>8</td>
    </tr>
    <tr>
      <th>15</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-18.953211</td>
      <td>-1.110360</td>
      <td>11</td>
    </tr>
    <tr>
      <th>16</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-19.691582</td>
      <td>-0.738371</td>
      <td>12</td>
    </tr>
    <tr>
      <th>17</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-27.890228</td>
      <td>-3.090909</td>
      <td>15</td>
    </tr>
    <tr>
      <th>18</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-33.475800</td>
      <td>-5.585571</td>
      <td>16</td>
    </tr>
    <tr>
      <th>19</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-35.423695</td>
      <td>-1.947894</td>
      <td>17</td>
    </tr>
    <tr>
      <th>20</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-40.324757</td>
      <td>-4.901062</td>
      <td>18</td>
    </tr>
    <tr>
      <th>21</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>2</td>
      <td>-40.324757</td>
      <td>-4.901062</td>
      <td>18</td>
    </tr>
    <tr>
      <th>22</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-2.696233</td>
      <td>0.024520</td>
      <td>3</td>
    </tr>
    <tr>
      <th>23</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-2.401127</td>
      <td>0.295106</td>
      <td>4</td>
    </tr>
    <tr>
      <th>24</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-5.440200</td>
      <td>-1.055718</td>
      <td>7</td>
    </tr>
    <tr>
      <th>25</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-6.957653</td>
      <td>-1.517453</td>
      <td>8</td>
    </tr>
    <tr>
      <th>26</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-7.493173</td>
      <td>-0.634834</td>
      <td>11</td>
    </tr>
    <tr>
      <th>27</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-7.615790</td>
      <td>-0.122617</td>
      <td>12</td>
    </tr>
    <tr>
      <th>28</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-9.865610</td>
      <td>-2.659924</td>
      <td>15</td>
    </tr>
    <tr>
      <th>29</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-10.131578</td>
      <td>-0.265968</td>
      <td>16</td>
    </tr>
    <tr>
      <th>30</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-10.813209</td>
      <td>-0.321005</td>
      <td>18</td>
    </tr>
    <tr>
      <th>31</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-14.393781</td>
      <td>-3.580572</td>
      <td>19</td>
    </tr>
    <tr>
      <th>32</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>3</td>
      <td>-14.393781</td>
      <td>-3.580572</td>
      <td>19</td>
    </tr>
    <tr>
      <th>33</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-1.357147</td>
      <td>-0.818737</td>
      <td>3</td>
    </tr>
    <tr>
      <th>34</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-1.639056</td>
      <td>-0.281909</td>
      <td>4</td>
    </tr>
    <tr>
      <th>35</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-3.046650</td>
      <td>-1.255088</td>
      <td>7</td>
    </tr>
    <tr>
      <th>36</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-5.975330</td>
      <td>-2.928680</td>
      <td>8</td>
    </tr>
    <tr>
      <th>37</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-8.712991</td>
      <td>-0.936440</td>
      <td>11</td>
    </tr>
    <tr>
      <th>38</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-9.693848</td>
      <td>-0.980857</td>
      <td>12</td>
    </tr>
    <tr>
      <th>39</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-20.624449</td>
      <td>-6.425259</td>
      <td>15</td>
    </tr>
    <tr>
      <th>40</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-20.247175</td>
      <td>0.377274</td>
      <td>16</td>
    </tr>
    <tr>
      <th>41</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-25.597267</td>
      <td>-0.569221</td>
      <td>19</td>
    </tr>
    <tr>
      <th>42</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-27.606960</td>
      <td>-2.009694</td>
      <td>20</td>
    </tr>
    <tr>
      <th>43</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-27.606960</td>
      <td>-2.009694</td>
      <td>20</td>
    </tr>
    <tr>
      <th>44</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-31.539885</td>
      <td>-3.932925</td>
      <td>21</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>4</td>
      <td>-31.539885</td>
      <td>-3.932925</td>
      <td>21</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-2.570260</td>
      <td>-0.060869</td>
      <td>3</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-5.152380</td>
      <td>-2.582121</td>
      <td>4</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-9.116136</td>
      <td>-2.136825</td>
      <td>7</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-11.038633</td>
      <td>-1.922498</td>
      <td>8</td>
    </tr>
    <tr>
      <th>50</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-19.591717</td>
      <td>-1.173415</td>
      <td>11</td>
    </tr>
    <tr>
      <th>51</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-19.863321</td>
      <td>-0.271605</td>
      <td>12</td>
    </tr>
    <tr>
      <th>52</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-24.063721</td>
      <td>0.173043</td>
      <td>15</td>
    </tr>
    <tr>
      <th>53</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-24.582541</td>
      <td>-0.518821</td>
      <td>16</td>
    </tr>
    <tr>
      <th>54</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-24.251974</td>
      <td>0.330566</td>
      <td>17</td>
    </tr>
    <tr>
      <th>55</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-28.300415</td>
      <td>-4.048440</td>
      <td>18</td>
    </tr>
    <tr>
      <th>56</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>5</td>
      <td>-28.300415</td>
      <td>-4.048440</td>
      <td>18</td>
    </tr>
    <tr>
      <th>57</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-0.498770</td>
      <td>-0.056230</td>
      <td>3</td>
    </tr>
    <tr>
      <th>58</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-0.606897</td>
      <td>-0.108127</td>
      <td>4</td>
    </tr>
    <tr>
      <th>59</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-5.238916</td>
      <td>0.041273</td>
      <td>7</td>
    </tr>
    <tr>
      <th>60</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-6.590807</td>
      <td>-1.351892</td>
      <td>8</td>
    </tr>
    <tr>
      <th>61</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-9.648587</td>
      <td>-2.380083</td>
      <td>11</td>
    </tr>
    <tr>
      <th>62</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-12.502305</td>
      <td>-2.853718</td>
      <td>12</td>
    </tr>
    <tr>
      <th>63</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-14.661769</td>
      <td>0.854922</td>
      <td>15</td>
    </tr>
    <tr>
      <th>64</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-15.531202</td>
      <td>-0.869433</td>
      <td>16</td>
    </tr>
    <tr>
      <th>65</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-17.462782</td>
      <td>-1.010137</td>
      <td>18</td>
    </tr>
    <tr>
      <th>66</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-20.446823</td>
      <td>-2.984042</td>
      <td>19</td>
    </tr>
    <tr>
      <th>67</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>6</td>
      <td>-20.446823</td>
      <td>-2.984042</td>
      <td>19</td>
    </tr>
    <tr>
      <th>68</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-1.709766</td>
      <td>-0.946156</td>
      <td>3</td>
    </tr>
    <tr>
      <th>69</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-3.111373</td>
      <td>-1.401607</td>
      <td>4</td>
    </tr>
    <tr>
      <th>70</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-5.249517</td>
      <td>-0.694016</td>
      <td>7</td>
    </tr>
    <tr>
      <th>71</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-6.732227</td>
      <td>-1.482710</td>
      <td>8</td>
    </tr>
    <tr>
      <th>72</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-9.821471</td>
      <td>-2.100056</td>
      <td>11</td>
    </tr>
    <tr>
      <th>73</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-11.405884</td>
      <td>-1.584412</td>
      <td>12</td>
    </tr>
    <tr>
      <th>74</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-14.398535</td>
      <td>-1.869193</td>
      <td>15</td>
    </tr>
    <tr>
      <th>75</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-16.225321</td>
      <td>-1.826787</td>
      <td>16</td>
    </tr>
    <tr>
      <th>76</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-16.847931</td>
      <td>-0.622610</td>
      <td>17</td>
    </tr>
    <tr>
      <th>77</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-21.262205</td>
      <td>-4.414275</td>
      <td>18</td>
    </tr>
    <tr>
      <th>78</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>7</td>
      <td>-21.262205</td>
      <td>-4.414275</td>
      <td>18</td>
    </tr>
    <tr>
      <th>79</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-3.557804</td>
      <td>-2.514810</td>
      <td>3</td>
    </tr>
    <tr>
      <th>80</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-5.125158</td>
      <td>-1.567355</td>
      <td>4</td>
    </tr>
    <tr>
      <th>81</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-7.844525</td>
      <td>-0.609936</td>
      <td>7</td>
    </tr>
    <tr>
      <th>82</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-11.749475</td>
      <td>-3.904950</td>
      <td>8</td>
    </tr>
    <tr>
      <th>83</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-24.837818</td>
      <td>-4.652187</td>
      <td>11</td>
    </tr>
    <tr>
      <th>84</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-25.418077</td>
      <td>-0.580259</td>
      <td>12</td>
    </tr>
    <tr>
      <th>85</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-31.728649</td>
      <td>-6.310571</td>
      <td>13</td>
    </tr>
    <tr>
      <th>86</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-38.340580</td>
      <td>-6.611929</td>
      <td>14</td>
    </tr>
    <tr>
      <th>87</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>8</td>
      <td>-38.340580</td>
      <td>-6.611929</td>
      <td>14</td>
    </tr>
    <tr>
      <th>88</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>9</td>
      <td>0.250074</td>
      <td>0.480594</td>
      <td>3</td>
    </tr>
    <tr>
      <th>89</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>9</td>
      <td>-2.159364</td>
      <td>-2.409438</td>
      <td>4</td>
    </tr>
    <tr>
      <th>90</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>9</td>
      <td>-4.740693</td>
      <td>-1.063553</td>
      <td>7</td>
    </tr>
    <tr>
      <th>91</th>
      <td>torch.Size([92, 44])</td>
      <td>torch.Size([92, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([92, 17])</td>
      <td>9</td>
      <td>-8.868380</td>
      <td>-4.127687</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FirstLastTfm" class="doc_header"><code>class</code> <code>FirstLastTfm</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L153" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FirstLastTfm</code>(<strong><code>gamma</code></strong>) :: <code>Transform</code></p>
</blockquote>
<p>Delegates (<code>__call__</code>,<code>decode</code>,<code>setup</code>) to (<code>encodes</code>,<code>decodes</code>,<code>setups</code>) if <code>split_idx</code> matches</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FirstLast" class="doc_header"><code>class</code> <code>FirstLast</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L177" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FirstLast</code>(<strong><code>gamma</code></strong>=<em><code>0.99</code></em>) :: <a href="/fastrl/callback.core.html#LoopCallback"><code>LoopCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> - after_create   : [GymLoop]
Start Setup
   - initialize     : [GymLoop]
End Setup
 - before_episodes: [GymLoop]
Start Episodes
   - reset          : [GymLoop]
   - do_action      : []
   - do_step        : [GymLoop]
   - do_render      : []
   - before_history : [GymLoop]
   - history        : [GymLoop]
   - after_history  : [GymLoop]
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>10</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>3</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>3</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>3</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>1.0</td>
      <td>3</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>50 rows × 11 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)[[</span><span class="s1">&#39;state_mu&#39;</span><span class="p">,</span><span class="s1">&#39;next_state_mu&#39;</span><span class="p">,</span><span class="s1">&#39;done&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state_mu</th>
      <th>next_state_mu</th>
      <th>done</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.012494</td>
      <td>-0.063496</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.011205</td>
      <td>-0.089783</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.013439</td>
      <td>-0.068755</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.038195</td>
      <td>-0.097350</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.063496</td>
      <td>-0.078846</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.089783</td>
      <td>-0.109810</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-0.068755</td>
      <td>-0.094073</td>
      <td>False</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-0.097350</td>
      <td>-0.127512</td>
      <td>False</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-0.078846</td>
      <td>-0.162525</td>
      <td>False</td>
    </tr>
    <tr>
      <th>9</th>
      <td>-0.109810</td>
      <td>-0.199519</td>
      <td>False</td>
    </tr>
    <tr>
      <th>10</th>
      <td>-0.094073</td>
      <td>-0.238876</td>
      <td>False</td>
    </tr>
    <tr>
      <th>11</th>
      <td>-0.127512</td>
      <td>-0.280936</td>
      <td>True</td>
    </tr>
    <tr>
      <th>12</th>
      <td>-0.162525</td>
      <td>-0.280936</td>
      <td>True</td>
    </tr>
    <tr>
      <th>13</th>
      <td>-0.199519</td>
      <td>-0.280936</td>
      <td>True</td>
    </tr>
    <tr>
      <th>14</th>
      <td>-0.238876</td>
      <td>-0.280936</td>
      <td>True</td>
    </tr>
    <tr>
      <th>15</th>
      <td>-0.001565</td>
      <td>-0.009402</td>
      <td>False</td>
    </tr>
    <tr>
      <th>16</th>
      <td>-0.026998</td>
      <td>-0.036518</td>
      <td>False</td>
    </tr>
    <tr>
      <th>17</th>
      <td>-0.052890</td>
      <td>-0.064168</td>
      <td>False</td>
    </tr>
    <tr>
      <th>18</th>
      <td>-0.030940</td>
      <td>-0.092789</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19</th>
      <td>-0.009402</td>
      <td>-0.074287</td>
      <td>False</td>
    </tr>
    <tr>
      <th>20</th>
      <td>-0.036518</td>
      <td>-0.105189</td>
      <td>False</td>
    </tr>
    <tr>
      <th>21</th>
      <td>-0.064168</td>
      <td>-0.137553</td>
      <td>False</td>
    </tr>
    <tr>
      <th>22</th>
      <td>-0.092789</td>
      <td>-0.123893</td>
      <td>False</td>
    </tr>
    <tr>
      <th>23</th>
      <td>-0.074287</td>
      <td>-0.112041</td>
      <td>False</td>
    </tr>
    <tr>
      <th>24</th>
      <td>-0.105189</td>
      <td>-0.148645</td>
      <td>False</td>
    </tr>
    <tr>
      <th>25</th>
      <td>-0.137553</td>
      <td>-0.140243</td>
      <td>False</td>
    </tr>
    <tr>
      <th>26</th>
      <td>-0.123893</td>
      <td>-0.133552</td>
      <td>False</td>
    </tr>
    <tr>
      <th>27</th>
      <td>-0.112041</td>
      <td>-0.173735</td>
      <td>True</td>
    </tr>
    <tr>
      <th>28</th>
      <td>-0.148645</td>
      <td>-0.173735</td>
      <td>True</td>
    </tr>
    <tr>
      <th>29</th>
      <td>-0.140243</td>
      <td>-0.173735</td>
      <td>True</td>
    </tr>
    <tr>
      <th>30</th>
      <td>-0.133552</td>
      <td>-0.173735</td>
      <td>True</td>
    </tr>
    <tr>
      <th>31</th>
      <td>0.011219</td>
      <td>0.008016</td>
      <td>False</td>
    </tr>
    <tr>
      <th>32</th>
      <td>-0.013137</td>
      <td>0.030883</td>
      <td>False</td>
    </tr>
    <tr>
      <th>33</th>
      <td>-0.037913</td>
      <td>0.005520</td>
      <td>False</td>
    </tr>
    <tr>
      <th>34</th>
      <td>-0.014775</td>
      <td>0.028869</td>
      <td>False</td>
    </tr>
    <tr>
      <th>35</th>
      <td>0.008016</td>
      <td>0.052715</td>
      <td>False</td>
    </tr>
    <tr>
      <th>36</th>
      <td>0.030883</td>
      <td>0.028725</td>
      <td>False</td>
    </tr>
    <tr>
      <th>37</th>
      <td>0.005520</td>
      <td>0.053907</td>
      <td>False</td>
    </tr>
    <tr>
      <th>38</th>
      <td>0.028869</td>
      <td>0.031255</td>
      <td>False</td>
    </tr>
    <tr>
      <th>39</th>
      <td>0.052715</td>
      <td>0.057787</td>
      <td>False</td>
    </tr>
    <tr>
      <th>40</th>
      <td>0.028725</td>
      <td>0.036553</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41</th>
      <td>0.053907</td>
      <td>0.064480</td>
      <td>False</td>
    </tr>
    <tr>
      <th>42</th>
      <td>0.031255</td>
      <td>0.093408</td>
      <td>False</td>
    </tr>
    <tr>
      <th>43</th>
      <td>0.057787</td>
      <td>0.075241</td>
      <td>False</td>
    </tr>
    <tr>
      <th>44</th>
      <td>0.036553</td>
      <td>0.106511</td>
      <td>False</td>
    </tr>
    <tr>
      <th>45</th>
      <td>0.064480</td>
      <td>0.139272</td>
      <td>False</td>
    </tr>
    <tr>
      <th>46</th>
      <td>0.093408</td>
      <td>0.173944</td>
      <td>False</td>
    </tr>
    <tr>
      <th>47</th>
      <td>0.075241</td>
      <td>0.210922</td>
      <td>False</td>
    </tr>
    <tr>
      <th>48</th>
      <td>0.106511</td>
      <td>0.203892</td>
      <td>False</td>
    </tr>
    <tr>
      <th>49</th>
      <td>0.139272</td>
      <td>0.245643</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="kc">None</span> 
<span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">source</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)):</span> 
    <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="n">d</span><span class="o">+=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>             <span class="n">d</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/fastrl_user/.local/lib/python3.8/site-packages/gym/logger.py:34: UserWarning: <span class="ansi-yellow-fg">WARN: Box bound precision lowered by casting to float32</span>
  warnings.warn(colorize(&#34;%s: %s&#34; % (&#34;WARN&#34;, msg % args), &#34;yellow&#34;))
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WalkerBase::__init__
WalkerBase::__init__
WalkerBase::__init__
argv[0]=
argv[0]=
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>next_state</th>
      <th>done</th>
      <th>all_done</th>
      <th>env_id</th>
      <th>worker_id</th>
      <th>action</th>
      <th>episode_id</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>step</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-3.435818</td>
      <td>-3.429926</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-7.840008</td>
      <td>-0.019991</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-14.229498</td>
      <td>-3.741171</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-19.474556</td>
      <td>-1.513067</td>
      <td>12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-23.149738</td>
      <td>-0.190737</td>
      <td>15</td>
    </tr>
    <tr>
      <th>5</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>1</td>
      <td>-33.485909</td>
      <td>-5.419117</td>
      <td>18</td>
    </tr>
    <tr>
      <th>6</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-0.553978</td>
      <td>-0.761920</td>
      <td>3</td>
    </tr>
    <tr>
      <th>7</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-4.210909</td>
      <td>-1.385792</td>
      <td>6</td>
    </tr>
    <tr>
      <th>8</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-11.860973</td>
      <td>-3.308631</td>
      <td>9</td>
    </tr>
    <tr>
      <th>9</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-20.905645</td>
      <td>-5.030979</td>
      <td>12</td>
    </tr>
    <tr>
      <th>10</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-25.460867</td>
      <td>-0.616149</td>
      <td>15</td>
    </tr>
    <tr>
      <th>11</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>2</td>
      <td>-33.970436</td>
      <td>-5.397538</td>
      <td>18</td>
    </tr>
    <tr>
      <th>12</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-4.729514</td>
      <td>-3.773413</td>
      <td>3</td>
    </tr>
    <tr>
      <th>13</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-13.427462</td>
      <td>-3.940341</td>
      <td>6</td>
    </tr>
    <tr>
      <th>14</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-19.207230</td>
      <td>-1.014214</td>
      <td>9</td>
    </tr>
    <tr>
      <th>15</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-20.277723</td>
      <td>-0.554088</td>
      <td>12</td>
    </tr>
    <tr>
      <th>16</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-28.077419</td>
      <td>-2.919997</td>
      <td>15</td>
    </tr>
    <tr>
      <th>17</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-29.861893</td>
      <td>0.479257</td>
      <td>18</td>
    </tr>
    <tr>
      <th>18</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>3</td>
      <td>-33.037601</td>
      <td>-3.175709</td>
      <td>19</td>
    </tr>
    <tr>
      <th>19</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-2.035873</td>
      <td>-0.998239</td>
      <td>3</td>
    </tr>
    <tr>
      <th>20</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-7.017551</td>
      <td>-1.862046</td>
      <td>6</td>
    </tr>
    <tr>
      <th>21</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-9.667216</td>
      <td>-0.234000</td>
      <td>9</td>
    </tr>
    <tr>
      <th>22</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-13.931494</td>
      <td>-2.293601</td>
      <td>12</td>
    </tr>
    <tr>
      <th>23</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-17.175354</td>
      <td>-0.646930</td>
      <td>15</td>
    </tr>
    <tr>
      <th>24</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-20.685959</td>
      <td>-0.360565</td>
      <td>18</td>
    </tr>
    <tr>
      <th>25</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>4</td>
      <td>-23.334787</td>
      <td>-2.648828</td>
      <td>19</td>
    </tr>
    <tr>
      <th>26</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-2.343917</td>
      <td>-1.235791</td>
      <td>3</td>
    </tr>
    <tr>
      <th>27</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-5.589899</td>
      <td>-0.468723</td>
      <td>6</td>
    </tr>
    <tr>
      <th>28</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-8.541494</td>
      <td>-1.270166</td>
      <td>9</td>
    </tr>
    <tr>
      <th>29</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-20.693571</td>
      <td>-5.240668</td>
      <td>12</td>
    </tr>
    <tr>
      <th>30</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-27.113474</td>
      <td>-2.343254</td>
      <td>15</td>
    </tr>
    <tr>
      <th>31</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-35.040672</td>
      <td>-1.441810</td>
      <td>18</td>
    </tr>
    <tr>
      <th>32</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>5</td>
      <td>-39.034122</td>
      <td>-3.993449</td>
      <td>19</td>
    </tr>
    <tr>
      <th>33</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>0.352356</td>
      <td>-0.086999</td>
      <td>3</td>
    </tr>
    <tr>
      <th>34</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-1.614382</td>
      <td>-0.877904</td>
      <td>6</td>
    </tr>
    <tr>
      <th>35</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-5.006239</td>
      <td>0.188589</td>
      <td>9</td>
    </tr>
    <tr>
      <th>36</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-5.947761</td>
      <td>-0.088865</td>
      <td>12</td>
    </tr>
    <tr>
      <th>37</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-5.574101</td>
      <td>0.039119</td>
      <td>15</td>
    </tr>
    <tr>
      <th>38</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-8.193061</td>
      <td>-0.904208</td>
      <td>18</td>
    </tr>
    <tr>
      <th>39</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-18.676037</td>
      <td>-2.364578</td>
      <td>21</td>
    </tr>
    <tr>
      <th>40</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-22.002083</td>
      <td>-0.772199</td>
      <td>24</td>
    </tr>
    <tr>
      <th>41</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>6</td>
      <td>-28.046558</td>
      <td>-3.776662</td>
      <td>26</td>
    </tr>
    <tr>
      <th>42</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-6.977776</td>
      <td>-1.865139</td>
      <td>3</td>
    </tr>
    <tr>
      <th>43</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-9.789343</td>
      <td>-0.009218</td>
      <td>6</td>
    </tr>
    <tr>
      <th>44</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-13.909476</td>
      <td>-0.433767</td>
      <td>9</td>
    </tr>
    <tr>
      <th>45</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-20.572920</td>
      <td>-2.479402</td>
      <td>12</td>
    </tr>
    <tr>
      <th>46</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-25.009949</td>
      <td>-1.269585</td>
      <td>15</td>
    </tr>
    <tr>
      <th>47</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-29.242903</td>
      <td>-0.304018</td>
      <td>18</td>
    </tr>
    <tr>
      <th>48</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>7</td>
      <td>-32.993790</td>
      <td>-3.750888</td>
      <td>19</td>
    </tr>
    <tr>
      <th>49</th>
      <td>torch.Size([50, 44])</td>
      <td>torch.Size([50, 44])</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>0</td>
      <td>torch.Size([50, 17])</td>
      <td>8</td>
      <td>-5.475656</td>
      <td>-1.844290</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="show_source" class="doc_header"><code>show_source</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L190" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>show_source</code>(<strong><code>src</code></strong>, <strong><code>iters</code></strong>=<em><code>50</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;HumanoidPyBulletEnv-v0&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rgb_array&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">show_source</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rgb_array&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">show_source</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ResReduce" class="doc_header"><code>class</code> <code>ResReduce</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L202" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ResReduce</code>(<strong><code>reduce_by</code></strong>=<em><code>2</code></em>) :: <a href="/fastrl/callback.core.html#LoopCallback"><code>LoopCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span>
    <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rgb_array&#39;</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span><span class="n">ResReduce</span><span class="p">(</span><span class="n">reduce_by</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>
<span class="p">)</span>
<span class="n">show_source</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAACGCAIAAAAXaFLVAAAB7UlEQVR4nO3YwUkDURRAUSN2pDVN2kgbpg7L0DpSxrgICKJJ5gevE+Wc1ZDZPIbL5+dt5nm+g592v/YA/E/CIiEsEsIiISwSwiIhLBLCIiEsEsIiISwSwiIhLBLCIiEsEsIiISwSwiIhLBLCIiEsEsIiISwSwiIhLBLCIiEsEsIiISwSwiIhLBLCIiEsEsIiISwSwiIhLBLCIiEsEsIiISwSwiIhLBLCIiEsEsIiISwSwiIhLBLCIiEsEsIiISwSwiIhLBLCIiEsEg9rD/D3vO23x4fH6XndSW6ZE4uEsMZ8HFecJywSwiIhrCu5uZ8nLBLCIiEsEsIiIawBlljLCYuEsK5h13CRsEgIi4SwSAiLhLCWsmsYIiwSwiIhrGGWWEsIi4SwSAiLhLAWsWsYJSwSwiIhrDF2DQsJi4SwSAiLhLAus2u4grBICIuEsAbYNSwnLBLCIiGsTzbfOfN2xVFvnLAuezlML4dp7Sn+GGFdsNu9Hh+0NURYJDbzPK89ww05dW16fZ6etvuvv/t68KucWJ+M/tHz9U5xxyIhLBLCIuGORcKJRUJYJIRFQlgkhEVCWCSERUJYJIRFQlgkhEVCWCSERUJYJIRFQlgkhEVCWCSERUJYJIRFQlgkhEVCWCSERUJYJIRFQlgk3gHP3C/zU6zsBAAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Metrics">Metrics<a class="anchor-link" href="#Metrics"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Reward" class="doc_header"><code>class</code> <code>Reward</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L221" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Reward</code>() :: <code>Metric</code></p>
</blockquote>
<p>Blueprint for defining a metric</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NEpisodes" class="doc_header"><code>class</code> <code>NEpisodes</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L240" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NEpisodes</code>() :: <code>Metric</code></p>
</blockquote>
<p>Blueprint for defining a metric</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fake_gym_learner" class="doc_header"><code>fake_gym_learner</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/gym.py#L258" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fake_gym_learner</code>(<strong><code>source</code></strong>, <strong><code>n</code></strong>=<em><code>1000</code></em>, <strong><code>bs</code></strong>=<em><code>1</code></em>, <strong><code>num_workers</code></strong>=<em><code>0</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Source</span><span class="p">(</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymLoop</span><span class="p">(</span><span class="n">env_name</span><span class="o">=</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">),</span><span class="n">FirstLast</span><span class="p">])</span>
<span class="n">learn</span><span class="o">=</span><span class="n">fake_gym_learner</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Could not do one pass in your dataloader, there is something wrong in it
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>train_reward</th>
      <th>train_n_episodes</th>
      <th>valid_loss</th>
      <th>valid_reward</th>
      <th>valid_n_episodes</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.000000</td>
      <td>21.478261</td>
      <td>46</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.000000</td>
      <td>20.787234</td>
      <td>94</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.000000</td>
      <td>20.450000</td>
      <td>142</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.000000</td>
      <td>21.670000</td>
      <td>186</td>
      <td>00:05</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Export">Export<a class="anchor-link" href="#Export"> </a></h2>
</div>
</div>
</div>
</div>
 

