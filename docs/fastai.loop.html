---

title: Loop


keywords: fastai
sidebar: home_sidebar

summary: "fastrl concept of generic loop objects. "
description: "fastrl concept of generic loop objects. "
nb_path: "nbs/02a_fastai.loop.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/02a_fastai.loop.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ideally, a loop can consist of inner loops to have a format:</p>
<div class="highlight"><pre><span></span><span class="n">FitLoop</span>
<span class="n">BatchLoop</span>
<span class="n">ClassicTrain</span>
<span class="n">BatchLoop</span>
<span class="n">StepLoop</span>
<span class="n">ValidStepLoop</span>
</pre></div>
<p>Which might have a structure:</p>
<div class="highlight"><pre><span></span><span class="p">{</span>
<span class="nt">&quot;FitLoop&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="nt">&quot;FitLoop (epoch)&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="nt">&quot;ClassicTrain (train)&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="nt">&quot;BatchLoop (batches)&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="nt">&quot;StepLoop (pred)&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="nt">&quot;StepLoop (loss)&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="nt">&quot;StepLoop (backward)&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="nt">&quot;StepLoop (step)&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="nt">&quot;StepLoop (zero_grad)&quot;</span><span class="p">:</span> <span class="p">[]</span>
            <span class="p">]</span>
        <span class="p">],</span>
        <span class="nt">&quot;ClassicTrain (valid)&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="nt">&quot;BatchLoop (batches)&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="nt">&quot;ValidStepLoop (pred)&quot;</span><span class="p">:</span> <span class="p">[],</span>
                <span class="nt">&quot;ValidStepLoop (loss)&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="p">]</span>
        <span class="p">]</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="map_obj_attr2func_attr" class="doc_header"><code>map_obj_attr2func_attr</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/loop.py#L306" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>map_obj_attr2func_attr</code>(<strong><code>obj</code></strong>, <strong><code>fn</code></strong>)</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>obj</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>fn</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">OuterCallback</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">before_iteration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">loss</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">dict</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span><span class="n">that</span><span class="o">=</span><span class="nb">str</span><span class="p">):</span><span class="k">pass</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">A</span><span class="p">():</span>
    <span class="n">loss</span><span class="o">=</span><span class="mf">0.5</span>
    
<span class="n">a</span><span class="o">=</span><span class="n">A</span><span class="p">()</span>
    
<span class="n">map_obj_attr2func_attr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">OuterCallback</span><span class="o">.</span><span class="n">before_iteration</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;loss&#39;: 0.5}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="isevent" class="doc_header"><code>isevent</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/loop.py#L43" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>isevent</code>(<strong><code>o</code></strong>)</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>o</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EventException" class="doc_header"><code>class</code> <code>EventException</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/loop.py#L44" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EventException</code>() :: <code>Exception</code></p>
</blockquote>
<p>Common base class for all non-exit exceptions.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="grab_parent_event" class="doc_header"><code>grab_parent_event</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/loop.py#L46" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>grab_parent_event</code>(<strong><code>o</code></strong>)</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>o</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="KwargSetAttr" class="doc_header"><code>class</code> <code>KwargSetAttr</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/loop.py#L48" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>KwargSetAttr</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Events" class="doc_header"><code>class</code> <code>Events</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/loop.py#L53" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Events</code>(<strong><code>items</code></strong>=<em><code>None</code></em>, <strong>*<code>rest</code></strong>, <strong><code>use_list</code></strong>=<em><code>False</code></em>, <strong><code>match</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/fastai.loop.html#KwargSetAttr"><code>KwargSetAttr</code></a></p>
</blockquote>
<p>Behaves like a list of <code>items</code> but can also index with list of indices or masks</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>items</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>postfix</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>prefix</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>item_iter_hint</code></strong> : <em><code>&lt;class 'str'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>order</code></strong> : <em><code>&lt;class 'int'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>parent_event</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>args</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>kwargs</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Event" class="doc_header"><code>class</code> <code>Event</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/loop.py#L75" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Event</code>(<strong><code>function</code></strong>:<code>Callable</code>, <strong><code>loop</code></strong>=<em><code>None</code></em>, <strong><code>override_name</code></strong>=<em><code>None</code></em>, <strong><code>override_qualname</code></strong>=<em><code>None</code></em>, <strong><code>override_module</code></strong>=<em><code>None</code></em>, <strong><code>order</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/fastai.loop.html#KwargSetAttr"><code>KwargSetAttr</code></a></p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>function</code></strong> : <em><code>typing.Callable</code></em></p>
</li>
<li><p><strong><code>loop</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>override_name</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>override_qualname</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>override_module</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>order</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Loops" class="doc_header"><code>class</code> <code>Loops</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/loop.py#L168" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Loops</code>(<strong><code>items</code></strong>=<em><code>None</code></em>, <strong>*<code>rest</code></strong>, <strong><code>use_list</code></strong>=<em><code>False</code></em>, <strong><code>match</code></strong>=<em><code>None</code></em>) :: <code>L</code></p>
</blockquote>
<p>Behaves like a list of <code>items</code> but can also index with list of indices or masks</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>items</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>rest</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>use_list</code></strong> : <em><code>&lt;class 'bool'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>match</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Loop" class="doc_header"><code>class</code> <code>Loop</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/loop.py#L172" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Loop</code>(<strong><code>cbs</code></strong>:<code>L</code>=<em><code>None</code></em>, <strong><code>verbose</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>cbs</code></strong> : <em><code>&lt;class 'fastcore.foundation.L'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>verbose</code></strong> : <em><code>&lt;class 'bool'&gt;</code></em>, <em>optional</em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@events</span>
<span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="n">Loop</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">on_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;on_step&#39;</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check that we can re-initialize <code>A</code> and that the <code>Event</code>s also reinitialize.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="n">A</span><span class="p">()</span>
<span class="n">other_a</span><span class="o">=</span><span class="n">A</span><span class="p">()</span>
<span class="n">test_ne</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">on_step</span><span class="p">),</span><span class="nb">id</span><span class="p">(</span><span class="n">other_a</span><span class="o">.</span><span class="n">on_step</span><span class="p">))</span>
<span class="n">test_eq_type</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">on_step</span><span class="o">.</span><span class="n">loop</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
<span class="n">a_copy</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">test_eq_type</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">on_step</span><span class="o">.</span><span class="n">loop</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@events</span>
<span class="k">class</span> <span class="nc">Outer</span><span class="p">(</span><span class="n">Loop</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">before_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;before_step&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>     <span class="p">:</span>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;on_step&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">after_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="p">:</span>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;after_step&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">failed_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;failed_step&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">finally_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;finally_step&#39;</span><span class="p">)</span>
 
    <span class="k">def</span> <span class="nf">before_jump</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;before_jump&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_jump</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>     <span class="p">:</span>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;on_jump&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">after_jump</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="p">:</span>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;after_jump&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">failed_jump</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;failed_jump&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">finally_jump</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;finally_jump&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Inner</span><span class="p">(</span><span class="n">Loop</span><span class="p">):</span>
    <span class="n">call_on</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">Outer</span><span class="o">.</span><span class="n">on_step</span><span class="p">,</span><span class="n">Outer</span><span class="o">.</span><span class="n">after_step</span><span class="p">,</span><span class="n">Outer</span><span class="o">.</span><span class="n">finally_jump</span><span class="p">)</span>
    
    <span class="nd">@event</span>
    <span class="k">def</span> <span class="nf">before_iteration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;before_iteration&#39;</span><span class="p">)</span>
    <span class="nd">@event</span>
    <span class="k">def</span> <span class="nf">on_iteration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>     <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;on_iteration&#39;</span><span class="p">)</span>
    <span class="nd">@event</span>
    <span class="k">def</span> <span class="nf">after_iteration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;after_iteration&#39;</span><span class="p">)</span>
    <span class="nd">@event</span>
    <span class="k">def</span> <span class="nf">failed_iteration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;failed_iteration&#39;</span><span class="p">)</span>
    <span class="nd">@event</span>
    <span class="k">def</span> <span class="nf">finally_iteration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;finally_iteration&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">FailingInner</span><span class="p">(</span><span class="n">Loop</span><span class="p">):</span>
    <span class="n">call_on</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">Inner</span><span class="o">.</span><span class="n">finally_iteration</span><span class="p">)</span>
    
    <span class="nd">@event</span>
    <span class="k">def</span> <span class="nf">on_force_fail</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>                    
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;on_force_fail&#39;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="run_section" class="doc_header"><code>run_section</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/loop.py#L232" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>run_section</code>(<strong><code>section</code></strong>:<code>Dict</code>[<code>KT</code>, <code>VT</code>])</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>section</code></strong> : <em><code>typing.Dict</code></em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="eq_loops" class="doc_header"><code>eq_loops</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/loop.py#L251" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>eq_loops</code>(<strong><code>a</code></strong>:<a href="/fastrl/fastai.loop.html#Loop"><code>Loop</code></a>, <strong><code>b</code></strong>:<a href="/fastrl/fastai.loop.html#Loop"><code>Loop</code></a>)</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>a</code></strong> : <em><code>&lt;class 'fastrl.fastai.loop.Loop'&gt;</code></em></p>
</li>
<li><p><strong><code>b</code></strong> : <em><code>&lt;class 'fastrl.fastai.loop.Loop'&gt;</code></em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="connect_loops2loop" class="doc_header"><code>connect_loops2loop</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/loop.py#L253" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>connect_loops2loop</code>(<strong><code>loops</code></strong>:<a href="/fastrl/fastai.loop.html#Loops"><code>Loops</code></a>, <strong><code>to_loop</code></strong>)</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>loops</code></strong> : <em><code>&lt;class 'fastrl.fastai.loop.Loops'&gt;</code></em></p>
</li>
<li><p><strong><code>to_loop</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check that a single loop connects to the parent...</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@events</span>
<span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="n">Loop</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">on_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;on_step&#39;</span><span class="p">)</span>
    
<span class="nd">@events</span>
<span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">Loop</span><span class="p">):</span>
    <span class="n">call_on</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">on_step</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_event</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;on_event&#39;</span><span class="p">)</span>
    
<span class="nd">@events</span>
<span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">Loop</span><span class="p">):</span>
    <span class="n">call_on</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">on_event</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_second_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;on_second_step&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check that the parent loop does not reference any non-existant parents. We also
expect it to have 1 section (on_step).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a_instance</span><span class="o">=</span><span class="n">connect_loops2loop</span><span class="p">((</span><span class="n">B</span><span class="p">(),</span><span class="n">C</span><span class="p">()),</span><span class="n">A</span><span class="p">())</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">a_instance</span><span class="o">.</span><span class="n">parent_loop</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">a_instance</span><span class="o">.</span><span class="n">parent_event</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">a_instance</span><span class="o">.</span><span class="n">on_step</span><span class="o">.</span><span class="n">root_loop</span><span class="p">,</span><span class="n">a_instance</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a_instance</span><span class="o">.</span><span class="n">sections</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check that the inner B loop properly references A, as well as the parent event <code>on_step</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b_instance</span><span class="o">=</span><span class="n">a_instance</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="s1">&#39;step&#39;</span><span class="p">][</span><span class="s1">&#39;on_inner&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">test_eq_type</span><span class="p">(</span><span class="n">b_instance</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">b_instance</span><span class="o">.</span><span class="n">parent_loop</span><span class="p">,</span><span class="n">a_instance</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">b_instance</span><span class="o">.</span><span class="n">parent_event</span><span class="p">,</span><span class="n">a_instance</span><span class="o">.</span><span class="n">on_step</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">b_instance</span><span class="o">.</span><span class="n">on_event</span><span class="o">.</span><span class="n">loop</span><span class="p">),</span><span class="nb">id</span><span class="p">(</span><span class="n">b_instance</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">b_instance</span><span class="o">.</span><span class="n">on_event</span><span class="o">.</span><span class="n">loop</span><span class="o">.</span><span class="n">parent_loop</span><span class="p">,</span><span class="n">a_instance</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">b_instance</span><span class="o">.</span><span class="n">on_event</span><span class="o">.</span><span class="n">root_loop</span><span class="p">,</span><span class="n">a_instance</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b_instance</span><span class="o">.</span><span class="n">sections</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check that the inner C loop properly references B, as well as the parent event <code>on_event</code>.
We also should expect the root_loop to still be the a_instance.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c_instance</span><span class="o">=</span><span class="n">b_instance</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="s1">&#39;event&#39;</span><span class="p">][</span><span class="s1">&#39;on_inner&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">test_eq_type</span><span class="p">(</span><span class="n">c_instance</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span><span class="n">C</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">c_instance</span><span class="o">.</span><span class="n">parent_loop</span><span class="p">,</span><span class="n">b_instance</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">c_instance</span><span class="o">.</span><span class="n">parent_event</span><span class="p">,</span><span class="n">b_instance</span><span class="o">.</span><span class="n">on_event</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">c_instance</span><span class="o">.</span><span class="n">on_second_step</span><span class="o">.</span><span class="n">loop</span><span class="p">),</span><span class="nb">id</span><span class="p">(</span><span class="n">c_instance</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">c_instance</span><span class="o">.</span><span class="n">on_second_step</span><span class="o">.</span><span class="n">loop</span><span class="o">.</span><span class="n">parent_loop</span><span class="p">,</span><span class="n">b_instance</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">c_instance</span><span class="o">.</span><span class="n">on_second_step</span><span class="o">.</span><span class="n">root_loop</span><span class="p">,</span><span class="n">a_instance</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_instance</span><span class="o">.</span><span class="n">sections</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sections</span><span class="o">=</span><span class="n">connect_loops2loop</span><span class="p">(</span><span class="n">Loops</span><span class="p">(</span><span class="n">FailingInner</span><span class="p">(),</span><span class="n">Inner</span><span class="p">()),</span><span class="n">Outer</span><span class="p">())</span><span class="o">.</span><span class="n">sections</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="dict2loops" class="doc_header"><code>dict2loops</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/loop.py#L273" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>dict2loops</code>(<strong><code>d</code></strong>)</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>d</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="dict2events" class="doc_header"><code>dict2events</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/loop.py#L284" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>dict2events</code>(<strong><code>d</code></strong>)</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>d</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">dict2events</span><span class="p">(</span><span class="n">sections</span><span class="p">))</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">Self</span><span class="o">.</span><span class="n">climb</span><span class="p">())</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">Self</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;,
 &lt;__main__.Outer at 0x7f9a667d38d0&gt;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CallbackException" class="doc_header"><code>class</code> <code>CallbackException</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/loop.py#L297" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CallbackException</code>() :: <code>Exception</code></p>
</blockquote>
<p>Common base class for all non-exit exceptions.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Callback" class="doc_header"><code>class</code> <code>Callback</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/loop.py#L299" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Callback</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">OuterCallback</span><span class="p">(</span><span class="n">Callback</span><span class="p">):</span>
    <span class="n">call_on</span><span class="o">=</span><span class="n">L</span><span class="p">(</span><span class="n">Outer</span><span class="o">.</span><span class="n">on_step</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">before_iteration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">loss</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">dict</span><span class="p">(</span><span class="n">this</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span><span class="n">that</span><span class="o">=</span><span class="nb">str</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   OuterCallback called lol&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="map_obj_attr2func_attr" class="doc_header"><code>map_obj_attr2func_attr</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/loop.py#L306" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>map_obj_attr2func_attr</code>(<strong><code>obj</code></strong>, <strong><code>fn</code></strong>)</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>obj</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>fn</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">A</span><span class="p">():</span>
    <span class="n">loss</span><span class="o">=</span><span class="mf">0.5</span>
    
<span class="n">a</span><span class="o">=</span><span class="n">A</span><span class="p">()</span>
    
<span class="n">map_obj_attr2func_attr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">OuterCallback</span><span class="o">.</span><span class="n">before_iteration</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;loss&#39;: 0.5}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connect_loops2loop</span><span class="p">(</span><span class="n">Loops</span><span class="p">(</span><span class="n">FailingInner</span><span class="p">(),</span><span class="n">Inner</span><span class="p">()),</span><span class="n">Outer</span><span class="p">(</span><span class="n">cbs</span><span class="o">=</span><span class="n">OuterCallback</span><span class="p">()))</span><span class="o">.</span><span class="n">sections</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;jump&#39;: {&#39;failed_&#39;: __main__.failed_jump,
  &#39;failed_inner&#39;: [],
  &#39;before_&#39;: __main__.before_jump,
  &#39;before_inner&#39;: [],
  &#39;on_&#39;: __main__.on_jump,
  &#39;on_inner&#39;: [],
  &#39;after_&#39;: __main__.after_jump,
  &#39;after_inner&#39;: [],
  &#39;finally_&#39;: __main__.finally_jump,
  &#39;finally_inner&#39;: [&lt;__main__.Inner object at 0x7f9a66748810&gt;]},
 &#39;step&#39;: {&#39;failed_&#39;: __main__.failed_step,
  &#39;failed_inner&#39;: [],
  &#39;before_&#39;: __main__.before_step,
  &#39;before_inner&#39;: [],
  &#39;on_&#39;: __main__.on_step,
  &#39;on_inner&#39;: [&lt;__main__.Inner object at 0x7f9b3d6050d0&gt;],
  &#39;after_&#39;: __main__.after_step,
  &#39;after_inner&#39;: [&lt;__main__.Inner object at 0x7f9a66713bd0&gt;],
  &#39;finally_&#39;: __main__.finally_step,
  &#39;finally_inner&#39;: []}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connect_loops2loop</span><span class="p">(</span><span class="n">Loops</span><span class="p">(</span><span class="n">FailingInner</span><span class="p">(),</span><span class="n">Inner</span><span class="p">()),</span><span class="n">Outer</span><span class="p">())</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="s1">&#39;step&#39;</span><span class="p">][</span><span class="s1">&#39;on_inner&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="s1">&#39;iteration&#39;</span><span class="p">][</span><span class="s1">&#39;before_&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cbs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#0) []</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">connect_loops2loop</span><span class="p">(</span><span class="n">FailingInner</span><span class="p">(),</span><span class="n">Inner</span><span class="p">())</span><span class="o">.</span><span class="n">sections</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;iteration&#39;: {&#39;failed_&#39;: __main__.failed_iteration,
  &#39;failed_inner&#39;: [],
  &#39;before_&#39;: __main__.before_iteration,
  &#39;before_inner&#39;: [],
  &#39;on_&#39;: __main__.on_iteration,
  &#39;on_inner&#39;: [],
  &#39;after_&#39;: __main__.after_iteration,
  &#39;after_inner&#39;: [],
  &#39;finally_&#39;: __main__.finally_iteration,
  &#39;finally_inner&#39;: [&lt;__main__.FailingInner object at 0x7f9a666e7b50&gt;]}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ipy_handle_exception" class="doc_header"><code>ipy_handle_exception</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/loop.py#L320" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ipy_handle_exception</code>(<strong><code>etype</code></strong>, <strong><code>value</code></strong>, <strong><code>tb</code></strong>, <strong><code>tb_offset</code></strong>)</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>etype</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>value</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>tb</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>tb_offset</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="kc">False</span><span class="p">:</span> <span class="n">Outer</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">Inner</span><span class="p">(),</span><span class="n">FailingInner</span><span class="p">()),</span><span class="n">OuterCallback</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="kc">False</span><span class="p">:</span> <span class="n">Outer</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">Inner</span><span class="p">(),</span><span class="n">FailingInner</span><span class="p">()),</span><span class="n">OuterCallback</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">ExceptionExpected</span><span class="p">():</span>
    <span class="n">connect_loops2loop</span><span class="p">(</span><span class="n">Loops</span><span class="p">(</span><span class="n">FailingInner</span><span class="p">(),</span><span class="n">Inner</span><span class="p">()),</span><span class="n">Outer</span><span class="p">(</span><span class="n">cbs</span><span class="o">=</span><span class="n">OuterCallback</span><span class="p">()))</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>before_jump
on_jump
after_jump
finally_jump
before_iteration
on_iteration
after_iteration
finally_iteration
on_force_fail
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

