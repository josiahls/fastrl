---

title: Loading


keywords: fastai
sidebar: home_sidebar

summary: "Objects using the `Loop` and `DataPipe` API for DataLoading"
description: "Objects using the `Loop` and `DataPipe` API for DataLoading"
nb_path: "nbs/02d_fastai.data.load.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/02d_fastai.data.load.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will replicate <a href="https://colab.research.google.com/github/fastai/fastbook/blob/master/04_mnist_basics.ipynb">fastai mnist loading</a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.vision.all</span> <span class="kn">import</span> <span class="n">get_image_files</span><span class="p">,</span><span class="n">PILImage</span><span class="p">,</span><span class="n">ToTensor</span><span class="p">,</span><span class="n">PILBase</span><span class="p">,</span><span class="n">untar_data</span><span class="p">,</span><span class="n">URLs</span><span class="p">,</span><span class="n">get_image_files</span>

<span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_SAMPLE</span><span class="p">)</span>

<span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#2) [Path(&#39;/home/fastrl_user/.fastai/data/mnist_sample/train/7&#39;),Path(&#39;/home/fastrl_user/.fastai/data/mnist_sample/train/3&#39;)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we create the dataset...</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TypeTransformLoop" class="doc_header"><code>class</code> <code>TypeTransformLoop</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/data/load.py#L21" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TypeTransformLoop</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwds</code></strong>) :: <code>MapDataPipe</code></p>
</blockquote>
<p>Map-style DataPipe.</p>
<p>All datasets that represent a map from keys to data samples should subclass this.
Subclasses should overwrite :meth:<code>__getitem__</code>, supporting fetching a
data sample for a given, unique key. Subclasses can also optionally overwrite
:meth:<code>__len__</code>, which is expected to return the size of the dataset by many
:class:<code>~torch.utils.data.Sampler</code> implementations and the default options
of :class:<code>~torch.utils.data.DataLoader</code>.</p>
<p>These DataPipes can be invoked in two ways, using the class constructor or applying their
functional form onto an existing <code>MapDataPipe</code> (recommend, available to most but not all DataPipes).</p>
<p>Note:
    :class:<code>~torch.utils.data.DataLoader</code> by default constructs an index
    sampler that yields integral indices. To make it work with a map-style
    DataPipe with non-integral indices/keys, a custom sampler must be provided.</p>
<p>Example:</p>

<pre><code>&gt;&gt;&gt; from torchdata.datapipes.map import SequenceWrapper, Mapper
&gt;&gt;&gt; dp = SequenceWrapper(range(10))
&gt;&gt;&gt; map_dp_1 = dp.map(lambda x: x + 1)  # Using functional form (recommended)
&gt;&gt;&gt; list(map_dp_1)
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
&gt;&gt;&gt; map_dp_2 = Mapper(dp, lambda x: x + 1)  # Using class constructor
&gt;&gt;&gt; list(map_dp_2)
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
&gt;&gt;&gt; batch_dp = map_dp_1.batch(batch_size=2)
&gt;&gt;&gt; list(batch_dp)
[[1, 2], [3, 4], [5, 6], [7, 8], [9, 10]]</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ItemTransformLoop" class="doc_header"><code>class</code> <code>ItemTransformLoop</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/data/load.py#L31" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ItemTransformLoop</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwds</code></strong>) :: <code>IterDataPipe</code></p>
</blockquote>
<p>Iterable-style DataPipe.</p>
<p>All DataPipes that represent an iterable of data samples should subclass this.
This style of DataPipes is particularly useful when data come from a stream, or
when the number of samples is too large to fit them all in memory. <code>IterDataPipe</code> is lazily initialized and its
elements are computed only when <code>next()</code> is called on the iterator of an <code>IterDataPipe</code>.</p>
<p>All subclasses should overwrite :meth:<code>__iter__</code>, which would return an
iterator of samples in this DataPipe. Calling <code>__iter__</code> of an <code>IterDataPipe</code> automatically invokes its
method <code>reset()</code>, which by default performs no operation. When writing a custom <code>IterDataPipe</code>, users should
override <code>reset()</code> if necessary. The common usages include resetting buffers, pointers,
and various state variables within the custom <code>IterDataPipe</code>.</p>
<p>Note:
    Only <code>one</code> iterator can be valid for each <code>IterDataPipe</code> at a time,
    and the creation a second iterator will invalidate the first one. This constraint is necessary because
    some <code>IterDataPipe</code> have internal buffers, whose states can become invalid if there are multiple iterators.
    The code example below presents details on how this constraint looks in practice.
    If you have any feedback related to this constraint, please see <code>GitHub IterDataPipe Single Iterator Issue</code>_.</p>
<p>These DataPipes can be invoked in two ways, using the class constructor or applying their
functional form onto an existing <code>IterDataPipe</code> (recommended, available to most but not all DataPipes).
You can chain multiple <code>IterDataPipe</code> together to form a pipeline that will perform multiple
operations in succession.</p>
<p>.. _GitHub IterDataPipe Single Iterator Issue:
    <a href="https://github.com/pytorch/data/issues/45">https://github.com/pytorch/data/issues/45</a></p>
<p>Note:
    When a subclass is used with :class:<code>~torch.utils.data.DataLoader</code>, each
    item in the DataPipe will be yielded from the :class:<code>~torch.utils.data.DataLoader</code>
    iterator. When :attr:<code>num_workers &gt; 0</code>, each worker process will have a
    different copy of the DataPipe object, so it is often desired to configure
    each copy independently to avoid having duplicate data returned from the
    workers. :func:<code>~torch.utils.data.get_worker_info</code>, when called in a worker
    process, returns information about the worker. It can be used in either the
    dataset's :meth:<code>__iter__</code> method or the :class:<code>~torch.utils.data.DataLoader</code> 's
    :attr:<code>worker_init_fn</code> option to modify each copy's behavior.</p>
<p>Examples:
    General Usage:</p>

<pre><code>    &gt;&gt;&gt; from torchdata.datapipes.iter import IterableWrapper, Mapper
    &gt;&gt;&gt; dp = IterableWrapper(range(10))
    &gt;&gt;&gt; map_dp_1 = Mapper(dp, lambda x: x + 1)  # Using class constructor
    &gt;&gt;&gt; map_dp_2 = dp.map(lambda x: x + 1)  # Using functional form (recommended)
    &gt;&gt;&gt; list(map_dp_1)
    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
    &gt;&gt;&gt; list(map_dp_2)
    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
    &gt;&gt;&gt; filter_dp = map_dp_1.filter(lambda x: x % 2 == 0)
    &gt;&gt;&gt; list(filter_dp)
    [2, 4, 6, 8, 10]
Single Iterator Constraint Example:
    &gt;&gt;&gt; from torchdata.datapipes.iter import IterableWrapper, Mapper
    &gt;&gt;&gt; dp = IterableWrapper(range(10))
    &gt;&gt;&gt; it1 = iter(source_dp)
    &gt;&gt;&gt; list(it1)
    [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
    &gt;&gt;&gt; it1 = iter(source_dp)
    &gt;&gt;&gt; it2 = iter(source_dp)  # The creation of a new iterator invalidates `it1`
    &gt;&gt;&gt; next(it2)
    0
    &gt;&gt;&gt; next(it1)  # Further usage of `it1` will raise a `RunTimeError`</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BatchTransformLoop" class="doc_header"><code>class</code> <code>BatchTransformLoop</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/data/load.py#L39" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BatchTransformLoop</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwds</code></strong>) :: <code>IterDataPipe</code></p>
</blockquote>
<p>Iterable-style DataPipe.</p>
<p>All DataPipes that represent an iterable of data samples should subclass this.
This style of DataPipes is particularly useful when data come from a stream, or
when the number of samples is too large to fit them all in memory. <code>IterDataPipe</code> is lazily initialized and its
elements are computed only when <code>next()</code> is called on the iterator of an <code>IterDataPipe</code>.</p>
<p>All subclasses should overwrite :meth:<code>__iter__</code>, which would return an
iterator of samples in this DataPipe. Calling <code>__iter__</code> of an <code>IterDataPipe</code> automatically invokes its
method <code>reset()</code>, which by default performs no operation. When writing a custom <code>IterDataPipe</code>, users should
override <code>reset()</code> if necessary. The common usages include resetting buffers, pointers,
and various state variables within the custom <code>IterDataPipe</code>.</p>
<p>Note:
    Only <code>one</code> iterator can be valid for each <code>IterDataPipe</code> at a time,
    and the creation a second iterator will invalidate the first one. This constraint is necessary because
    some <code>IterDataPipe</code> have internal buffers, whose states can become invalid if there are multiple iterators.
    The code example below presents details on how this constraint looks in practice.
    If you have any feedback related to this constraint, please see <code>GitHub IterDataPipe Single Iterator Issue</code>_.</p>
<p>These DataPipes can be invoked in two ways, using the class constructor or applying their
functional form onto an existing <code>IterDataPipe</code> (recommended, available to most but not all DataPipes).
You can chain multiple <code>IterDataPipe</code> together to form a pipeline that will perform multiple
operations in succession.</p>
<p>.. _GitHub IterDataPipe Single Iterator Issue:
    <a href="https://github.com/pytorch/data/issues/45">https://github.com/pytorch/data/issues/45</a></p>
<p>Note:
    When a subclass is used with :class:<code>~torch.utils.data.DataLoader</code>, each
    item in the DataPipe will be yielded from the :class:<code>~torch.utils.data.DataLoader</code>
    iterator. When :attr:<code>num_workers &gt; 0</code>, each worker process will have a
    different copy of the DataPipe object, so it is often desired to configure
    each copy independently to avoid having duplicate data returned from the
    workers. :func:<code>~torch.utils.data.get_worker_info</code>, when called in a worker
    process, returns information about the worker. It can be used in either the
    dataset's :meth:<code>__iter__</code> method or the :class:<code>~torch.utils.data.DataLoader</code> 's
    :attr:<code>worker_init_fn</code> option to modify each copy's behavior.</p>
<p>Examples:
    General Usage:</p>

<pre><code>    &gt;&gt;&gt; from torchdata.datapipes.iter import IterableWrapper, Mapper
    &gt;&gt;&gt; dp = IterableWrapper(range(10))
    &gt;&gt;&gt; map_dp_1 = Mapper(dp, lambda x: x + 1)  # Using class constructor
    &gt;&gt;&gt; map_dp_2 = dp.map(lambda x: x + 1)  # Using functional form (recommended)
    &gt;&gt;&gt; list(map_dp_1)
    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
    &gt;&gt;&gt; list(map_dp_2)
    [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
    &gt;&gt;&gt; filter_dp = map_dp_1.filter(lambda x: x % 2 == 0)
    &gt;&gt;&gt; list(filter_dp)
    [2, 4, 6, 8, 10]
Single Iterator Constraint Example:
    &gt;&gt;&gt; from torchdata.datapipes.iter import IterableWrapper, Mapper
    &gt;&gt;&gt; dp = IterableWrapper(range(10))
    &gt;&gt;&gt; it1 = iter(source_dp)
    &gt;&gt;&gt; list(it1)
    [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
    &gt;&gt;&gt; it1 = iter(source_dp)
    &gt;&gt;&gt; it2 = iter(source_dp)  # The creation of a new iterator invalidates `it1`
    &gt;&gt;&gt; next(it2)
    0
    &gt;&gt;&gt; next(it1)  # Further usage of `it1` will raise a `RunTimeError`</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="default_loader_loop" class="doc_header"><code>default_loader_loop</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/data/load.py#L84" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>default_loader_loop</code>(<strong><code>items</code></strong>:<code>Iterable</code>[<code>+T_co</code>], <strong><code>splitter</code></strong>:<code>typing.Callable</code>, <strong><code>cbs</code></strong>:<code>Optional</code>[<code>List</code>[<a href="/fastrl/pipes.core.html#Callback"><code>Callback</code></a>]]=<em><code>None</code></em>, <strong><code>type_tfms</code></strong>:<code>Optional</code>[<code>Transform</code>]=<em><code>None</code></em>, <strong><code>item_tfms</code></strong>:<code>Optional</code>[<code>Transform</code>]=<em><code>None</code></em>, <strong><code>batch_tfms</code></strong>:<code>Optional</code>[<code>Transform</code>]=<em><code>None</code></em>, <strong><code>bs</code></strong>:<code>int</code>=<em><code>2</code></em>, <strong><code>shuffler</code></strong>:<code>Union</code>[<code>IterDataPipe</code>, <code>MapDataPipe</code>, <code>NoneType</code>]=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="default_loader_loop" class="doc_header"><code>default_loader_loop</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/data/load.py#L84" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>default_loader_loop</code>(<strong><code>items</code></strong>:<code>Iterable</code>[<code>+T_co</code>], <strong><code>splitter</code></strong>:<code>typing.Callable</code>, <strong><code>cbs</code></strong>:<code>Optional</code>[<code>List</code>[<a href="/fastrl/pipes.core.html#Callback"><code>Callback</code></a>]]=<em><code>None</code></em>, <strong><code>type_tfms</code></strong>:<code>Optional</code>[<code>Transform</code>]=<em><code>None</code></em>, <strong><code>item_tfms</code></strong>:<code>Optional</code>[<code>Transform</code>]=<em><code>None</code></em>, <strong><code>batch_tfms</code></strong>:<code>Optional</code>[<code>Transform</code>]=<em><code>None</code></em>, <strong><code>bs</code></strong>:<code>int</code>=<em><code>2</code></em>, <strong><code>shuffler</code></strong>:<code>Union</code>[<code>IterDataPipe</code>, <code>MapDataPipe</code>, <code>NoneType</code>]=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">SayHi</span><span class="p">(</span><span class="n">dp</span><span class="o">.</span><span class="n">iter</span><span class="o">.</span><span class="n">IterDataPipe</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">source_datapipe</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_datapipe</span> <span class="o">=</span> <span class="n">source_datapipe</span>
    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_datapipe</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Hi! From </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">source_datapipe</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_datapipe</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">o</span>

<span class="k">class</span> <span class="nc">SayBye</span><span class="p">(</span><span class="n">dp</span><span class="o">.</span><span class="n">iter</span><span class="o">.</span><span class="n">IterDataPipe</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">source_datapipe</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_datapipe</span> <span class="o">=</span> <span class="n">source_datapipe</span>
    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_datapipe</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SayBye! From </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">source_datapipe</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_datapipe</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">o</span>
        
<span class="k">class</span> <span class="nc">TestCallback</span><span class="p">(</span><span class="n">Callback</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">not_a_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="s1">&#39;this should not be processed as a hook!&#39;</span>
    
    <span class="k">def</span> <span class="nf">add_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">before</span><span class="o">=</span><span class="n">ItemTransformLoop</span><span class="p">,</span><span class="n">after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">not_under</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">dp</span><span class="o">.</span><span class="n">iter</span><span class="o">.</span><span class="n">IterDataPipe</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">L</span><span class="p">(</span><span class="n">SayHi</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">add_point_zero_five</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">after</span><span class="o">=</span><span class="n">dp</span><span class="o">.</span><span class="n">iter</span><span class="o">.</span><span class="n">Batcher</span><span class="p">,</span><span class="n">not_under</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">dp</span><span class="o">.</span><span class="n">iter</span><span class="o">.</span><span class="n">IterDataPipe</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">L</span><span class="p">(</span><span class="n">SayBye</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="GrandparentSplitter" class="doc_header"><code>GrandparentSplitter</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/fastai/data/load.py#L122" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>GrandparentSplitter</code>(<strong><code>train</code></strong>=<em><code>'train'</code></em>, <strong><code>valid</code></strong>=<em><code>'valid'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">base</span> <span class="o">=</span> <span class="n">default_loader_loop</span><span class="p">(</span>
    <span class="n">L</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)),</span>
    <span class="n">GrandparentSplitter</span><span class="p">(),</span>
    <span class="n">type_tfms</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="n">PILImage</span><span class="o">.</span><span class="n">create</span><span class="p">,</span><span class="n">ToTensor</span><span class="p">),</span>
    <span class="n">cbs</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="n">TestCallback</span><span class="p">())</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastrl.fastai.data.pipes.map.demux</span> <span class="kn">import</span> <span class="n">_DemultiplexerMapDataPipe</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">torch.utils.data.graph</span> <span class="kn">import</span> <span class="n">traverse</span>
<span class="n">traverse</span><span class="p">(</span><span class="n">base</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{BatcherIterDataPipe: {ItemTransformLoop: {SayHi: {ShardingFilterIterDataPipe: {MapToIterConverterIterDataPipe: {ShufflerMapDataPipe: {TypeTransformLoop: {_DemultiplexerChildMapDataPipe: {SequenceWrapperMapDataPipe: {}}}}}}}}}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_dl</span><span class="p">,</span><span class="n">valid_dl</span> <span class="o">=</span> <span class="n">DataLoader2</span><span class="p">(</span><span class="n">base</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="n">DataLoader2</span><span class="p">(</span><span class="n">base</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">torchdata.datapipes.utils</span> <span class="kn">import</span> <span class="n">to_graph</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to_graph</span><span class="p">(</span><span class="n">dp</span><span class="o">.</span><span class="n">iter</span><span class="o">.</span><span class="n">Zipper</span><span class="p">(</span><span class="o">*</span><span class="n">base</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="420pt" height="467pt"
 viewBox="0.00 0.00 420.00 467.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 463)">
<title>%3</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-463 416,-463 416,4 -4,4"/>
<!-- TypeTransformLoop&#45;8733156962469 -->
<g id="node1" class="node">
<title>TypeTransformLoop&#45;8733156962469</title>
<polygon fill="#d3d3d3" stroke="#000000" points="368,-404 249,-404 249,-385 368,-385 368,-404"/>
<text text-anchor="middle" x="308.5" y="-392" font-family="monospace" font-size="10.00" fill="#000000">TypeTransformLoop</text>
</g>
<!-- ShufflerMapDataPipe&#45;8733157084273 -->
<g id="node2" class="node">
<title>ShufflerMapDataPipe&#45;8733157084273</title>
<polygon fill="#d3d3d3" stroke="#000000" points="370,-349 239,-349 239,-330 370,-330 370,-349"/>
<text text-anchor="middle" x="304.5" y="-337" font-family="monospace" font-size="10.00" fill="#000000">ShufflerMapDataPipe</text>
</g>
<!-- TypeTransformLoop&#45;8733156962469&#45;&gt;ShufflerMapDataPipe&#45;8733157084273 -->
<g id="edge1" class="edge">
<title>TypeTransformLoop&#45;8733156962469&#45;&gt;ShufflerMapDataPipe&#45;8733157084273</title>
<path fill="none" stroke="#000000" d="M307.8033,-384.9197C307.2933,-377.9083 306.5832,-368.1442 305.952,-359.4652"/>
<polygon fill="#000000" stroke="#000000" points="309.4319,-359.0606 305.2157,-349.3408 302.4504,-359.5684 309.4319,-359.0606"/>
</g>
<!-- MapToIterConverter&#45;8733157084277 -->
<g id="node10" class="node">
<title>MapToIterConverter&#45;8733157084277</title>
<polygon fill="#d3d3d3" stroke="#000000" points="349,-294 224,-294 224,-275 349,-275 349,-294"/>
<text text-anchor="middle" x="286.5" y="-282" font-family="monospace" font-size="10.00" fill="#000000">MapToIterConverter</text>
</g>
<!-- ShufflerMapDataPipe&#45;8733157084273&#45;&gt;MapToIterConverter&#45;8733157084277 -->
<g id="edge6" class="edge">
<title>ShufflerMapDataPipe&#45;8733157084273&#45;&gt;MapToIterConverter&#45;8733157084277</title>
<path fill="none" stroke="#000000" d="M301.3646,-329.9197C299.019,-322.7525 295.732,-312.7089 292.8452,-303.8882"/>
<polygon fill="#000000" stroke="#000000" points="296.1575,-302.7561 289.7206,-294.3408 289.5047,-304.9335 296.1575,-302.7561"/>
</g>
<!-- SayHi&#45;8733157084389 -->
<g id="node3" class="node">
<title>SayHi&#45;8733157084389</title>
<polygon fill="#d3d3d3" stroke="#000000" points="173.5,-184 119.5,-184 119.5,-165 173.5,-165 173.5,-184"/>
<text text-anchor="middle" x="146.5" y="-172" font-family="monospace" font-size="10.00" fill="#000000">SayHi</text>
</g>
<!-- ItemTransformLoop&#45;8733157084345 -->
<g id="node4" class="node">
<title>ItemTransformLoop&#45;8733157084345</title>
<polygon fill="#d3d3d3" stroke="#000000" points="207,-129 88,-129 88,-110 207,-110 207,-129"/>
<text text-anchor="middle" x="147.5" y="-117" font-family="monospace" font-size="10.00" fill="#000000">ItemTransformLoop</text>
</g>
<!-- SayHi&#45;8733157084389&#45;&gt;ItemTransformLoop&#45;8733157084345 -->
<g id="edge2" class="edge">
<title>SayHi&#45;8733157084389&#45;&gt;ItemTransformLoop&#45;8733157084345</title>
<path fill="none" stroke="#000000" d="M146.6742,-164.9197C146.8017,-157.9083 146.9792,-148.1442 147.137,-139.4652"/>
<polygon fill="#000000" stroke="#000000" points="150.6386,-139.4028 147.3211,-129.3408 143.6398,-139.2755 150.6386,-139.4028"/>
</g>
<!-- Batcher&#45;8733157084369 -->
<g id="node11" class="node">
<title>Batcher&#45;8733157084369</title>
<polygon fill="#d3d3d3" stroke="#000000" points="207,-74 148,-74 148,-55 207,-55 207,-74"/>
<text text-anchor="middle" x="177.5" y="-62" font-family="monospace" font-size="10.00" fill="#000000">Batcher</text>
</g>
<!-- ItemTransformLoop&#45;8733157084345&#45;&gt;Batcher&#45;8733157084369 -->
<g id="edge13" class="edge">
<title>ItemTransformLoop&#45;8733157084345&#45;&gt;Batcher&#45;8733157084369</title>
<path fill="none" stroke="#000000" d="M152.7256,-109.9197C156.72,-102.5967 162.3522,-92.2709 167.2374,-83.3147"/>
<polygon fill="#000000" stroke="#000000" points="170.4163,-84.7958 172.1323,-74.3408 164.2711,-81.4438 170.4163,-84.7958"/>
</g>
<!-- MapToIterConverter&#45;8733157084261 -->
<g id="node5" class="node">
<title>MapToIterConverter&#45;8733157084261</title>
<polygon fill="#d3d3d3" stroke="#000000" points="205,-294 80,-294 80,-275 205,-275 205,-294"/>
<text text-anchor="middle" x="142.5" y="-282" font-family="monospace" font-size="10.00" fill="#000000">MapToIterConverter</text>
</g>
<!-- ShardingFilter&#45;8733157084177 -->
<g id="node6" class="node">
<title>ShardingFilter&#45;8733157084177</title>
<polygon fill="#d3d3d3" stroke="#000000" points="196,-239 95,-239 95,-220 196,-220 196,-239"/>
<text text-anchor="middle" x="145.5" y="-227" font-family="monospace" font-size="10.00" fill="#000000">ShardingFilter</text>
</g>
<!-- MapToIterConverter&#45;8733157084261&#45;&gt;ShardingFilter&#45;8733157084177 -->
<g id="edge3" class="edge">
<title>MapToIterConverter&#45;8733157084261&#45;&gt;ShardingFilter&#45;8733157084177</title>
<path fill="none" stroke="#000000" d="M143.0226,-274.9197C143.405,-267.9083 143.9376,-258.1442 144.411,-249.4652"/>
<polygon fill="#000000" stroke="#000000" points="147.9133,-249.5166 144.9632,-239.3408 140.9237,-249.1353 147.9133,-249.5166"/>
</g>
<!-- ShardingFilter&#45;8733157084177&#45;&gt;SayHi&#45;8733157084389 -->
<g id="edge8" class="edge">
<title>ShardingFilter&#45;8733157084177&#45;&gt;SayHi&#45;8733157084389</title>
<path fill="none" stroke="#000000" d="M145.6742,-219.9197C145.8017,-212.9083 145.9792,-203.1442 146.137,-194.4652"/>
<polygon fill="#000000" stroke="#000000" points="149.6386,-194.4028 146.3211,-184.3408 142.6398,-194.2755 149.6386,-194.4028"/>
</g>
<!-- _DemultiplexerChildMapDataPipe&#45;8733157105865 -->
<g id="node7" class="node">
<title>_DemultiplexerChildMapDataPipe&#45;8733157105865</title>
<polygon fill="#add8e6" stroke="#000000" points="412,-459 215,-459 215,-440 412,-440 412,-459"/>
<text text-anchor="middle" x="313.5" y="-447" font-family="monospace" font-size="10.00" fill="#000000">_DemultiplexerChildMapDataPipe</text>
</g>
<!-- _DemultiplexerChildMapDataPipe&#45;8733157105865&#45;&gt;TypeTransformLoop&#45;8733156962469 -->
<g id="edge4" class="edge">
<title>_DemultiplexerChildMapDataPipe&#45;8733157105865&#45;&gt;TypeTransformLoop&#45;8733156962469</title>
<path fill="none" stroke="#000000" d="M312.6291,-439.9197C311.9917,-432.9083 311.104,-423.1442 310.315,-414.4652"/>
<polygon fill="#000000" stroke="#000000" points="313.7857,-413.9829 309.3946,-404.3408 306.8144,-414.6167 313.7857,-413.9829"/>
</g>
<!-- ItemTransformLoop&#45;8733157084333 -->
<g id="node8" class="node">
<title>ItemTransformLoop&#45;8733157084333</title>
<polygon fill="#d3d3d3" stroke="#000000" points="344,-129 225,-129 225,-110 344,-110 344,-129"/>
<text text-anchor="middle" x="284.5" y="-117" font-family="monospace" font-size="10.00" fill="#000000">ItemTransformLoop</text>
</g>
<!-- Batcher&#45;8733157084373 -->
<g id="node9" class="node">
<title>Batcher&#45;8733157084373</title>
<polygon fill="#d3d3d3" stroke="#000000" points="299,-74 240,-74 240,-55 299,-55 299,-74"/>
<text text-anchor="middle" x="269.5" y="-62" font-family="monospace" font-size="10.00" fill="#000000">Batcher</text>
</g>
<!-- ItemTransformLoop&#45;8733157084333&#45;&gt;Batcher&#45;8733157084373 -->
<g id="edge5" class="edge">
<title>ItemTransformLoop&#45;8733157084333&#45;&gt;Batcher&#45;8733157084373</title>
<path fill="none" stroke="#000000" d="M281.8872,-109.9197C279.9538,-102.8304 277.2528,-92.9269 274.8663,-84.1763"/>
<polygon fill="#000000" stroke="#000000" points="278.1918,-83.0675 272.1839,-74.3408 271.4384,-84.9094 278.1918,-83.0675"/>
</g>
<!-- Zipper&#45;8733157044213 -->
<g id="node12" class="node">
<title>Zipper&#45;8733157044213</title>
<polygon fill="#caff70" stroke="#000000" points="242.5,-19 188.5,-19 188.5,0 242.5,0 242.5,-19"/>
<text text-anchor="middle" x="215.5" y="-7" font-family="monospace" font-size="10.00" fill="#000000">Zipper</text>
</g>
<!-- Batcher&#45;8733157084373&#45;&gt;Zipper&#45;8733157044213 -->
<g id="edge10" class="edge">
<title>Batcher&#45;8733157084373&#45;&gt;Zipper&#45;8733157044213</title>
<path fill="none" stroke="#000000" d="M260.0939,-54.9197C252.4451,-47.1293 241.4597,-35.9405 232.3064,-26.6176"/>
<polygon fill="#000000" stroke="#000000" points="234.6653,-24.0244 225.1619,-19.3408 229.6704,-28.9286 234.6653,-24.0244"/>
</g>
<!-- ShardingFilter&#45;8733157084317 -->
<g id="node15" class="node">
<title>ShardingFilter&#45;8733157084317</title>
<polygon fill="#d3d3d3" stroke="#000000" points="335,-239 234,-239 234,-220 335,-220 335,-239"/>
<text text-anchor="middle" x="284.5" y="-227" font-family="monospace" font-size="10.00" fill="#000000">ShardingFilter</text>
</g>
<!-- MapToIterConverter&#45;8733157084277&#45;&gt;ShardingFilter&#45;8733157084317 -->
<g id="edge12" class="edge">
<title>MapToIterConverter&#45;8733157084277&#45;&gt;ShardingFilter&#45;8733157084317</title>
<path fill="none" stroke="#000000" d="M286.1516,-274.9197C285.8967,-267.9083 285.5416,-258.1442 285.226,-249.4652"/>
<polygon fill="#000000" stroke="#000000" points="288.719,-249.207 284.8578,-239.3408 281.7237,-249.4614 288.719,-249.207"/>
</g>
<!-- Batcher&#45;8733157084369&#45;&gt;Zipper&#45;8733157044213 -->
<g id="edge7" class="edge">
<title>Batcher&#45;8733157084369&#45;&gt;Zipper&#45;8733157044213</title>
<path fill="none" stroke="#000000" d="M184.1191,-54.9197C189.2863,-47.4409 196.6174,-36.8301 202.8944,-27.745"/>
<polygon fill="#000000" stroke="#000000" points="205.8961,-29.5577 208.7009,-19.3408 200.137,-25.5786 205.8961,-29.5577"/>
</g>
<!-- ShufflerMapDataPipe&#45;8733157084337 -->
<g id="node13" class="node">
<title>ShufflerMapDataPipe&#45;8733157084337</title>
<polygon fill="#d3d3d3" stroke="#000000" points="205,-349 74,-349 74,-330 205,-330 205,-349"/>
<text text-anchor="middle" x="139.5" y="-337" font-family="monospace" font-size="10.00" fill="#000000">ShufflerMapDataPipe</text>
</g>
<!-- ShufflerMapDataPipe&#45;8733157084337&#45;&gt;MapToIterConverter&#45;8733157084261 -->
<g id="edge9" class="edge">
<title>ShufflerMapDataPipe&#45;8733157084337&#45;&gt;MapToIterConverter&#45;8733157084261</title>
<path fill="none" stroke="#000000" d="M140.0226,-329.9197C140.405,-322.9083 140.9376,-313.1442 141.411,-304.4652"/>
<polygon fill="#000000" stroke="#000000" points="144.9133,-304.5166 141.9632,-294.3408 137.9237,-304.1353 144.9133,-304.5166"/>
</g>
<!-- SayHi&#45;8733157084405 -->
<g id="node14" class="node">
<title>SayHi&#45;8733157084405</title>
<polygon fill="#d3d3d3" stroke="#000000" points="311.5,-184 257.5,-184 257.5,-165 311.5,-165 311.5,-184"/>
<text text-anchor="middle" x="284.5" y="-172" font-family="monospace" font-size="10.00" fill="#000000">SayHi</text>
</g>
<!-- SayHi&#45;8733157084405&#45;&gt;ItemTransformLoop&#45;8733157084333 -->
<g id="edge11" class="edge">
<title>SayHi&#45;8733157084405&#45;&gt;ItemTransformLoop&#45;8733157084333</title>
<path fill="none" stroke="#000000" d="M284.5,-164.9197C284.5,-157.9083 284.5,-148.1442 284.5,-139.4652"/>
<polygon fill="#000000" stroke="#000000" points="288.0001,-139.3408 284.5,-129.3408 281.0001,-139.3409 288.0001,-139.3408"/>
</g>
<!-- ShardingFilter&#45;8733157084317&#45;&gt;SayHi&#45;8733157084405 -->
<g id="edge16" class="edge">
<title>ShardingFilter&#45;8733157084317&#45;&gt;SayHi&#45;8733157084405</title>
<path fill="none" stroke="#000000" d="M284.5,-219.9197C284.5,-212.9083 284.5,-203.1442 284.5,-194.4652"/>
<polygon fill="#000000" stroke="#000000" points="288.0001,-194.3408 284.5,-184.3408 281.0001,-194.3409 288.0001,-194.3408"/>
</g>
<!-- TypeTransformLoop&#45;8733157084241 -->
<g id="node16" class="node">
<title>TypeTransformLoop&#45;8733157084241</title>
<polygon fill="#d3d3d3" stroke="#000000" points="166,-404 47,-404 47,-385 166,-385 166,-404"/>
<text text-anchor="middle" x="106.5" y="-392" font-family="monospace" font-size="10.00" fill="#000000">TypeTransformLoop</text>
</g>
<!-- TypeTransformLoop&#45;8733157084241&#45;&gt;ShufflerMapDataPipe&#45;8733157084337 -->
<g id="edge14" class="edge">
<title>TypeTransformLoop&#45;8733157084241&#45;&gt;ShufflerMapDataPipe&#45;8733157084337</title>
<path fill="none" stroke="#000000" d="M112.2482,-384.9197C116.6887,-377.5188 122.9695,-367.0509 128.3824,-358.0294"/>
<polygon fill="#000000" stroke="#000000" points="131.4517,-359.7165 133.5955,-349.3408 125.4493,-356.115 131.4517,-359.7165"/>
</g>
<!-- _DemultiplexerChildMapDataPipe&#45;8733157103677 -->
<g id="node17" class="node">
<title>_DemultiplexerChildMapDataPipe&#45;8733157103677</title>
<polygon fill="#add8e6" stroke="#000000" points="197,-459 0,-459 0,-440 197,-440 197,-459"/>
<text text-anchor="middle" x="98.5" y="-447" font-family="monospace" font-size="10.00" fill="#000000">_DemultiplexerChildMapDataPipe</text>
</g>
<!-- _DemultiplexerChildMapDataPipe&#45;8733157103677&#45;&gt;TypeTransformLoop&#45;8733157084241 -->
<g id="edge15" class="edge">
<title>_DemultiplexerChildMapDataPipe&#45;8733157103677&#45;&gt;TypeTransformLoop&#45;8733157084241</title>
<path fill="none" stroke="#000000" d="M99.8935,-439.9197C100.9133,-432.9083 102.3336,-423.1442 103.596,-414.4652"/>
<polygon fill="#000000" stroke="#000000" points="107.0927,-414.7405 105.0686,-404.3408 100.1656,-413.7329 107.0927,-414.7405"/>
</g>
</g>
</svg>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mod</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#len(L(path.rglob(&#39;*&#39;)))//10</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_dl</span><span class="p">):</span>
    <span class="c1"># if i%mod==0: print(L(element).map(Self.shape()), f&#39;x{i}&#39;)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">Self</span><span class="o">.</span><span class="n">shape</span><span class="p">()),</span> <span class="sa">f</span><span class="s1">&#39;x</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">:</span> <span class="k">break</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Hi! From ShardingFilterIterDataPipe 139730513349072
Hi! From ShardingFilterIterDataPipe 139730513349072
Hi! From ShardingFilterIterDataPipe 139730513349072
Hi! From ShardingFilterIterDataPipe 139730513349072
[torch.Size([2, 3, 28, 28]), torch.Size([2, 3, 28, 28])] x0
Hi! From ShardingFilterIterDataPipe 139730513349072
Hi! From ShardingFilterIterDataPipe 139730513349072
Hi! From ShardingFilterIterDataPipe 139730513349072
Hi! From ShardingFilterIterDataPipe 139730513349072
[torch.Size([2, 3, 28, 28]), torch.Size([2, 3, 28, 28])] x1
Hi! From ShardingFilterIterDataPipe 139730513349072
Hi! From ShardingFilterIterDataPipe 139730513349072
Hi! From ShardingFilterIterDataPipe 139730513349072
Hi! From ShardingFilterIterDataPipe 139730513349072
[torch.Size([2, 3, 28, 28]), torch.Size([2, 3, 28, 28])] x2
Hi! From ShardingFilterIterDataPipe 139730513349072
Hi! From ShardingFilterIterDataPipe 139730513349072
Hi! From ShardingFilterIterDataPipe 139730513349072
Hi! From ShardingFilterIterDataPipe 139730513349072
[torch.Size([2, 3, 28, 28]), torch.Size([2, 3, 28, 28])] x3
Hi! From ShardingFilterIterDataPipe 139730513349072
Hi! From ShardingFilterIterDataPipe 139730513349072
Hi! From ShardingFilterIterDataPipe 139730513349072
Hi! From ShardingFilterIterDataPipe 139730513349072
[torch.Size([2, 3, 28, 28]), torch.Size([2, 3, 28, 28])] x4
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>


