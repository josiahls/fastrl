---

title: Data Block


keywords: fastai
sidebar: home_sidebar

summary: "Fastrl transforms for iterating through environments"
description: "Fastrl transforms for iterating through environments"
nb_path: "nbs/05a_data.block.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/05a_data.block.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Development of this was helped by <a href="https://github.com/pytorch/pytorch/blob/4949eea0ffb60dc81a0a78402fa59fdf68206718/torch/utils/data/dataset.py#L64">IterableData documentation on multiple workers</a></p>
<p>This code is heavily modifed from <a href="https://github.com/Shmuma/ptan">https://github.com/Shmuma/ptan</a></p>
<p>Reference for env <a href="https://github.com/openai/universe/blob/master/doc/env_semantics.rst">semantics related to vectorized environments</a></p>
<p>Useful links:</p>
<ul>
<li><a href="https://github.com/pytorch/pytorch/blob/a61a8d059efa0fb139a09e479b1a2c8dd1cf1a44/torch/utils/data/dataloader.py#L564">torch multiprocessing</a></li>
<li><a href="https://github.com/pytorch/pytorch/blob/master/torch/utils/data/_utils/worker.py">torch worker</a></li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TstCallback" class="doc_header"><code>class</code> <code>TstCallback</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L29" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TstCallback</code>(<strong><code>action_space</code></strong>=<em><code>None</code></em>, <strong><code>constant</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/agent.html#AgentCallback"><code>AgentCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Main-Loop">Main Loop<a class="anchor-link" href="#Main-Loop"> </a></h2><blockquote><p>Main executable loops</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Src" class="doc_header"><code>class</code> <code>Src</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L60" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Src</code>(<strong><code>env</code></strong>:<code>object</code>, <strong><code>agent</code></strong>=<em><code>None</code></em>, <strong><code>n_envs</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>steps_count</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>steps_delta</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>seed</code></strong>:<code>int</code>=<em><code>None</code></em>, <strong><code>mode</code></strong>=<em><code>None</code></em>, <strong><code>num_workers</code></strong>=<em><code>0</code></em>, <strong><code>but</code></strong>=<em><code>''</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>, <strong><code>shape_map</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/callback.core.html#Loop"><code>Loop</code></a></p>
</blockquote>
<p>Inherit from this to have all attr accesses in <code>self._xtra</code> passed down to <code>self.default</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include note.html content='I wonder if Src really needs to be able to run minimally on its own...' %}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SrcCallback" class="doc_header"><code>class</code> <code>SrcCallback</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L129" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SrcCallback</code>() :: <a href="/fastrl/callback.core.html#LoopCallback"><code>LoopCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GymSrc" class="doc_header"><code>class</code> <code>GymSrc</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L185" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GymSrc</code>() :: <a href="/fastrl/data.block.html#SrcCallback"><code>SrcCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="n">iters</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
    <span class="n">data</span><span class="o">=</span><span class="kc">None</span>
    <span class="k">for</span> <span class="n">exp</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="n">iters</span><span class="p">)):</span>
        <span class="n">data</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span> <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">sum</span><span class="p">([</span><span class="n">data</span><span class="p">,</span><span class="n">exp</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SrcProfiler" class="doc_header"><code>class</code> <code>SrcProfiler</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L296" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SrcProfiler</code>() :: <a href="/fastrl/data.block.html#SrcCallback"><code>SrcCallback</code></a></p>
</blockquote>
<p>Checks time between callbacks.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">profiler</span><span class="o">=</span><span class="n">SrcProfiler</span><span class="p">()</span>

<span class="n">source</span><span class="o">=</span><span class="n">Src</span><span class="p">(</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">n_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymSrc</span><span class="p">,</span><span class="n">profiler</span><span class="p">])</span>
<span class="n">train</span><span class="p">(</span><span class="n">source</span><span class="p">)</span><span class="o">.</span><span class="n">pandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>done</th>
      <th>all_done</th>
      <th>step</th>
      <th>env_id</th>
      <th>p_id</th>
      <th>episode_num</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>state</th>
      <th>next_state</th>
      <th>action</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>2.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>3.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>76</th>
      <td>False</td>
      <td>False</td>
      <td>15.0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>16.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>77</th>
      <td>False</td>
      <td>False</td>
      <td>16.0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>78</th>
      <td>False</td>
      <td>False</td>
      <td>14.0</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>15.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>79</th>
      <td>False</td>
      <td>False</td>
      <td>15.0</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>16.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>80</th>
      <td>False</td>
      <td>False</td>
      <td>16.0</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>81 rows × 11 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">profiler</span><span class="o">=</span><span class="n">SrcProfiler</span><span class="p">()</span>

<span class="n">source</span><span class="o">=</span><span class="n">Src</span><span class="p">(</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">n_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymSrc</span><span class="p">,</span><span class="n">profiler</span><span class="p">])</span>
<span class="n">train</span><span class="p">(</span><span class="n">source</span><span class="p">)</span><span class="o">.</span><span class="n">pandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>done</th>
      <th>all_done</th>
      <th>step</th>
      <th>env_id</th>
      <th>p_id</th>
      <th>episode_num</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>state</th>
      <th>next_state</th>
      <th>action</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>2.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>3.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>76</th>
      <td>False</td>
      <td>False</td>
      <td>11.0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>77</th>
      <td>False</td>
      <td>False</td>
      <td>12.0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>78</th>
      <td>False</td>
      <td>False</td>
      <td>10.0</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>11.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>79</th>
      <td>False</td>
      <td>False</td>
      <td>11.0</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>80</th>
      <td>False</td>
      <td>False</td>
      <td>12.0</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>torch.Size([81, 4])</td>
      <td>torch.Size([81, 4])</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>81 rows × 11 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Src</span><span class="p">(</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">n_envs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="n">GymSrc</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">train</span><span class="p">(</span><span class="n">source</span><span class="p">)</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>done</th>
      <th>all_done</th>
      <th>step</th>
      <th>env_id</th>
      <th>p_id</th>
      <th>episode_num</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>state</th>
      <th>next_state</th>
      <th>action</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>torch.Size([87, 4])</td>
      <td>torch.Size([87, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>torch.Size([87, 4])</td>
      <td>torch.Size([87, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>torch.Size([87, 4])</td>
      <td>torch.Size([87, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>torch.Size([87, 4])</td>
      <td>torch.Size([87, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>torch.Size([87, 4])</td>
      <td>torch.Size([87, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>82</th>
      <td>False</td>
      <td>False</td>
      <td>11.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>torch.Size([87, 4])</td>
      <td>torch.Size([87, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>83</th>
      <td>False</td>
      <td>False</td>
      <td>12.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>torch.Size([87, 4])</td>
      <td>torch.Size([87, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>84</th>
      <td>False</td>
      <td>False</td>
      <td>11.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>torch.Size([87, 4])</td>
      <td>torch.Size([87, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>85</th>
      <td>False</td>
      <td>False</td>
      <td>12.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>torch.Size([87, 4])</td>
      <td>torch.Size([87, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>86</th>
      <td>False</td>
      <td>False</td>
      <td>13.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>14.0</td>
      <td>1.0</td>
      <td>torch.Size([87, 4])</td>
      <td>torch.Size([87, 4])</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>87 rows × 11 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Src</span><span class="p">(</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">n_envs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="n">GymSrc</span><span class="p">)</span>
<span class="n">train</span><span class="p">(</span><span class="n">source</span><span class="p">)</span><span class="o">.</span><span class="n">pandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>done</th>
      <th>all_done</th>
      <th>step</th>
      <th>env_id</th>
      <th>p_id</th>
      <th>episode_num</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>state</th>
      <th>next_state</th>
      <th>action</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>torch.Size([78, 4])</td>
      <td>torch.Size([78, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>torch.Size([78, 4])</td>
      <td>torch.Size([78, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>torch.Size([78, 4])</td>
      <td>torch.Size([78, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>torch.Size([78, 4])</td>
      <td>torch.Size([78, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>7.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>torch.Size([78, 4])</td>
      <td>torch.Size([78, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>73</th>
      <td>False</td>
      <td>False</td>
      <td>15.0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>16.0</td>
      <td>1.0</td>
      <td>torch.Size([78, 4])</td>
      <td>torch.Size([78, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>74</th>
      <td>False</td>
      <td>False</td>
      <td>16.0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>torch.Size([78, 4])</td>
      <td>torch.Size([78, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>75</th>
      <td>False</td>
      <td>False</td>
      <td>18.0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>19.0</td>
      <td>1.0</td>
      <td>torch.Size([78, 4])</td>
      <td>torch.Size([78, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>76</th>
      <td>False</td>
      <td>False</td>
      <td>19.0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>20.0</td>
      <td>1.0</td>
      <td>torch.Size([78, 4])</td>
      <td>torch.Size([78, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>77</th>
      <td>False</td>
      <td>False</td>
      <td>20.0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>21.0</td>
      <td>1.0</td>
      <td>torch.Size([78, 4])</td>
      <td>torch.Size([78, 4])</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>78 rows × 11 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Src</span><span class="p">(</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_envs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="n">GymSrc</span><span class="p">)</span>
<span class="n">train</span><span class="p">(</span><span class="n">source</span><span class="p">)</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>done</th>
      <th>all_done</th>
      <th>step</th>
      <th>env_id</th>
      <th>p_id</th>
      <th>episode_num</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>state</th>
      <th>next_state</th>
      <th>...</th>
      <th>all_done_mu</th>
      <th>step_mu</th>
      <th>env_id_mu</th>
      <th>p_id_mu</th>
      <th>episode_num_mu</th>
      <th>accum_rewards_mu</th>
      <th>reward_mu</th>
      <th>state_mu</th>
      <th>next_state_mu</th>
      <th>action_mu</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>-0.000569</td>
      <td>0.023272</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>-0.015465</td>
      <td>0.009123</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>0.049268</td>
      <td>0.075549</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>4.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>0.035931</td>
      <td>0.062371</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>8.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>0.065819</td>
      <td>0.048836</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>False</td>
      <td>False</td>
      <td>8.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>0.051644</td>
      <td>0.082569</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>False</td>
      <td>False</td>
      <td>12.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>0.048769</td>
      <td>0.081473</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>False</td>
      <td>False</td>
      <td>12.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>0.089533</td>
      <td>0.079185</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>True</td>
      <td>True</td>
      <td>15.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>16.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>1.0</td>
      <td>15.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>16.0</td>
      <td>1.0</td>
      <td>0.108872</td>
      <td>0.102555</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>False</td>
      <td>False</td>
      <td>16.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>16.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>0.089917</td>
      <td>0.078479</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>False</td>
      <td>False</td>
      <td>20.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>21.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>20.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>21.0</td>
      <td>1.0</td>
      <td>0.043667</td>
      <td>0.030513</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>False</td>
      <td>False</td>
      <td>24.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>25.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>24.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>25.0</td>
      <td>1.0</td>
      <td>0.128218</td>
      <td>0.160634</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>False</td>
      <td>False</td>
      <td>28.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>29.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>28.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>29.0</td>
      <td>1.0</td>
      <td>0.214205</td>
      <td>0.202101</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>False</td>
      <td>False</td>
      <td>32.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>33.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>32.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>33.0</td>
      <td>1.0</td>
      <td>0.315347</td>
      <td>0.310097</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>True</td>
      <td>True</td>
      <td>33.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>34.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>1.0</td>
      <td>33.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>34.0</td>
      <td>1.0</td>
      <td>0.310097</td>
      <td>0.307177</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.034925</td>
      <td>0.014803</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>-0.004601</td>
      <td>-0.027803</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>False</td>
      <td>False</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>0.048893</td>
      <td>0.027621</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>False</td>
      <td>False</td>
      <td>4.0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>-0.053262</td>
      <td>-0.080038</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>False</td>
      <td>False</td>
      <td>8.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>0.060593</td>
      <td>0.088030</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>False</td>
      <td>False</td>
      <td>8.0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>-0.070370</td>
      <td>-0.053348</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>False</td>
      <td>False</td>
      <td>12.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>0.176493</td>
      <td>0.161140</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>False</td>
      <td>False</td>
      <td>12.0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>-0.101636</td>
      <td>-0.087706</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>False</td>
      <td>False</td>
      <td>16.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>16.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>0.220515</td>
      <td>0.259927</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>False</td>
      <td>False</td>
      <td>16.0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>16.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>-0.145601</td>
      <td>-0.135938</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>True</td>
      <td>True</td>
      <td>17.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>18.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>1.0</td>
      <td>17.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>18.0</td>
      <td>1.0</td>
      <td>0.259927</td>
      <td>0.255945</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>True</td>
      <td>True</td>
      <td>19.0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>20.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>1.0</td>
      <td>19.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>20.0</td>
      <td>1.0</td>
      <td>-0.167724</td>
      <td>-0.162891</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>-0.023082</td>
      <td>-0.001298</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.004098</td>
      <td>-0.020117</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>False</td>
      <td>False</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>-0.030109</td>
      <td>-0.055604</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>30 rows × 22 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Src</span><span class="p">(</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_envs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rgb_array&#39;</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="n">GymSrc</span><span class="p">)</span>
<span class="n">train</span><span class="p">(</span><span class="n">source</span><span class="p">)</span><span class="o">.</span><span class="n">pandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>done</th>
      <th>all_done</th>
      <th>step</th>
      <th>env_id</th>
      <th>p_id</th>
      <th>episode_num</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>state</th>
      <th>next_state</th>
      <th>action</th>
      <th>image</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>0</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>0</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>1</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>4.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>0</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>8.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>1</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>5</th>
      <td>False</td>
      <td>False</td>
      <td>8.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>1</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>6</th>
      <td>False</td>
      <td>False</td>
      <td>12.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>1</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>7</th>
      <td>False</td>
      <td>False</td>
      <td>12.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>1</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>8</th>
      <td>False</td>
      <td>False</td>
      <td>16.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>1</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>9</th>
      <td>False</td>
      <td>False</td>
      <td>16.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>0</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>10</th>
      <td>True</td>
      <td>True</td>
      <td>17.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>18.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>1</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>11</th>
      <td>False</td>
      <td>False</td>
      <td>20.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>21.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>1</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>12</th>
      <td>True</td>
      <td>True</td>
      <td>23.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>24.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>0</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>13</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>0</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>14</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>1</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>15</th>
      <td>False</td>
      <td>False</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>0</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>16</th>
      <td>False</td>
      <td>False</td>
      <td>4.0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>0</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>17</th>
      <td>False</td>
      <td>False</td>
      <td>8.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>0</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>18</th>
      <td>False</td>
      <td>False</td>
      <td>8.0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>1</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>19</th>
      <td>False</td>
      <td>False</td>
      <td>12.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>0</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>20</th>
      <td>True</td>
      <td>True</td>
      <td>12.0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>1</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>21</th>
      <td>False</td>
      <td>False</td>
      <td>16.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>1</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>22</th>
      <td>True</td>
      <td>True</td>
      <td>17.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>18.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>1</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>23</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>0</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>24</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>0</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>25</th>
      <td>False</td>
      <td>False</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>1</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>26</th>
      <td>False</td>
      <td>False</td>
      <td>4.0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>0</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>27</th>
      <td>False</td>
      <td>False</td>
      <td>8.0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>0</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>28</th>
      <td>False</td>
      <td>False</td>
      <td>8.0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>0</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
    <tr>
      <th>29</th>
      <td>False</td>
      <td>False</td>
      <td>12.0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>torch.Size([30, 4])</td>
      <td>torch.Size([30, 4])</td>
      <td>1</td>
      <td>torch.Size([30, 400, 600, 3])</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Augmentation">Augmentation<a class="anchor-link" href="#Augmentation"> </a></h2><blockquote><p>Plugins for experience sources</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FirstLast" class="doc_header"><code>class</code> <code>FirstLast</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L328" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FirstLast</code>() :: <a href="/fastrl/data.block.html#SrcCallback"><code>SrcCallback</code></a></p>
</blockquote>
<p>Basic class handling tweaks of a callback loop by changing a <code>obj</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Src</span><span class="p">(</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">n_envs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymSrc</span><span class="p">,</span><span class="n">FirstLast</span><span class="p">])</span>
<span class="n">train</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">iters</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">mu</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>done</th>
      <th>all_done</th>
      <th>step</th>
      <th>env_id</th>
      <th>p_id</th>
      <th>episode_num</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>state</th>
      <th>next_state</th>
      <th>...</th>
      <th>all_done_mu</th>
      <th>step_mu</th>
      <th>env_id_mu</th>
      <th>p_id_mu</th>
      <th>episode_num_mu</th>
      <th>accum_rewards_mu</th>
      <th>reward_mu</th>
      <th>state_mu</th>
      <th>next_state_mu</th>
      <th>action_mu</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>0.025668</td>
      <td>0.088129</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.940399</td>
      <td>0.052870</td>
      <td>0.068959</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.940399</td>
      <td>0.031943</td>
      <td>0.050406</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>3.940399</td>
      <td>0.059735</td>
      <td>0.032056</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>5.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>3.940399</td>
      <td>0.088129</td>
      <td>0.013483</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>False</td>
      <td>False</td>
      <td>15.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>16.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>16.0</td>
      <td>3.940399</td>
      <td>0.003486</td>
      <td>0.027486</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>36</th>
      <td>False</td>
      <td>False</td>
      <td>16.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>17.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>16.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>17.0</td>
      <td>3.940399</td>
      <td>-0.026624</td>
      <td>0.046839</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>37</th>
      <td>False</td>
      <td>False</td>
      <td>17.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>18.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>17.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>18.0</td>
      <td>3.940399</td>
      <td>-0.008814</td>
      <td>0.067572</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>38</th>
      <td>False</td>
      <td>False</td>
      <td>18.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>19.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>19.0</td>
      <td>3.940399</td>
      <td>0.009080</td>
      <td>0.041465</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>39</th>
      <td>False</td>
      <td>False</td>
      <td>19.0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>20.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>19.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>20.0</td>
      <td>3.940399</td>
      <td>0.027486</td>
      <td>0.065267</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>40 rows × 22 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Src</span><span class="p">(</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymSrc</span><span class="p">,</span><span class="n">FirstLast</span><span class="p">])</span>
<span class="n">train</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">iters</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">mu</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>done</th>
      <th>all_done</th>
      <th>step</th>
      <th>env_id</th>
      <th>p_id</th>
      <th>episode_num</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>state</th>
      <th>next_state</th>
      <th>...</th>
      <th>all_done_mu</th>
      <th>step_mu</th>
      <th>env_id_mu</th>
      <th>p_id_mu</th>
      <th>episode_num_mu</th>
      <th>accum_rewards_mu</th>
      <th>reward_mu</th>
      <th>state_mu</th>
      <th>next_state_mu</th>
      <th>action_mu</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.016491</td>
      <td>-0.004905</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.007153</td>
      <td>-0.014733</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>-0.005505</td>
      <td>-0.028497</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>-0.004905</td>
      <td>0.021944</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>1.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>-0.014733</td>
      <td>-0.037088</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>False</td>
      <td>False</td>
      <td>11.0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>-0.111851</td>
      <td>-0.098848</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>36</th>
      <td>False</td>
      <td>False</td>
      <td>12.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>0.038204</td>
      <td>0.014006</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>37</th>
      <td>True</td>
      <td>True</td>
      <td>12.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>1.0</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>-0.190015</td>
      <td>-0.231523</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>38</th>
      <td>False</td>
      <td>False</td>
      <td>12.0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>-0.098848</td>
      <td>-0.134442</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>39</th>
      <td>False</td>
      <td>False</td>
      <td>13.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>14.0</td>
      <td>1.0</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>13.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>14.0</td>
      <td>1.0</td>
      <td>0.014006</td>
      <td>0.038251</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>40 rows × 22 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Src</span><span class="p">(</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">n_envs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymSrc</span><span class="p">,</span><span class="n">FirstLast</span><span class="p">])</span>
<span class="n">train</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">iters</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">mu</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>done</th>
      <th>all_done</th>
      <th>step</th>
      <th>env_id</th>
      <th>p_id</th>
      <th>episode_num</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>state</th>
      <th>next_state</th>
      <th>...</th>
      <th>all_done_mu</th>
      <th>step_mu</th>
      <th>env_id_mu</th>
      <th>p_id_mu</th>
      <th>episode_num_mu</th>
      <th>accum_rewards_mu</th>
      <th>reward_mu</th>
      <th>state_mu</th>
      <th>next_state_mu</th>
      <th>action_mu</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>-0.011582</td>
      <td>-0.010447</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>3.940399</td>
      <td>-0.034607</td>
      <td>-0.036532</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>7.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>3.940399</td>
      <td>-0.011407</td>
      <td>-0.067176</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>9.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>10.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>10.0</td>
      <td>3.940399</td>
      <td>-0.040084</td>
      <td>-0.156243</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>12.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>13.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>13.0</td>
      <td>3.940399</td>
      <td>-0.124823</td>
      <td>-0.119297</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>0.006016</td>
      <td>0.012987</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>36</th>
      <td>False</td>
      <td>False</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>4.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>3.940399</td>
      <td>0.035168</td>
      <td>0.042988</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>37</th>
      <td>False</td>
      <td>False</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>7.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>3.940399</td>
      <td>0.016834</td>
      <td>0.126383</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>38</th>
      <td>False</td>
      <td>False</td>
      <td>9.0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>10.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>10.0</td>
      <td>3.940399</td>
      <td>0.097324</td>
      <td>0.178377</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>39</th>
      <td>True</td>
      <td>False</td>
      <td>11.0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>12.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>12.0</td>
      <td>3.940399</td>
      <td>0.157278</td>
      <td>0.256669</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>40 rows × 22 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Src</span><span class="p">(</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">n_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymSrc</span><span class="p">,</span><span class="n">FirstLast</span><span class="p">])</span>
<span class="n">train</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">iters</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">mu</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>done</th>
      <th>all_done</th>
      <th>step</th>
      <th>env_id</th>
      <th>p_id</th>
      <th>episode_num</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>state</th>
      <th>next_state</th>
      <th>...</th>
      <th>all_done_mu</th>
      <th>step_mu</th>
      <th>env_id_mu</th>
      <th>p_id_mu</th>
      <th>episode_num_mu</th>
      <th>accum_rewards_mu</th>
      <th>reward_mu</th>
      <th>state_mu</th>
      <th>next_state_mu</th>
      <th>action_mu</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>0.001028</td>
      <td>-0.044276</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>0.003635</td>
      <td>0.095105</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>0.008820</td>
      <td>-0.082511</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>3.940399</td>
      <td>-0.067931</td>
      <td>-0.028250</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>3.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>4.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>3.940399</td>
      <td>0.070635</td>
      <td>0.180947</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>False</td>
      <td>False</td>
      <td>6.0</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>7.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>7.0</td>
      <td>3.940399</td>
      <td>-0.033200</td>
      <td>0.050239</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>36</th>
      <td>True</td>
      <td>False</td>
      <td>8.0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>9.0</td>
      <td>3.940399</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>9.0</td>
      <td>3.940399</td>
      <td>-0.129300</td>
      <td>-0.230571</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>37</th>
      <td>True</td>
      <td>False</td>
      <td>9.0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>10.0</td>
      <td>2.970100</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>2.970100</td>
      <td>-0.116118</td>
      <td>-0.230571</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>38</th>
      <td>True</td>
      <td>False</td>
      <td>10.0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>11.0</td>
      <td>1.990000</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>11.0</td>
      <td>1.990000</td>
      <td>-0.152166</td>
      <td>-0.230571</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>39</th>
      <td>True</td>
      <td>True</td>
      <td>11.0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>12.0</td>
      <td>1.000000</td>
      <td>torch.Size([40, 4])</td>
      <td>torch.Size([40, 4])</td>
      <td>...</td>
      <td>1.0</td>
      <td>11.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>12.0</td>
      <td>1.000000</td>
      <td>-0.190192</td>
      <td>-0.230571</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>40 rows × 22 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">.</span><span class="n">show_loop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Start Setup
   - before_initialize: []
   - initialize     : [GymSrc]
   - after_initialize: []
End Setup
 - before_episodes: []
Start Episodes
   - before_reset   : []
   - reset          : [GymSrc]
   - after_reset    : [GymSrc]
   - before_do_action: []
   - do_action      : [GymSrc]
   - after_do_action: []
   - before_do_step : []
   - do_step        : [GymSrc]
   - after_do_step  : []
   - before_render  : []
   - render         : []
   - after_render   : []
   - before_history : []
   - history        : [GymSrc, FirstLast]
   - after_history  : [GymSrc]
End Episodes
 - after_episodes : []
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SourceDataset" class="doc_header"><code>class</code> <code>SourceDataset</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L346" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SourceDataset</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwds</code></strong>) :: <code>IterableDataset</code></p>
</blockquote>
<p>Iterates through a <code>source</code> object. Allows for re-initing source connections when <code>num_workers&gt;0</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">train_loop</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">dataset</span><span class="o">=</span><span class="n">SourceDataset</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="n">data</span><span class="o">=</span><span class="kc">None</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span><span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">persistent_workers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">wif</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">wif</span><span class="p">):</span>
        <span class="n">data</span><span class="o">=</span><span class="n">x</span> <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">data</span><span class="o">+</span><span class="n">x</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Src</span><span class="p">(</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_envs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymSrc</span><span class="p">,</span><span class="n">FirstLast</span><span class="p">])</span>
<span class="n">data</span><span class="o">=</span><span class="n">train_loop</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">pandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>done</th>
      <th>all_done</th>
      <th>step</th>
      <th>env_id</th>
      <th>p_id</th>
      <th>episode_num</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>state</th>
      <th>next_state</th>
      <th>action</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>45</th>
      <td>False</td>
      <td>False</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>46</th>
      <td>False</td>
      <td>False</td>
      <td>5.0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>47</th>
      <td>False</td>
      <td>False</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>48</th>
      <td>False</td>
      <td>False</td>
      <td>7.0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>49</th>
      <td>False</td>
      <td>False</td>
      <td>8.0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>50 rows × 11 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Src</span><span class="p">(</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">n_envs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymSrc</span><span class="p">,</span><span class="n">FirstLast</span><span class="p">])</span>
<span class="n">data</span><span class="o">=</span><span class="n">train_loop</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">pandas</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>done</th>
      <th>all_done</th>
      <th>step</th>
      <th>env_id</th>
      <th>p_id</th>
      <th>episode_num</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>state</th>
      <th>next_state</th>
      <th>action</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>3.940399</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>45</th>
      <td>False</td>
      <td>False</td>
      <td>27.0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>28.0</td>
      <td>3.940399</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>46</th>
      <td>False</td>
      <td>False</td>
      <td>21.0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>22.0</td>
      <td>3.940399</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>47</th>
      <td>True</td>
      <td>False</td>
      <td>28.0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>29.0</td>
      <td>3.940399</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>48</th>
      <td>False</td>
      <td>False</td>
      <td>24.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>25.0</td>
      <td>3.940399</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>49</th>
      <td>True</td>
      <td>False</td>
      <td>29.0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>30.0</td>
      <td>2.970100</td>
      <td>torch.Size([50, 4])</td>
      <td>torch.Size([50, 4])</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>50 rows × 11 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fastai-Extensions">Fastai Extensions<a class="anchor-link" href="#Fastai-Extensions"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="IterableTfmdLists" class="doc_header"><code>class</code> <code>IterableTfmdLists</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L357" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>IterableTfmdLists</code>(<strong><code>items</code></strong>=<em><code>None</code></em>, <strong>*<code>rest</code></strong>, <strong><code>use_list</code></strong>=<em><code>False</code></em>, <strong><code>match</code></strong>=<em><code>None</code></em>) :: <code>TfmdLists</code></p>
</blockquote>
<p>A <code>Pipeline</code> of <code>tfms</code> applied to a collection of <code>items</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="vstack_collate" class="doc_header"><code>vstack_collate</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L364" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>vstack_collate</code>(<strong><code>batch</code></strong>)</p>
</blockquote>
<p>99% similar to default_collate, however vstacks tensors thus assuming they already have a batch dim</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vstack_collate</span><span class="p">(({</span><span class="s1">&#39;this&#39;</span><span class="p">:</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])},{</span><span class="s1">&#39;this&#39;</span><span class="p">:</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])}))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;this&#39;: tensor([[1., 2., 3.],
         [1., 2., 3.],
         [4., 5., 6.]])}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fr_collate" class="doc_header"><code>fr_collate</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L412" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fr_collate</code>(<strong><code>t</code></strong>)</p>
</blockquote>
<p>A replacement for PyTorch <code>default_collate</code> which maintains types and handles <code>Sequence</code>s</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="IterableTfmdDL" class="doc_header"><code>class</code> <code>IterableTfmdDL</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L422" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>IterableTfmdDL</code>(<strong><code>dataset</code></strong>, <strong><code>bs</code></strong>=<em><code>64</code></em>, <strong><code>shuffle</code></strong>=<em><code>False</code></em>, <strong><code>num_workers</code></strong>=<em><code>None</code></em>, <strong><code>verbose</code></strong>=<em><code>False</code></em>, <strong><code>do_setup</code></strong>=<em><code>True</code></em>, <strong><code>pin_memory</code></strong>=<em><code>False</code></em>, <strong><code>timeout</code></strong>=<em><code>0</code></em>, <strong><code>batch_size</code></strong>=<em><code>None</code></em>, <strong><code>drop_last</code></strong>=<em><code>False</code></em>, <strong><code>indexed</code></strong>=<em><code>None</code></em>, <strong><code>n</code></strong>=<em><code>None</code></em>, <strong><code>device</code></strong>=<em><code>None</code></em>, <strong><code>persistent_workers</code></strong>=<em><code>False</code></em>, <strong><code>wif</code></strong>=<em><code>None</code></em>, <strong><code>before_iter</code></strong>=<em><code>None</code></em>, <strong><code>after_item</code></strong>=<em><code>None</code></em>, <strong><code>before_batch</code></strong>=<em><code>None</code></em>, <strong><code>after_batch</code></strong>=<em><code>None</code></em>, <strong><code>after_iter</code></strong>=<em><code>None</code></em>, <strong><code>create_batches</code></strong>=<em><code>None</code></em>, <strong><code>create_item</code></strong>=<em><code>None</code></em>, <strong><code>create_batch</code></strong>=<em><code>None</code></em>, <strong><code>retain</code></strong>=<em><code>None</code></em>, <strong><code>get_idxs</code></strong>=<em><code>None</code></em>, <strong><code>sample</code></strong>=<em><code>None</code></em>, <strong><code>shuffle_fn</code></strong>=<em><code>None</code></em>, <strong><code>do_batch</code></strong>=<em><code>None</code></em>) :: <code>TfmdDL</code></p>
</blockquote>
<p>Transformed <code>DataLoader</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="IterableDataBlock" class="doc_header"><code>class</code> <code>IterableDataBlock</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L426" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>IterableDataBlock</code>(<strong><code>blocks</code></strong>=<em><code>None</code></em>, <strong><code>dl_type</code></strong>=<em><code>None</code></em>, <strong><code>getters</code></strong>=<em><code>None</code></em>, <strong><code>n_inp</code></strong>=<em><code>None</code></em>, <strong><code>item_tfms</code></strong>=<em><code>None</code></em>, <strong><code>batch_tfms</code></strong>=<em><code>None</code></em>, <strong><code>get_items</code></strong>=<em><code>None</code></em>, <strong><code>splitter</code></strong>=<em><code>None</code></em>, <strong><code>get_y</code></strong>=<em><code>None</code></em>, <strong><code>get_x</code></strong>=<em><code>None</code></em>) :: <code>DataBlock</code></p>
</blockquote>
<p>Generic container to quickly build <code>Datasets</code> and <code>DataLoaders</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Datasets.__iter__" class="doc_header"><code>Datasets.__iter__</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L445" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Datasets.__iter__</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Datasets.__init__" class="doc_header"><code>Datasets.__init__</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L449" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Datasets.__init__</code>(<strong><code>items</code></strong>=<em><code>None</code></em>, <strong><code>tfms</code></strong>=<em><code>None</code></em>, <strong><code>tls</code></strong>=<em><code>None</code></em>, <strong><code>n_inp</code></strong>=<em><code>None</code></em>, <strong><code>dl_type</code></strong>=<em><code>None</code></em>, <strong><code>tl_type</code></strong>=<em><code>TfmdLists</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Initialize self.  See help(type(self)) for accurate signature.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TransformBlock" class="doc_header"><code>class</code> <code>TransformBlock</code><a href="https://github.com/fastai/fastai/tree/master/fastai/data/block.py#L13" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TransformBlock</code>(<strong><code>type_tfms</code></strong>=<em><code>None</code></em>, <strong><code>item_tfms</code></strong>=<em><code>None</code></em>, <strong><code>batch_tfms</code></strong>=<em><code>None</code></em>, <strong><code>dl_type</code></strong>=<em><code>None</code></em>, <strong><code>dls_kwargs</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>A basic wrapper that links defaults transforms for the data block API</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fastai-API--&gt;-Fastrl-Components">Fastai API -&gt; Fastrl Components<a class="anchor-link" href="#Fastai-API--&gt;-Fastrl-Components"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SourceBlock" class="doc_header"><code>class</code> <code>SourceBlock</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L468" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SourceBlock</code>(<strong><code>source</code></strong>, <strong><code>dls_kwargs</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/fastrl/data.block_simple.html#TransformBlock"><code>TransformBlock</code></a></p>
</blockquote>
<p>A basic wrapper that links defaults transforms for the data block API</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="map_iters" class="doc_header"><code>map_iters</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L477" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>map_iters</code>(<strong><code>_</code></strong>, <strong><code>ls</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="noop_splitter" class="doc_header"><code>noop_splitter</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L478" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>noop_splitter</code>(<strong><code>_</code></strong>, <strong><code>o</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_all_keys" class="doc_header"><code>get_all_keys</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L479" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_all_keys</code>(<strong><code>_</code></strong>, <strong><code>o</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SourceDataBlock" class="doc_header"><code>class</code> <code>SourceDataBlock</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/data/block.py#L481" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SourceDataBlock</code>(<strong><code>blocks</code></strong>=<em><code>None</code></em>, <strong><code>n_inp</code></strong>=<em><code>None</code></em>, <strong><code>dl_type</code></strong>=<em><code>None</code></em>, <strong><code>getters</code></strong>=<em><code>None</code></em>, <strong><code>item_tfms</code></strong>=<em><code>None</code></em>, <strong><code>batch_tfms</code></strong>=<em><code>None</code></em>, <strong><code>get_items</code></strong>=<em><code>None</code></em>, <strong><code>splitter</code></strong>=<em><code>None</code></em>, <strong><code>get_y</code></strong>=<em><code>None</code></em>, <strong><code>get_x</code></strong>=<em><code>None</code></em>) :: <a href="/fastrl/data.block_simple.html#IterableDataBlock"><code>IterableDataBlock</code></a></p>
</blockquote>
<p>Generic container to quickly build <code>Datasets</code> and <code>DataLoaders</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">source</span><span class="o">=</span><span class="n">Src</span><span class="p">(</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_envs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymSrc</span><span class="p">])</span>

<span class="n">gym_block</span><span class="o">=</span><span class="n">SourceDataBlock</span><span class="p">(</span>
    <span class="n">blocks</span><span class="o">=</span><span class="n">SourceBlock</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">=</span><span class="n">gym_block</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">([</span><span class="n">source</span><span class="p">],</span><span class="n">n</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">bs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="kc">None</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dls</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">data</span><span class="o">=</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">data</span><span class="o">+</span><span class="n">BD</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">data</span><span class="o">.</span><span class="n">pandas</span><span class="p">(</span><span class="n">jupyter_nrows</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>done</th>
      <th>all_done</th>
      <th>step</th>
      <th>env_id</th>
      <th>p_id</th>
      <th>episode_num</th>
      <th>accum_rewards</th>
      <th>reward</th>
      <th>state</th>
      <th>next_state</th>
      <th>action</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>torch.Size([15, 4])</td>
      <td>torch.Size([15, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>torch.Size([15, 4])</td>
      <td>torch.Size([15, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>torch.Size([15, 4])</td>
      <td>torch.Size([15, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>torch.Size([15, 4])</td>
      <td>torch.Size([15, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>torch.Size([15, 4])</td>
      <td>torch.Size([15, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>False</td>
      <td>False</td>
      <td>5.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>torch.Size([15, 4])</td>
      <td>torch.Size([15, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>False</td>
      <td>False</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>torch.Size([15, 4])</td>
      <td>torch.Size([15, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>False</td>
      <td>False</td>
      <td>7.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>torch.Size([15, 4])</td>
      <td>torch.Size([15, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>False</td>
      <td>False</td>
      <td>8.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>torch.Size([15, 4])</td>
      <td>torch.Size([15, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>False</td>
      <td>False</td>
      <td>9.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>torch.Size([15, 4])</td>
      <td>torch.Size([15, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>False</td>
      <td>False</td>
      <td>10.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>11.0</td>
      <td>1.0</td>
      <td>torch.Size([15, 4])</td>
      <td>torch.Size([15, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11</th>
      <td>False</td>
      <td>False</td>
      <td>11.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>torch.Size([15, 4])</td>
      <td>torch.Size([15, 4])</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>False</td>
      <td>False</td>
      <td>12.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>13.0</td>
      <td>1.0</td>
      <td>torch.Size([15, 4])</td>
      <td>torch.Size([15, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>13</th>
      <td>False</td>
      <td>False</td>
      <td>13.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>14.0</td>
      <td>1.0</td>
      <td>torch.Size([15, 4])</td>
      <td>torch.Size([15, 4])</td>
      <td>1</td>
    </tr>
    <tr>
      <th>14</th>
      <td>False</td>
      <td>False</td>
      <td>14.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>15.0</td>
      <td>1.0</td>
      <td>torch.Size([15, 4])</td>
      <td>torch.Size([15, 4])</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

