---

title: DQN Targets + N-Step


keywords: fastai
sidebar: home_sidebar

summary: "A Bare-Bones DQN is usually extremely unstable. Target models can eleviate this. We also support First-Last N steps better."
description: "A Bare-Bones DQN is usually extremely unstable. Target models can eleviate this. We also support First-Last N steps better."
nb_path: "nbs/10b_agents.dqn.targets.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/10b_agents.dqn.targets.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first part of the algorithm is the actual categorical DQN section. There are 2 parts
to this:<br></p>

<pre><code>- defined supports&lt;br&gt;
- model output balancing

</code></pre>
<p>This section is composed of 2 important equations:</p>
<p>$z_i = V_{min} + i\Delta z: 0 \leq i &lt; N$</p>
<p>where</p>
<p>$\Delta z = \frac{V_{max} - V_{min}}{N - 1}$</p>
<p>Defines the support distribution, in other words, how the activations of the neural network output is going to be weighted.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="supports" class="doc_header"><code>supports</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/agents/dqn/targets.py#L25" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>supports</code>(<strong><code>n_atoms</code></strong>=<em><code>51</code></em>, <strong><code>v_min</code></strong>=<em><code>-1</code></em>, <strong><code>v_max</code></strong>=<em><code>1</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">out</span><span class="p">,</span><span class="n">delta_z</span><span class="o">=</span><span class="n">supports</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7f953d28e550&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$Z_{\theta}(x,a) = z_i \quad w.p. \: p_i(x,a) := \frac{e^{\:\theta_i(x,a)}} {\sum_j{e^{\:\theta_i(x,a)}}}$</p>
<p>Now that we have defined how the supports are defind, we also define the head of the neural model.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="distribution_head" class="doc_header"><code>distribution_head</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/agents/dqn/targets.py#L30" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>distribution_head</code>(<strong><code>t</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">out</span><span class="o">=</span><span class="n">distribution_head</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">10</span><span class="p">,)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x7f94dcceff70&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CategoricalDQN" class="doc_header"><code>class</code> <code>CategoricalDQN</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/agents/dqn/targets.py#L35" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CategoricalDQN</code>(<strong><code>state_sz</code></strong>:<code>int</code>, <strong><code>action_sz</code></strong>:<code>int</code>, <strong><code>hidden</code></strong>=<em><code>512</code></em>, <strong><code>n_atoms</code></strong>=<em><code>51</code></em>, <strong><code>v_min</code></strong>=<em><code>-1</code></em>, <strong><code>v_max</code></strong>=<em><code>1</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Same as <code>nn.Module</code>, but no need for subclasses to call <code>super().__init__</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">CategoricalDQN</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>CategoricalDQN(
  (layers): Sequential(
    (0): Linear(in_features=4, out_features=512, bias=True)
    (1): ReLU()
    (2): Linear(in_features=512, out_features=2, bias=True)
  )
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="DQNTargetTrainer" class="doc_header"><code>class</code> <code>DQNTargetTrainer</code><a href="https://github.com/josiahls/fastrl/tree/master/fastrl/agents/dqn/targets.py#L47" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>DQNTargetTrainer</code>(<strong><code>n_batch</code></strong>=<em><code>0</code></em>, <strong><code>target_sync</code></strong>=<em><code>300</code></em>, <strong><code>discount</code></strong>=<em><code>0.99</code></em>, <strong><code>n_steps</code></strong>=<em><code>1</code></em>) :: <code>Callback</code></p>
</blockquote>
<p>Basic class handling tweaks of the training loop by changing a <code>Learner</code> in various events</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dqn</span><span class="o">=</span><span class="n">DQN</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">agent</span><span class="o">=</span><span class="n">Agent</span><span class="p">(</span><span class="n">dqn</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">ArgMaxFeed</span><span class="p">,</span><span class="n">DiscreteEpsilonRandomSelect</span><span class="p">])</span>
<span class="n">source</span><span class="o">=</span><span class="n">Src</span><span class="p">(</span><span class="s1">&#39;CartPole-v1&#39;</span><span class="p">,</span><span class="n">agent</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">steps_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">n_envs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">steps_delta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">GymSrc</span><span class="p">,</span><span class="n">FirstLast</span><span class="p">])</span>

<span class="n">dls</span><span class="o">=</span><span class="n">SourceDataBlock</span><span class="p">(</span>
    <span class="n">blocks</span><span class="o">=</span><span class="n">SourceBlock</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">([</span><span class="n">source</span><span class="p">],</span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">bs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">learn</span><span class="o">=</span><span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span><span class="n">agent</span><span class="p">,</span><span class="n">loss_func</span><span class="o">=</span><span class="n">MSELoss</span><span class="p">(),</span>
              <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">ExperienceReplay</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">max_sz</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span><span class="n">warmup_sz</span><span class="o">=</span><span class="mi">32</span><span class="p">),</span><span class="n">DQNTargetTrainer</span><span class="p">],</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">Reward</span><span class="p">,</span><span class="n">Epsilon</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">slow</span><span class="o">=</span><span class="kc">True</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">3</span> <span class="k">if</span> <span class="n">slow</span> <span class="k">else</span> <span class="mi">47</span><span class="p">,</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span><span class="n">wd</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='6' class='' max='47' style='width:300px; height:20px; vertical-align: middle;'></progress>
      12.77% [6/47 03:03<20:52]
    </div>
    
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>train_reward</th>
      <th>train_epsilon</th>
      <th>valid_loss</th>
      <th>valid_reward</th>
      <th>valid_epsilon</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.348954</td>
      <td>23.460000</td>
      <td>0.800000</td>
      <td>00:30</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.460184</td>
      <td>22.440000</td>
      <td>0.600000</td>
      <td>00:30</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.709487</td>
      <td>26.800000</td>
      <td>0.400000</td>
      <td>00:30</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.549874</td>
      <td>27.380000</td>
      <td>0.200000</td>
      <td>00:30</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1.950560</td>
      <td>29.070000</td>
      <td>0.200000</td>
      <td>00:30</td>
    </tr>
    <tr>
      <td>5</td>
      <td>2.897506</td>
      <td>29.620000</td>
      <td>0.200000</td>
      <td>00:30</td>
    </tr>
  </tbody>
</table><p>

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='34' class='' max='1000' style='width:300px; height:20px; vertical-align: middle;'></progress>
      3.40% [34/1000 00:01<00:31 2.8157]
    </div>
    
</div>

</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>

<span class="ansi-red-fg">KeyboardInterrupt</span>Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-25-4eb921fc9f45&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>learn<span class="ansi-blue-fg">.</span>fit<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">47</span><span class="ansi-blue-fg">,</span>lr<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.0001</span><span class="ansi-blue-fg">,</span>wd<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">fit</span><span class="ansi-blue-fg">(self, n_epoch, lr, wd, cbs, reset_opt)</span>
<span class="ansi-green-intense-fg ansi-bold">    210</span>             self<span class="ansi-blue-fg">.</span>opt<span class="ansi-blue-fg">.</span>set_hypers<span class="ansi-blue-fg">(</span>lr<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>lr <span class="ansi-green-fg">if</span> lr <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">else</span> lr<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    211</span>             self<span class="ansi-blue-fg">.</span>n_epoch <span class="ansi-blue-fg">=</span> n_epoch
<span class="ansi-green-fg">--&gt; 212</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>_with_events<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_do_fit<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;fit&#39;</span><span class="ansi-blue-fg">,</span> CancelFitException<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>_end_cleanup<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    213</span> 
<span class="ansi-green-intense-fg ansi-bold">    214</span>     <span class="ansi-green-fg">def</span> _end_cleanup<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">,</span>self<span class="ansi-blue-fg">.</span>xb<span class="ansi-blue-fg">,</span>self<span class="ansi-blue-fg">.</span>yb<span class="ansi-blue-fg">,</span>self<span class="ansi-blue-fg">.</span>pred<span class="ansi-blue-fg">,</span>self<span class="ansi-blue-fg">.</span>loss <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">(</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">(</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span><span class="ansi-green-fg">None</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">_with_events</span><span class="ansi-blue-fg">(self, f, event_type, ex, final)</span>
<span class="ansi-green-intense-fg ansi-bold">    158</span> 
<span class="ansi-green-intense-fg ansi-bold">    159</span>     <span class="ansi-green-fg">def</span> _with_events<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> event_type<span class="ansi-blue-fg">,</span> ex<span class="ansi-blue-fg">,</span> final<span class="ansi-blue-fg">=</span>noop<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 160</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;before_{event_type}&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>  f<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    161</span>         <span class="ansi-green-fg">except</span> ex<span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;after_cancel_{event_type}&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    162</span>         self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;after_{event_type}&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>  final<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">_do_fit</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    201</span>         <span class="ansi-green-fg">for</span> epoch <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>n_epoch<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    202</span>             self<span class="ansi-blue-fg">.</span>epoch<span class="ansi-blue-fg">=</span>epoch
<span class="ansi-green-fg">--&gt; 203</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>_with_events<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_do_epoch<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;epoch&#39;</span><span class="ansi-blue-fg">,</span> CancelEpochException<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    204</span> 
<span class="ansi-green-intense-fg ansi-bold">    205</span>     <span class="ansi-green-fg">def</span> fit<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> n_epoch<span class="ansi-blue-fg">,</span> lr<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> wd<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> cbs<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> reset_opt<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">_with_events</span><span class="ansi-blue-fg">(self, f, event_type, ex, final)</span>
<span class="ansi-green-intense-fg ansi-bold">    158</span> 
<span class="ansi-green-intense-fg ansi-bold">    159</span>     <span class="ansi-green-fg">def</span> _with_events<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> event_type<span class="ansi-blue-fg">,</span> ex<span class="ansi-blue-fg">,</span> final<span class="ansi-blue-fg">=</span>noop<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 160</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;before_{event_type}&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>  f<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    161</span>         <span class="ansi-green-fg">except</span> ex<span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;after_cancel_{event_type}&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    162</span>         self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;after_{event_type}&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>  final<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">_do_epoch</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    195</span> 
<span class="ansi-green-intense-fg ansi-bold">    196</span>     <span class="ansi-green-fg">def</span> _do_epoch<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 197</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>_do_epoch_train<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    198</span>         self<span class="ansi-blue-fg">.</span>_do_epoch_validate<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    199</span> 

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">_do_epoch_train</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    187</span>     <span class="ansi-green-fg">def</span> _do_epoch_train<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    188</span>         self<span class="ansi-blue-fg">.</span>dl <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>dls<span class="ansi-blue-fg">.</span>train
<span class="ansi-green-fg">--&gt; 189</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>_with_events<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>all_batches<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;train&#39;</span><span class="ansi-blue-fg">,</span> CancelTrainException<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    190</span> 
<span class="ansi-green-intense-fg ansi-bold">    191</span>     <span class="ansi-green-fg">def</span> _do_epoch_validate<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> ds_idx<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> dl<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">_with_events</span><span class="ansi-blue-fg">(self, f, event_type, ex, final)</span>
<span class="ansi-green-intense-fg ansi-bold">    158</span> 
<span class="ansi-green-intense-fg ansi-bold">    159</span>     <span class="ansi-green-fg">def</span> _with_events<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> event_type<span class="ansi-blue-fg">,</span> ex<span class="ansi-blue-fg">,</span> final<span class="ansi-blue-fg">=</span>noop<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 160</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;before_{event_type}&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>  f<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    161</span>         <span class="ansi-green-fg">except</span> ex<span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;after_cancel_{event_type}&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    162</span>         self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;after_{event_type}&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>  final<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">all_batches</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    164</span>     <span class="ansi-green-fg">def</span> all_batches<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    165</span>         self<span class="ansi-blue-fg">.</span>n_iter <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 166</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">for</span> o <span class="ansi-green-fg">in</span> enumerate<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>one_batch<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>o<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    167</span> 
<span class="ansi-green-intense-fg ansi-bold">    168</span>     <span class="ansi-green-fg">def</span> _do_one_batch<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">one_batch</span><span class="ansi-blue-fg">(self, i, b)</span>
<span class="ansi-green-intense-fg ansi-bold">    183</span>         b_on_device <span class="ansi-blue-fg">=</span> to_device<span class="ansi-blue-fg">(</span>b<span class="ansi-blue-fg">,</span> device<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>dls<span class="ansi-blue-fg">.</span>device<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>dls<span class="ansi-blue-fg">.</span>device <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">else</span> b
<span class="ansi-green-intense-fg ansi-bold">    184</span>         self<span class="ansi-blue-fg">.</span>_split<span class="ansi-blue-fg">(</span>b_on_device<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 185</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>_with_events<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_do_one_batch<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;batch&#39;</span><span class="ansi-blue-fg">,</span> CancelBatchException<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    186</span> 
<span class="ansi-green-intense-fg ansi-bold">    187</span>     <span class="ansi-green-fg">def</span> _do_epoch_train<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">_with_events</span><span class="ansi-blue-fg">(self, f, event_type, ex, final)</span>
<span class="ansi-green-intense-fg ansi-bold">    158</span> 
<span class="ansi-green-intense-fg ansi-bold">    159</span>     <span class="ansi-green-fg">def</span> _with_events<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> event_type<span class="ansi-blue-fg">,</span> ex<span class="ansi-blue-fg">,</span> final<span class="ansi-blue-fg">=</span>noop<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 160</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;before_{event_type}&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>  f<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    161</span>         <span class="ansi-green-fg">except</span> ex<span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;after_cancel_{event_type}&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    162</span>         self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;after_{event_type}&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>  final<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">_do_one_batch</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    168</span>     <span class="ansi-green-fg">def</span> _do_one_batch<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    169</span>         self<span class="ansi-blue-fg">.</span>pred <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>self<span class="ansi-blue-fg">.</span>xb<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 170</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_pred&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    171</span>         <span class="ansi-green-fg">if</span> len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>yb<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    172</span>             self<span class="ansi-blue-fg">.</span>loss_grad <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>loss_func<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>pred<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>self<span class="ansi-blue-fg">.</span>yb<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, event_name)</span>
<span class="ansi-green-intense-fg ansi-bold">    139</span> 
<span class="ansi-green-intense-fg ansi-bold">    140</span>     <span class="ansi-green-fg">def</span> ordered_cbs<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">[</span>cb <span class="ansi-green-fg">for</span> cb <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>cbs<span class="ansi-blue-fg">.</span>sorted<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;order&#39;</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> hasattr<span class="ansi-blue-fg">(</span>cb<span class="ansi-blue-fg">,</span> event<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">--&gt; 141</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">def</span> __call__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> L<span class="ansi-blue-fg">(</span>event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>map<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_call_one<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    142</span> 
<span class="ansi-green-intense-fg ansi-bold">    143</span>     <span class="ansi-green-fg">def</span> _call_one<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">map</span><span class="ansi-blue-fg">(self, f, gen, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    152</span>     <span class="ansi-green-fg">def</span> range<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">,</span> a<span class="ansi-blue-fg">,</span> b<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> step<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> cls<span class="ansi-blue-fg">(</span>range_of<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">,</span> b<span class="ansi-blue-fg">=</span>b<span class="ansi-blue-fg">,</span> step<span class="ansi-blue-fg">=</span>step<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    153</span> 
<span class="ansi-green-fg">--&gt; 154</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">def</span> map<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> gen<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_new<span class="ansi-blue-fg">(</span>map_ex<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> gen<span class="ansi-blue-fg">=</span>gen<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    155</span>     <span class="ansi-green-fg">def</span> argwhere<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> negate<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_new<span class="ansi-blue-fg">(</span>argwhere<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> negate<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    156</span>     <span class="ansi-green-fg">def</span> filter<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">=</span>noop<span class="ansi-blue-fg">,</span> negate<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> gen<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastcore/basics.py</span> in <span class="ansi-cyan-fg">map_ex</span><span class="ansi-blue-fg">(iterable, f, gen, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    664</span>     res <span class="ansi-blue-fg">=</span> map<span class="ansi-blue-fg">(</span>g<span class="ansi-blue-fg">,</span> iterable<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    665</span>     <span class="ansi-green-fg">if</span> gen<span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> res
<span class="ansi-green-fg">--&gt; 666</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> list<span class="ansi-blue-fg">(</span>res<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    667</span> 
<span class="ansi-green-intense-fg ansi-bold">    668</span> <span class="ansi-red-fg"># Cell</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastcore/basics.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    649</span>             <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>v<span class="ansi-blue-fg">,</span>_Arg<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> kwargs<span class="ansi-blue-fg">[</span>k<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> args<span class="ansi-blue-fg">.</span>pop<span class="ansi-blue-fg">(</span>v<span class="ansi-blue-fg">.</span>i<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    650</span>         fargs <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>args<span class="ansi-blue-fg">[</span>x<span class="ansi-blue-fg">.</span>i<span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> _Arg<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> x <span class="ansi-green-fg">for</span> x <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>pargs<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">+</span> args<span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>maxi<span class="ansi-blue-fg">+</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">--&gt; 651</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>func<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>fargs<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    652</span> 
<span class="ansi-green-intense-fg ansi-bold">    653</span> <span class="ansi-red-fg"># Cell</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastai/learner.py</span> in <span class="ansi-cyan-fg">_call_one</span><span class="ansi-blue-fg">(self, event_name)</span>
<span class="ansi-green-intense-fg ansi-bold">    143</span>     <span class="ansi-green-fg">def</span> _call_one<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    144</span>         <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> hasattr<span class="ansi-blue-fg">(</span>event<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">raise</span> Exception<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;missing {event_name}&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 145</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">for</span> cb <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>cbs<span class="ansi-blue-fg">.</span>sorted<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;order&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> cb<span class="ansi-blue-fg">(</span>event_name<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    146</span> 
<span class="ansi-green-intense-fg ansi-bold">    147</span>     <span class="ansi-green-fg">def</span> _bn_bias_state<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> with_bias<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> norm_bias_params<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">,</span> with_bias<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>map<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>opt<span class="ansi-blue-fg">.</span>state<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastai/callback/core.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, event_name)</span>
<span class="ansi-green-intense-fg ansi-bold">     42</span>                (self.run_valid and not getattr(self, &#39;training&#39;, False)))
<span class="ansi-green-intense-fg ansi-bold">     43</span>         res <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">None</span>
<span class="ansi-green-fg">---&gt; 44</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>run <span class="ansi-green-fg">and</span> _run<span class="ansi-blue-fg">:</span> res <span class="ansi-blue-fg">=</span> getattr<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">,</span> noop<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     45</span>         <span class="ansi-green-fg">if</span> event_name<span class="ansi-blue-fg">==</span><span class="ansi-blue-fg">&#39;after_fit&#39;</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>run<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span> <span class="ansi-red-fg">#Reset self.run to True at each end of fit</span>
<span class="ansi-green-intense-fg ansi-bold">     46</span>         <span class="ansi-green-fg">return</span> res

<span class="ansi-green-fg">~/fastrl/fastrl/agents/dqn/core.py</span> in <span class="ansi-cyan-fg">after_pred</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    101</span>         yb<span class="ansi-blue-fg">=</span>BD<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>learn<span class="ansi-blue-fg">.</span>yb<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>mapv<span class="ansi-blue-fg">(</span>to_detach<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    102</span>         <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>memory <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>            self<span class="ansi-blue-fg">.</span>memory<span class="ansi-blue-fg">=</span>yb
<span class="ansi-green-fg">--&gt; 103</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">elif</span> self<span class="ansi-blue-fg">.</span>memory<span class="ansi-blue-fg">.</span>bs<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">&lt;</span>self<span class="ansi-blue-fg">.</span>max_sz<span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>memory<span class="ansi-blue-fg">+=</span>yb
<span class="ansi-green-intense-fg ansi-bold">    104</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    105</span>             self<span class="ansi-blue-fg">.</span>memory<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>memory<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span>self<span class="ansi-blue-fg">.</span>pointer<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">+</span>yb<span class="ansi-blue-fg">+</span>self<span class="ansi-blue-fg">.</span>memory<span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>pointer<span class="ansi-blue-fg">+</span>yb<span class="ansi-blue-fg">.</span>bs<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">~/fastrl/fastrl/core.py</span> in <span class="ansi-cyan-fg">__add__</span><span class="ansi-blue-fg">(self, o)</span>
<span class="ansi-green-intense-fg ansi-bold">     96</span>     <span class="ansi-green-fg">def</span> __radd__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> self <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">,</span>int<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> self<span class="ansi-blue-fg">.</span>__add__<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     97</span>     <span class="ansi-green-fg">def</span> __add__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 98</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> BD<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">{</span>k<span class="ansi-blue-fg">:</span>TensorBatch<span class="ansi-blue-fg">.</span>vstack<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">[</span>k<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span>o<span class="ansi-blue-fg">[</span>k<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> k <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">}</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     99</span> 
<span class="ansi-green-intense-fg ansi-bold">    100</span>     <span class="ansi-green-fg">def</span> __getitem__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/fastrl/fastrl/core.py</span> in <span class="ansi-cyan-fg">&lt;dictcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">     96</span>     <span class="ansi-green-fg">def</span> __radd__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> self <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">,</span>int<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> self<span class="ansi-blue-fg">.</span>__add__<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     97</span>     <span class="ansi-green-fg">def</span> __add__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 98</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> BD<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">{</span>k<span class="ansi-blue-fg">:</span>TensorBatch<span class="ansi-blue-fg">.</span>vstack<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">[</span>k<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span>o<span class="ansi-blue-fg">[</span>k<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> k <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">}</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     99</span> 
<span class="ansi-green-intense-fg ansi-bold">    100</span>     <span class="ansi-green-fg">def</span> __getitem__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span>o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/fastrl/fastrl/core.py</span> in <span class="ansi-cyan-fg">vstack</span><span class="ansi-blue-fg">(cls, *args)</span>
<span class="ansi-green-intense-fg ansi-bold">     79</span>     <span class="ansi-blue-fg">@</span>classmethod
<span class="ansi-green-intense-fg ansi-bold">     80</span>     <span class="ansi-green-fg">def</span> vstack<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 81</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> cls<span class="ansi-blue-fg">(</span>torch<span class="ansi-blue-fg">.</span>vstack<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>bs<span class="ansi-blue-fg">=</span>L<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>map<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>map<span class="ansi-blue-fg">(</span>Self<span class="ansi-blue-fg">.</span>bs<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>sum<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     82</span> 
<span class="ansi-green-intense-fg ansi-bold">     83</span> <span class="ansi-green-fg">def</span> obj2tensor<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(cls, x, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     95</span>     <span class="ansi-green-fg">def</span> __call__<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     96</span>         <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> args <span class="ansi-green-fg">and</span> <span class="ansi-green-fg">not</span> kwargs <span class="ansi-green-fg">and</span> x <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">and</span> isinstance<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span>cls<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> x
<span class="ansi-green-fg">---&gt; 97</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__call__<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     98</span> 
<span class="ansi-green-intense-fg ansi-bold">     99</span> <span class="ansi-red-fg"># Cell</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, items, use_list, match, *rest)</span>
<span class="ansi-green-intense-fg ansi-bold">    103</span>     <span class="ansi-green-fg">def</span> __init__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> items<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>rest<span class="ansi-blue-fg">,</span> use_list<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> match<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    104</span>         <span class="ansi-green-fg">if</span> <span class="ansi-blue-fg">(</span>use_list <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">or</span> <span class="ansi-green-fg">not</span> is_array<span class="ansi-blue-fg">(</span>items<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 105</span><span class="ansi-red-fg">             </span>items <span class="ansi-blue-fg">=</span> listify<span class="ansi-blue-fg">(</span>items<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>rest<span class="ansi-blue-fg">,</span> use_list<span class="ansi-blue-fg">=</span>use_list<span class="ansi-blue-fg">,</span> match<span class="ansi-blue-fg">=</span>match<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    106</span>         super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__init__<span class="ansi-blue-fg">(</span>items<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    107</span> 

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastcore/basics.py</span> in <span class="ansi-cyan-fg">listify</span><span class="ansi-blue-fg">(o, use_list, match, *rest)</span>
<span class="ansi-green-intense-fg ansi-bold">     54</span>     <span class="ansi-green-fg">elif</span> isinstance<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">,</span> list<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> res <span class="ansi-blue-fg">=</span> o
<span class="ansi-green-intense-fg ansi-bold">     55</span>     <span class="ansi-green-fg">elif</span> isinstance<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">,</span> str<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">or</span> is_array<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> res <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>o<span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">---&gt; 56</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">elif</span> is_iter<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> res <span class="ansi-blue-fg">=</span> list<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     57</span>     <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span> res <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>o<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">     58</span>     <span class="ansi-green-fg">if</span> match <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/opt/conda/lib/python3.8/site-packages/fastcore/imports.py</span> in <span class="ansi-cyan-fg">is_iter</span><span class="ansi-blue-fg">(o)</span>
<span class="ansi-green-intense-fg ansi-bold">     21</span>     <span class="ansi-blue-fg">&#34;Test whether `o` can be used in a `for` loop&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">     22</span>     <span class="ansi-red-fg">#Rank 0 tensors in PyTorch are not really iterable</span>
<span class="ansi-green-fg">---&gt; 23</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> isinstance<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">(</span>Iterable<span class="ansi-blue-fg">,</span>Generator<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">and</span> getattr<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;ndim&#39;</span><span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     24</span> 
<span class="ansi-green-intense-fg ansi-bold">     25</span> <span class="ansi-green-fg">def</span> is_coll<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

